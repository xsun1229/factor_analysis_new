<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="XSun" />

<meta name="date" content="2025-10-10" />

<title>ECT results</title>

<script src="site_libs/header-attrs-2.25/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>
<link href="site_libs/highlightjs-9.12.0/textmate.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<script src="site_libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="site_libs/datatables-binding-0.22/datatables.js"></script>
<link href="site_libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="site_libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="site_libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="site_libs/font-awesome-6.4.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet" />

<link rel="icon" href="https://github.com/workflowr/workflowr-assets/raw/main/img/reproducible.png">
<!-- Add a small amount of space between sections. -->
<style type="text/css">
div.section {
  padding-top: 12px;
}
</style>



<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">factor_analysis_new</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About</a>
</li>
<li>
  <a href="license.html">License</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/xsun1229/factor_analysis_new">
    <span class="fab fa-github"></span>
     
    Source code
  </a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">ECT results</h1>
<h4 class="author">XSun</h4>
<h4 class="date">2025-10-10</h4>

</div>


<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-report" data-toggle="collapse" data-target="#workflowr-report">
<span class="glyphicon glyphicon-list" aria-hidden="true"></span>
workflowr <span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span>
</button>
</p>
<div id="workflowr-report" class="collapse">
<ul class="nav nav-tabs">
<li class="active">
<a data-toggle="tab" href="#summary">Summary</a>
</li>
<li>
<a data-toggle="tab" href="#checks"> Checks <span
class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> </a>
</li>
<li>
<a data-toggle="tab" href="#versions">Past versions</a>
</li>
</ul>
<div class="tab-content">
<div id="summary" class="tab-pane fade in active">
<p>
<strong>Last updated:</strong> 2025-10-23
</p>
<p>
<strong>Checks:</strong> <span
class="glyphicon glyphicon-ok text-success" aria-hidden="true"></span> 6
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> 1
</p>
<p>
<strong>Knit directory:</strong> <code>factor_analysis_new/</code> <span
class="glyphicon glyphicon-question-sign" aria-hidden="true"
title="This is the local directory in which the code in this file was executed.">
</span>
</p>
<p>
This reproducible <a href="https://rmarkdown.rstudio.com">R Markdown</a>
analysis was created with <a
  href="https://github.com/workflowr/workflowr">workflowr</a> (version
1.7.0). The <em>Checks</em> tab describes the reproducibility checks
that were applied when the results were created. The <em>Past
versions</em> tab lists the development history.
</p>
<hr>
</div>
<div id="checks" class="tab-pane fade">
<div id="workflowr-checks" class="panel-group">
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRMarkdownfilestronguncommittedchanges">
<span class="glyphicon glyphicon-exclamation-sign text-danger"
aria-hidden="true"></span> <strong>R Markdown file:</strong> uncommitted
changes </a>
</p>
</div>
<div id="strongRMarkdownfilestronguncommittedchanges"
class="panel-collapse collapse">
<div class="panel-body">
<p>The R Markdown file has unstaged changes. To know which version of
the R Markdown file created these results, you’ll want to first commit
it to the Git repo. If you’re still working on the analysis, you can
ignore this warning. When you’re finished, you can run
<code>wflow_publish</code> to commit the R Markdown file and build the
HTML.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongEnvironmentstrongempty">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Environment:</strong> empty </a>
</p>
</div>
<div id="strongEnvironmentstrongempty" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! The global environment was empty. Objects defined in the
global environment can affect the analysis in your R Markdown file in
unknown ways. For reproduciblity it’s best to always run the code in an
empty environment.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSeedstrongcodesetseed20221201code">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Seed:</strong>
<code>set.seed(20221201)</code> </a>
</p>
</div>
<div id="strongSeedstrongcodesetseed20221201code"
class="panel-collapse collapse">
<div class="panel-body">
<p>The command <code>set.seed(20221201)</code> was run prior to running
the code in the R Markdown file. Setting a seed ensures that any results
that rely on randomness, e.g. subsampling or permutations, are
reproducible.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongSessioninformationstrongrecorded">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Session information:</strong>
recorded </a>
</p>
</div>
<div id="strongSessioninformationstrongrecorded"
class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Recording the operating system, R version, and package
versions is critical for reproducibility.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongCachestrongnone">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Cache:</strong> none </a>
</p>
</div>
<div id="strongCachestrongnone" class="panel-collapse collapse">
<div class="panel-body">
<p>Nice! There were no cached chunks for this analysis, so you can be
confident that you successfully produced the results during this
run.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongFilepathsstrongrelative">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>File paths:</strong> relative </a>
</p>
</div>
<div id="strongFilepathsstrongrelative" class="panel-collapse collapse">
<div class="panel-body">
<p>Great job! Using relative paths to the files within your workflowr
project makes it easier to run your code on other machines.</p>
</div>
</div>
</div>
<div class="panel panel-default">
<div class="panel-heading">
<p class="panel-title">
<a data-toggle="collapse" data-parent="#workflowr-checks" href="#strongRepositoryversionstrongahrefhttpsgithubcomxsun1229factoranalysisnewtreec1850407104e445781a3c4990a19486c63c29469targetblankc185040a">
<span class="glyphicon glyphicon-ok text-success"
aria-hidden="true"></span> <strong>Repository version:</strong>
<a href="https://github.com/xsun1229/factor_analysis_new/tree/c1850407104e445781a3c4990a19486c63c29469" target="_blank">c185040</a>
</a>
</p>
</div>
<div
id="strongRepositoryversionstrongahrefhttpsgithubcomxsun1229factoranalysisnewtreec1850407104e445781a3c4990a19486c63c29469targetblankc185040a"
class="panel-collapse collapse">
<div class="panel-body">
<p>
Great! You are using Git for version control. Tracking code development
and connecting the code version to the results is critical for
reproducibility.
</p>
<p>
The results in this page were generated with repository version
<a href="https://github.com/xsun1229/factor_analysis_new/tree/c1850407104e445781a3c4990a19486c63c29469" target="_blank">c185040</a>.
See the <em>Past versions</em> tab to see a history of the changes made
to the R Markdown and HTML files.
</p>
<p>
Note that you need to be careful to ensure that all relevant files for
the analysis have been committed to Git prior to generating the results
(you can use <code>wflow_publish</code> or
<code>wflow_git_commit</code>). workflowr only checks the R Markdown
file, but you know if there are other scripts or data files that it
depends on. Below is the status of the Git repository when the results
were generated:
</p>
<pre><code>
Untracked files:
    Untracked:  analysis/revision_GWAS_selection.Rmd
    Untracked:  analysis/revision_acat_selectedtraits.Rmd
    Untracked:  analysis/revision_coloc_selectedtraits.Rmd
    Untracked:  analysis/revision_examine_oldnew_bloodcelltraits.Rmd

Unstaged changes:
    Modified:   analysis/revision.Rmd
    Modified:   analysis/revision_ECT_extendedGWAS_selectedtraits.Rmd
    Deleted:    analysis/revision_numIV.Rmd

</code></pre>
<p>
Note that any generated files, e.g. HTML, png, CSS, etc., are not
included in this status report because it is ok for generated content to
have uncommitted changes.
</p>
</div>
</div>
</div>
</div>
<hr>
</div>
<div id="versions" class="tab-pane fade">

<p>
These are the previous versions of the repository in which changes were
made to the R Markdown
(<code>analysis/revision_ECT_extendedGWAS_selectedtraits.Rmd</code>) and
HTML (<code>docs/revision_ECT_extendedGWAS_selectedtraits.html</code>)
files. If you’ve configured a remote Git repository (see
<code>?wflow_git_remote</code>), click on the hyperlinks in the table
below to view the files as they were in that past version.
</p>
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
File
</th>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
<th>
Message
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
Rmd
</td>
<td>
<a href="https://github.com/xsun1229/factor_analysis_new/blob/c1850407104e445781a3c4990a19486c63c29469/analysis/revision_ECT_extendedGWAS_selectedtraits.Rmd" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
<td>
update
</td>
</tr>
<tr>
<td>
html
</td>
<td>
<a href="https://rawcdn.githack.com/xsun1229/factor_analysis_new/c1850407104e445781a3c4990a19486c63c29469/docs/revision_ECT_extendedGWAS_selectedtraits.html" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
<td>
update
</td>
</tr>
</tbody>
</table>
</div>
<hr>
</div>
</div>
</div>
<table>
<thead>
<tr class="header">
<th>Trait</th>
<th>Abbr.</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Hemoglobin</td>
<td>HB</td>
</tr>
<tr class="even">
<td>Hematocrit</td>
<td>HCT</td>
</tr>
<tr class="odd">
<td>Mean Corpuscular Volume</td>
<td>MCV</td>
</tr>
<tr class="even">
<td>Mean Corpuscular Hemoglobin</td>
<td>MCH</td>
</tr>
<tr class="odd">
<td>Platelet count</td>
<td>PLT</td>
</tr>
<tr class="even">
<td>White blood cell count</td>
<td>WBC</td>
</tr>
<tr class="odd">
<td>Red blood cell count</td>
<td>RBC</td>
</tr>
<tr class="even">
<td>Crohn’s disease</td>
<td>CD</td>
</tr>
<tr class="odd">
<td>Inflammatory bowel disease</td>
<td>IBD</td>
</tr>
<tr class="even">
<td>Ulcerative colitis</td>
<td>UC</td>
</tr>
<tr class="odd">
<td>Rheumatoid arthritis</td>
<td>RA</td>
</tr>
<tr class="even">
<td>Type 1 diabetes</td>
<td>T1D</td>
</tr>
<tr class="odd">
<td>Systemic lupus erythematosus</td>
<td>SLE</td>
</tr>
<tr class="even">
<td>Celiac disease</td>
<td>celiac</td>
</tr>
<tr class="odd">
<td>Asthma</td>
<td>asthma</td>
</tr>
<tr class="even">
<td>Psoriasis</td>
<td>Psoriasis</td>
</tr>
<tr class="odd">
<td>Multiple sclerosis</td>
<td>MS</td>
</tr>
<tr class="even">
<td>Ankylosing spondylitis</td>
<td>AS</td>
</tr>
<tr class="odd">
<td>LDL cholesterol</td>
<td>LDL</td>
</tr>
<tr class="even">
<td>Hypertension</td>
<td>HT</td>
</tr>
<tr class="odd">
<td>Allergy</td>
<td>Allergy</td>
</tr>
<tr class="even">
<td>Hashimoto thyroiditis</td>
<td>HT</td>
</tr>
</tbody>
</table>
<pre class="r"><code>library(tidyverse)
library(ggplot2)

celltypes &lt;- c(&quot;B_cell&quot;,&quot;CD14_positive_monocyte&quot;,&quot;CD15_positive_leukocyte&quot;,&quot;platelet&quot;,&quot;T_cell&quot;,&quot;thymocyte&quot;)
type &lt;- c(&quot;B cell (CD19+)&quot;,&quot;Monocyte (CD14+)&quot;,&quot;Leukocyte (CD15+)&quot;,&quot;Platelet&quot;,&quot;T cell (CD4+)&quot;,&quot;T cell (CD8+)&quot;)
names(type) &lt;- celltypes
names(celltypes) &lt;- type

source(&quot;/project/xinhe/xsun/pathway_factor/data_v2/traits_selected.R&quot;)

folder_ect &lt;- &quot;/project/xinhe/xsun/pathway_factor/analysis/1.ECT_v2/ECT_summary/&quot;</code></pre>
<pre class="r"><code>ECT_summary_MBEadded_all &lt;- c()

for (celltype in celltypes){
  
  ECT_summary_MBEadded &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_poolalltraits_MBE_steiger.RDS&quot;))
  ECT_summary_MBEadded_all &lt;- rbind(ECT_summary_MBEadded_all, ECT_summary_MBEadded)
  
}

ECT_summary_allcelltypes_ACATadded_p0005 &lt;- readRDS(paste0(folder_ect,&quot;ECT_summary_allcelltypes_ACATadded_p0005.RDS&quot;))</code></pre>
<div id="summary-for-all-supp_snp-cutoffs" class="section level1">
<h1>Summary for all supp_SNP cutoffs</h1>
<div id="genes" class="section level2">
<h2>40 genes</h2>
<div id="eur" class="section level3">
<h3>EUR</h3>
<pre class="r"><code>df_all_FDR01 &lt;- c()
df_all_FDR02 &lt;- c()
df_p0001 &lt;- c()
for (celltype in celltypes){
  
  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_40genes_EUR.RDS&quot;))
  
  tmp_FDR01 &lt;- c(unique(df$celltype),sum(df$FDR_3suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_4suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_5suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_6suppSNP &lt; 0.1,na.rm = T),
                 sum(df$FDR_7suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_8suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_9suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_10suppSNP &lt; 0.1,na.rm = T))
  tmp_FDR02 &lt;- c(unique(df$celltype),sum(df$FDR_3suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_4suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_5suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_6suppSNP &lt; 0.2,na.rm = T),
                 sum(df$FDR_7suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_8suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_9suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_10suppSNP &lt; 0.2,na.rm = T))
  tmp_FDR02[2:length(tmp_FDR02)] &lt;- as.numeric(tmp_FDR02[2:length(tmp_FDR02)]) - as.numeric(tmp_FDR01[2:length(tmp_FDR01)])
  
  df_all_FDR01 &lt;- rbind(df_all_FDR01,tmp_FDR01)
  df_all_FDR02 &lt;- rbind(df_all_FDR02,tmp_FDR02)
  
  df_p0001 &lt;- rbind(df_p0001, df[df$p_ECT &lt; 0.001,])
  
}

df_p0001 &lt;- df_p0001[complete.cases(df_p0001$p_ECT),]

rownames(df_all_FDR01) &lt;- NULL
colnames(df_all_FDR01) &lt;- c(&quot;celltype&quot;,&quot;num_pairs_FDR01_3suppSNP&quot;,&quot;num_pairs_FDR01_4suppSNP&quot;,&quot;num_pairs_FDR01_5suppSNP&quot;,
                            &quot;num_pairs_FDR01_6suppSNP&quot;,&quot;num_pairs_FDR01_7suppSNP&quot;,&quot;num_pairs_FDR01_8suppSNP&quot;,
                            &quot;num_pairs_FDR01_9suppSNP&quot;,&quot;num_pairs_FDR01_10suppSNP&quot;)
df_all_FDR01 &lt;- as.data.frame(df_all_FDR01, stringsAsFactors = FALSE)
df_all_FDR01 &lt;- df_all_FDR01 %&gt;% mutate(across(-celltype, as.numeric))

df_long &lt;- df_all_FDR01 %&gt;%
  pivot_longer(
    cols = starts_with(&quot;num_pairs_FDR01_&quot;),
    names_to = &quot;num_suppSNP&quot;,
    values_to = &quot;num_pairs&quot;
  ) %&gt;%
  mutate(
    num_suppSNP = as.numeric(gsub(&quot;num_pairs_FDR01_|suppSNP&quot;, &quot;&quot;, num_suppSNP))
  )


ggplot(df_long, aes(x = celltype, y = num_pairs, fill = factor(num_suppSNP))) +
  geom_bar(stat = &quot;identity&quot;, position = position_dodge(width = 0.8)) +
  labs(
    x = &quot;Cell type&quot;,
    y = &quot;Number of pairs (FDR &lt; 0.1)&quot;,
    fill = &quot;Supporting SNPs&quot;
  ) +
  theme_bw(base_size = 14) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_blank()
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-3-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-1">
Past versions of unnamed-chunk-3-1.png
</button>
</p>
<div id="fig-unnamed-chunk-3-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/xsun1229/factor_analysis_new/blob/c1850407104e445781a3c4990a19486c63c29469/docs/figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-3-1.png" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>rownames(df_all_FDR02) &lt;- NULL
colnames(df_all_FDR02) &lt;- c(&quot;celltype&quot;,&quot;num_pairs_FDR02_3suppSNP&quot;,&quot;num_pairs_FDR02_4suppSNP&quot;,&quot;num_pairs_FDR02_5suppSNP&quot;,
                            &quot;num_pairs_FDR02_6suppSNP&quot;,&quot;num_pairs_FDR02_7suppSNP&quot;,&quot;num_pairs_FDR02_8suppSNP&quot;,
                            &quot;num_pairs_FDR02_9suppSNP&quot;,&quot;num_pairs_FDR02_10suppSNP&quot;)
df_all_FDR02 &lt;- as.data.frame(df_all_FDR02, stringsAsFactors = FALSE)
df_all_FDR02 &lt;- df_all_FDR02 %&gt;% mutate(across(-celltype, as.numeric))


df_long &lt;- df_all_FDR02 %&gt;%
  pivot_longer(
    cols = starts_with(&quot;num_pairs_FDR02_&quot;),
    names_to = &quot;num_suppSNP&quot;,
    values_to = &quot;num_pairs&quot;
  ) %&gt;%
  mutate(
    num_suppSNP = as.numeric(gsub(&quot;num_pairs_FDR02_|suppSNP&quot;, &quot;&quot;, num_suppSNP))
  )


ggplot(df_long, aes(x = celltype, y = num_pairs, fill = factor(num_suppSNP))) +
  geom_bar(stat = &quot;identity&quot;, position = position_dodge(width = 0.8)) +
  labs(
    x = &quot;Cell type&quot;,
    y = &quot;Number of pairs (FDR &lt; 0.2)&quot;,
    fill = &quot;Supporting SNPs&quot;
  ) +
  theme_bw(base_size = 14) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_blank()
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-3-2.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-3-2">
Past versions of unnamed-chunk-3-2.png
</button>
</p>
<div id="fig-unnamed-chunk-3-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/xsun1229/factor_analysis_new/blob/c1850407104e445781a3c4990a19486c63c29469/docs/figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-3-2.png" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>DT::datatable(df_p0001,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs &#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-0c923cdc0df2ab45b6f5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0c923cdc0df2ab45b6f5">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs <\/caption>","data":[["18394","17077","15475","15680","4953","4788","22363","17768","7543","13082","6747","8037","20207","8265","19930","1966","10172","21336","19986","4930","25890","7533","1652","14330","1687","25298","8573","14183","25127","13400","12404","13626","12179","11599","4211","18225","11820","14440","4944","8458","17554","5944","244","21482","22190","7597","4632","14344","23130","20307","7774","20874","15398","10256","5078","14773","24744","4109","25993","7499","19702","19714","19877","20178","20319","9716","9731","9102","15435","14764","9362","15302","15314","9536"],["B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)"],["RA-ukb-a-105","Psoriasis-ebi-a-GCST90038681","MCV-ebi-a-GCST90002392","PLT-ebi-a-GCST90002402","CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","T1D-ebi-a-GCST90014023","Psoriasis-ebi-a-GCST90038681","HB-ebi-a-GCST90002384","MCH-ebi-a-GCST90002390","HB-ebi-a-GCST90002384","HCT-ebi-a-GCST90002383","RBC-ebi-a-GCST90002403","HCT-ebi-a-GCST90002383","RBC-ebi-a-GCST90002403","asthma_pmid36778051","HT-ebi-a-GCST90018855","SLE-ebi-a-GCST90018917","RBC-ebi-a-GCST90002403","CD-ebi-a-GCST003044","WBC-ebi-a-GCST90002407","HB-ebi-a-GCST90002384","asthma_pmid36778051","MCH-ebi-a-GCST90002390","asthma_pmid36778051","WBC-ebi-a-GCST90002407","HCT-ebi-a-GCST90002383","MCH-ebi-a-GCST90002390","WBC-ebi-a-GCST90002407","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","MCH-ebi-a-GCST90002390","LDL-ukb-d-30780_irnt","HB-ebi-a-GCST90002384","UC-ebi-a-GCST003045","PLT-ebi-a-GCST90002402","RBC-ebi-a-GCST90002403","HB-ebi-a-GCST90002384","LDL-ukb-d-30780_irnt","UC-ebi-a-GCST003045","HCT-ebi-a-GCST90002383","allergy-ebi-a-GCST005038","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","HB-ebi-a-GCST90002384","CD-ebi-a-GCST003044","MCH-ebi-a-GCST90002390","T1D-ebi-a-GCST90014023","RBC-ebi-a-GCST90002403","HB-ebi-a-GCST90002384","RBC-ebi-a-GCST90002403","MCV-ebi-a-GCST90002392","HT-ebi-a-GCST90018855","CD-ebi-a-GCST003044","MCV-ebi-a-GCST90002392","UC-ebi-a-GCST003045","CD-ebi-a-GCST003044","WBC-ebi-a-GCST90002407","HB-ebi-a-GCST90002384","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","IBD-ebi-a-GCST003043","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","IBD-ebi-a-GCST003043"],["04071_PC4","04062_PC2","05416_PC5","03018_PC5","05167_PC3","05010_PC3","04211_PC3","05133_PC3","05169_PC3","03010_PC2","04060_PC2","04060_PC2","04934_PC2","04510_PC5","04621_PC5","04720_PC1","05131_PC2","04120_PC1","04068_PC1","05130_PC5","05130_PC5","05100_PC3","04070_PC2","05225_PC5","04120_PC2","04142_PC3","04725_PC3","05163_PC3","03050_PC2","04020_PC5","04910_PC4","04921_PC1","04371_PC4","05203_PC4","04064_PC1","05231_PC5","04934_PC5","04144_PC5","05205_PC4","04390_PC3","04270_PC4","05200_PC4","04150_PC4","04371_PC2","05225_PC5","05145_PC2","04722_PC2","05231_PC4","04931_PC5","04666_PC2","05224_PC4","05224_PC4","05100_PC3","05164_PC1","05206_PC3","04110_PC3","05212_PC4","01522_PC4","05167_PC3","05012_PC4","04015_PC2","04022_PC4","04217_PC2","04912_PC3","04972_PC4","04670_PC1","04713_PC1","00230_PC2","05220_PC5","04390_PC4","04060_PC2","05161_PC2","05163_PC4","04270_PC1"],["04071","04062","05416","03018","05167","05010","04211","05133","05169","03010","04060","04060","04934","04510","04621","04720","05131","04120","04068","05130","05130","05100","04070","05225","04120","04142","04725","05163","03050","04020","04910","04921","04371","05203","04064","05231","04934","04144","05205","04390","04270","05200","04150","04371","05225","05145","04722","05231","04931","04666","05224","05224","05100","05164","05206","04110","05212","01522","05167","05012","04015","04022","04217","04912","04972","04670","04713","00230","05220","04390","04060","05161","05163","04270"],["Sphingolipid signaling pathway","Chemokine signaling pathway","Viral myocarditis","RNA degradation","Kaposi sarcoma-associated herpesvirus infection","Alzheimer disease","Longevity regulating pathway","Pertussis","Epstein-Barr virus infection","Ribosome","Cytokine-cytokine receptor interaction","Cytokine-cytokine receptor interaction","Cushing syndrome","Focal adhesion","NOD-like receptor signaling pathway","Long-term potentiation","Shigellosis","Ubiquitin mediated proteolysis","FoxO signaling pathway","Pathogenic Escherichia coli infection","Pathogenic Escherichia coli infection","Bacterial invasion of epithelial cells","Phosphatidylinositol signaling system","Hepatocellular carcinoma","Ubiquitin mediated proteolysis","Lysosome","Cholinergic synapse","Human cytomegalovirus infection","Proteasome","Calcium signaling pathway","Insulin signaling pathway","Oxytocin signaling pathway","Apelin signaling pathway","Viral carcinogenesis","NF-kappa B signaling pathway","Choline metabolism in cancer","Cushing syndrome","Endocytosis","Proteoglycans in cancer","Hippo signaling pathway","Vascular smooth muscle contraction","Pathways in cancer","mTOR signaling pathway","Apelin signaling pathway","Hepatocellular carcinoma","Toxoplasmosis","Neurotrophin signaling pathway","Choline metabolism in cancer","Insulin resistance","Fc gamma R-mediated phagocytosis","Breast cancer","Breast cancer","Bacterial invasion of epithelial cells","Influenza A","MicroRNAs in cancer","Cell cycle","Pancreatic cancer","Endocrine resistance","Kaposi sarcoma-associated herpesvirus infection","Parkinson disease","Rap1 signaling pathway","cGMP-PKG signaling pathway","Necroptosis","GnRH signaling pathway","Pancreatic secretion","Leukocyte transendothelial migration","Circadian entrainment","Purine metabolism","Chronic myeloid leukemia","Hippo signaling pathway","Cytokine-cytokine receptor interaction","Hepatitis B","Human cytomegalovirus infection","Vascular smooth muscle contraction"],[3,6,5,4,11,5,12,3,8,5,6,8,8,7,4,4,3,3,9,8,5,8,5,12,5,7,4,8,5,5,8,4,15,5,5,4,6,3,4,8,5,5,3,3,3,17,4,22,6,9,9,10,17,4,9,12,3,3,13,6,3,3,3,3,3,10,4,4,10,8,5,17,6,3],[1e-06,4e-05,0.000138,0.000176,0.000191,0.000194,0.000195,0.000399,0.000438,0.00045,0.000489,0.000565,0.000693,0.000709,0.000732,0.000866,1e-06,1e-06,7.1e-05,7.6e-05,0.000224,0.000288,0.000309,0.000343,0.000361,0.00046,0.000515,0.000837,0.000863,0.000895,1e-06,0.000506,0.000528,0.000999,8e-06,4e-05,8.3e-05,9e-05,0.000109,0.00064,0.000803,0.000818,0.000926,1e-06,1e-06,9.5e-05,0.000111,0.000148,0.000162,0.000212,0.000228,0.000251,0.000267,0.000287,0.000356,0.000402,0.000478,0.000484,0.000596,0.000907,1e-06,1e-06,1e-06,1e-06,1e-06,8.3e-05,0.000255,0.000337,0.000356,0.000436,0.000527,0.000545,0.000597,0.000981],[119,189,60,79,186,171,89,76,201,153,294,294,155,199,181,67,236,136,131,202,202,73,99,168,136,123,112,225,45,193,137,153,137,201,102,98,155,249,204,155,132,531,153,137,168,112,119,98,108,93,147,147,73,170,310,124,76,98,186,142,210,167,162,93,102,112,97,130,76,155,294,162,225,132],[77,109,46,65,127,111,56,49,158,126,101,101,75,105,115,40,164,110,85,129,129,49,66,102,110,106,58,152,40,81,87,74,69,121,47,43,46,111,82,41,55,204,55,70,106,74,90,56,69,66,73,73,48,122,117,92,56,55,135,87,108,78,97,53,40,69,42,66,64,75,118,113,152,54],[0.00412,0.0824,0.114771428571429,0.114771428571429,0.114771428571429,0.114771428571429,0.114771428571429,0.183152727272727,0.183152727272727,0.183152727272727,0.183152727272727,0.193983333333333,0.201056,0.201056,0.201056,0.222995,0.002907,0.002907,0.110466,0.110466,0.233206,0.233206,0.233206,0.233206,0.233206,0.267444,0.272200909090909,0.3238398,0.3238398,0.3238398,0.003035,0.346813785714286,0.346813785714286,0.346813785714286,0.021248,0.05312,0.0579008,0.0579008,0.0579008,0.271576,0.271576,0.271576,0.273272888888889,0.0023155,0.0023155,0.120827,0.120827,0.120827,0.120827,0.120827,0.120827,0.120827,0.120827,0.120827,0.137386333333333,0.143204769230769,0.149426933333333,0.149426933333333,0.17250475,0.224907822857143,0.000858,0.000858,0.000858,0.000858,0.000858,0.059345,0.156278571428571,0.169693333333333,0.169693333333333,0.187044,0.1948375,0.1948375,0.19701,0.2534805],[null,0.0996125,0.0996125,0.0996125,0.0996125,0.0996125,0.0996125,null,0.166531666666667,0.166531666666667,0.166531666666667,0.172583076923077,0.172583076923077,0.172583076923077,0.172583076923077,0.189592142857143,null,null,0.170696,0.170696,0.231658857142857,0.231658857142857,0.231658857142857,0.231658857142857,0.231658857142857,0.257042222222222,0.257042222222222,0.308796925,0.308796925,0.308796925,0.002134,0.262613323076923,0.262613323076923,0.262613323076923,0.015752,0.03938,0.05365525,null,0.05365525,0.230091714285714,0.230091714285714,0.230091714285714,null,null,null,0.109251333333333,0.109251333333333,0.109251333333333,0.109251333333333,0.109251333333333,0.109251333333333,0.109251333333333,0.109251333333333,0.109251333333333,0.1219656,0.125204727272727,null,null,0.170158,0.215685733333333,null,null,null,null,null,0.23059125,0.23059125,0.23059125,0.23059125,0.23059125,0.23059125,0.23059125,0.23059125,null],[null,0.088764,0.088764,null,0.088764,0.088764,0.088764,null,0.1391205,0.1391205,0.1391205,0.142882222222222,0.146698545454545,0.146698545454545,null,null,null,null,0.135698,0.135698,0.184161571428571,0.184161571428571,0.184161571428571,0.184161571428571,0.184161571428571,0.2053325,null,0.280553064285714,0.280553064285714,0.280553064285714,0.001493,null,0.2612563375,0.2612563375,0.012168,null,0.0631215,null,null,0.2488356,0.2488356,0.2488356,null,null,null,0.0967302857142857,null,0.0967302857142857,0.0967302857142857,0.0967302857142857,0.0967302857142857,0.0967302857142857,0.0967302857142857,null,0.112852,0.113274666666667,null,null,0.1511456,0.209104727272727,null,null,null,null,null,0.189904,null,null,0.227656,0.227656,0.227656,0.227656,0.227656,null],[null,0.06692,null,null,0.108745,null,0.108745,null,0.148269625,null,0.148269625,0.148269625,0.148269625,0.148269625,null,null,null,null,0.11153,0.11153,null,0.25167625,null,0.25167625,null,0.27002,null,0.358689611111111,null,null,0.001021,null,0.269544,null,null,null,0.097774,null,null,0.3471659,null,null,null,null,null,0.0732342857142857,null,0.0732342857142857,0.0732342857142857,0.0732342857142857,0.0732342857142857,0.0732342857142857,0.0732342857142857,null,0.08544,0.08576,null,null,0.114432,0.158312727272727,null,null,null,null,null,0.14691,null,null,0.209165727272727,0.209165727272727,null,0.209165727272727,0.209165727272727,null],[null,null,null,null,0.1254825,null,0.1254825,null,0.1520805,null,null,0.1520805,0.1520805,0.1520805,null,null,null,null,0.092302,0.092302,null,0.20828675,null,0.20828675,null,0.223468,null,0.3388455,null,null,0.000717,null,0.189288,null,null,null,null,null,null,0.340831591935484,null,null,null,null,null,0.063724,null,0.063724,null,0.063724,0.063724,0.063724,0.063724,null,0.071958,0.071958,null,null,0.0948302222222222,null,null,null,null,null,null,0.111801,null,null,0.18352875,0.18352875,null,0.18352875,null,null],[null,null,null,null,0.0972075,null,0.0972075,null,0.1381842,null,null,0.1381842,0.1381842,null,null,null,null,null,0.076798,0.076798,null,0.17330075,null,0.17330075,null,null,null,0.3383154,null,null,0.000522,null,0.137808,null,null,null,null,null,null,0.327921818181818,null,null,null,null,null,0.0499735,null,0.0499735,null,0.0499735,0.0499735,0.0499735,0.0499735,null,0.05643075,0.05643075,null,null,0.0743675555555555,null,null,null,null,null,null,0.087814,null,null,0.1441525,0.1441525,null,0.1441525,null,null],[null,null,null,null,0.075855,null,0.075855,null,null,null,null,null,null,null,null,null,null,null,0.11786,null,null,null,null,0.28469,null,null,null,null,null,null,null,null,0.13929005,null,null,null,null,null,null,null,null,null,null,null,null,0.038893,null,0.038893,null,0.038893,0.038893,0.038893,0.038893,null,0.0439185,0.0439185,null,null,0.0578782222222222,null,null,null,null,null,null,0.067811,null,null,0.145426,null,null,0.148421666666667,null,null],[null,null,null,null,0.0595725,null,0.0595725,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.420108836036036,null,null,null,null,null,null,null,null,0.1211899,null,null,null,null,null,null,null,null,null,null,null,null,0.04438875,null,0.04438875,null,null,null,0.04438875,0.04438875,null,null,0.053466,null,null,0.0660566666666667,null,null,null,null,null,null,0.052871,null,null,0.113386,null,null,0.115721666666667,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_3suppSNP<\/th>\n      <th>FDR_4suppSNP<\/th>\n      <th>FDR_5suppSNP<\/th>\n      <th>FDR_6suppSNP<\/th>\n      <th>FDR_7suppSNP<\/th>\n      <th>FDR_8suppSNP<\/th>\n      <th>FDR_9suppSNP<\/th>\n      <th>FDR_10suppSNP<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="eas" class="section level3">
<h3>EAS</h3>
<pre class="r"><code>df_all_FDR01 &lt;- c()
df_all_FDR02 &lt;- c()
df_p0001 &lt;- c()
for (celltype in celltypes){
  
  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_40genes_EAS.RDS&quot;))
  
  tmp_FDR01 &lt;- c(unique(df$celltype),sum(df$FDR_3suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_4suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_5suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_6suppSNP &lt; 0.1,na.rm = T),
                 sum(df$FDR_7suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_8suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_9suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_10suppSNP &lt; 0.1,na.rm = T))
  tmp_FDR02 &lt;- c(unique(df$celltype),sum(df$FDR_3suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_4suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_5suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_6suppSNP &lt; 0.2,na.rm = T),
                 sum(df$FDR_7suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_8suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_9suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_10suppSNP &lt; 0.2,na.rm = T))
  tmp_FDR02[2:length(tmp_FDR02)] &lt;- as.numeric(tmp_FDR02[2:length(tmp_FDR02)]) - as.numeric(tmp_FDR01[2:length(tmp_FDR01)])
  
  df_all_FDR01 &lt;- rbind(df_all_FDR01,tmp_FDR01)
  df_all_FDR02 &lt;- rbind(df_all_FDR02,tmp_FDR02)
  
  df_p0001 &lt;- rbind(df_p0001, df[df$p_ECT &lt; 0.001,])
  
}

df_p0001 &lt;- df_p0001[complete.cases(df_p0001$p_ECT),]

rownames(df_all_FDR01) &lt;- NULL
colnames(df_all_FDR01) &lt;- c(&quot;celltype&quot;,&quot;num_pairs_FDR01_3suppSNP&quot;,&quot;num_pairs_FDR01_4suppSNP&quot;,&quot;num_pairs_FDR01_5suppSNP&quot;,
                            &quot;num_pairs_FDR01_6suppSNP&quot;,&quot;num_pairs_FDR01_7suppSNP&quot;,&quot;num_pairs_FDR01_8suppSNP&quot;,
                            &quot;num_pairs_FDR01_9suppSNP&quot;,&quot;num_pairs_FDR01_10suppSNP&quot;)
df_all_FDR01 &lt;- as.data.frame(df_all_FDR01, stringsAsFactors = FALSE)
df_all_FDR01 &lt;- df_all_FDR01 %&gt;% mutate(across(-celltype, as.numeric))

df_long &lt;- df_all_FDR01 %&gt;%
  pivot_longer(
    cols = starts_with(&quot;num_pairs_FDR01_&quot;),
    names_to = &quot;num_suppSNP&quot;,
    values_to = &quot;num_pairs&quot;
  ) %&gt;%
  mutate(
    num_suppSNP = as.numeric(gsub(&quot;num_pairs_FDR01_|suppSNP&quot;, &quot;&quot;, num_suppSNP))
  )


ggplot(df_long, aes(x = celltype, y = num_pairs, fill = factor(num_suppSNP))) +
  geom_bar(stat = &quot;identity&quot;, position = position_dodge(width = 0.8)) +
  labs(
    x = &quot;Cell type&quot;,
    y = &quot;Number of pairs (FDR &lt; 0.1)&quot;,
    fill = &quot;Supporting SNPs&quot;
  ) +
  theme_bw(base_size = 14) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_blank()
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-4-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-1">
Past versions of unnamed-chunk-4-1.png
</button>
</p>
<div id="fig-unnamed-chunk-4-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/xsun1229/factor_analysis_new/blob/c1850407104e445781a3c4990a19486c63c29469/docs/figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-4-1.png" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>rownames(df_all_FDR02) &lt;- NULL
colnames(df_all_FDR02) &lt;- c(&quot;celltype&quot;,&quot;num_pairs_FDR02_3suppSNP&quot;,&quot;num_pairs_FDR02_4suppSNP&quot;,&quot;num_pairs_FDR02_5suppSNP&quot;,
                            &quot;num_pairs_FDR02_6suppSNP&quot;,&quot;num_pairs_FDR02_7suppSNP&quot;,&quot;num_pairs_FDR02_8suppSNP&quot;,
                            &quot;num_pairs_FDR02_9suppSNP&quot;,&quot;num_pairs_FDR02_10suppSNP&quot;)
df_all_FDR02 &lt;- as.data.frame(df_all_FDR02, stringsAsFactors = FALSE)
df_all_FDR02 &lt;- df_all_FDR02 %&gt;% mutate(across(-celltype, as.numeric))


df_long &lt;- df_all_FDR02 %&gt;%
  pivot_longer(
    cols = starts_with(&quot;num_pairs_FDR02_&quot;),
    names_to = &quot;num_suppSNP&quot;,
    values_to = &quot;num_pairs&quot;
  ) %&gt;%
  mutate(
    num_suppSNP = as.numeric(gsub(&quot;num_pairs_FDR02_|suppSNP&quot;, &quot;&quot;, num_suppSNP))
  )


ggplot(df_long, aes(x = celltype, y = num_pairs, fill = factor(num_suppSNP))) +
  geom_bar(stat = &quot;identity&quot;, position = position_dodge(width = 0.8)) +
  labs(
    x = &quot;Cell type&quot;,
    y = &quot;Number of pairs (FDR &lt; 0.2)&quot;,
    fill = &quot;Supporting SNPs&quot;
  ) +
  theme_bw(base_size = 14) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_blank()
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-4-2.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-4-2">
Past versions of unnamed-chunk-4-2.png
</button>
</p>
<div id="fig-unnamed-chunk-4-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/xsun1229/factor_analysis_new/blob/c1850407104e445781a3c4990a19486c63c29469/docs/figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-4-2.png" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>DT::datatable(df_p0001,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs &#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-ad41175326dc68f35292" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ad41175326dc68f35292">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs <\/caption>","data":[["8301","8303","8479","8739","8534","9640","8248","1871","8711","8981","10418","83011","10975","11047","2011","271","13918","13888","13698","13938","13908","13845","138","9924","13397","12168","8923","7209","722","6913","5992","1658","5173"],["B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Platelet","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD8+)","T cell (CD8+)"],["MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","PLT-ebi-a-GCST90018749","MCV-ebi-a-GCST90018746","graves-ebi-a-GCST90018627","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","PLT-ebi-a-GCST90018749","MCV-ebi-a-GCST90018746","RBC-ebi-a-GCST90018751","RBC-ebi-a-GCST90018751","graves-ebi-a-GCST90018627","ATD-bbj-a-90","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","ATD-bbj-a-90","RBC-ebi-a-GCST90018751","height-ebi-a-GCST90018739","BMI-ebi-a-GCST90018727","PLT-ebi-a-GCST90018749","RBC-ebi-a-GCST90018751","ATD-bbj-a-90","MCV-ebi-a-GCST90018746","MCH-ebi-a-GCST90018744","graves-ebi-a-GCST90018627","HCT-ebi-a-GCST90018740"],["04611_PC1","04611_PC3","04810_PC4","05133_PC4","04921_PC4","04650_PC5","04371_PC3","04540_PC1","04931_PC1","05200_PC1","05235_PC3","04210_PC1","04310_PC5","04550_PC2","04723_PC1","04110_PC1","05167_PC3","05161_PC3","04935_PC3","05200_PC3","05165_PC3","05135_PC5","03015_PC3","04640_PC4","04550_PC2","04360_PC3","04920_PC3","04010_PC4","04726_PC2","04110_PC3","04810_PC2","04120_PC3","05416_PC3"],["04611","04611","04810","05133","04921","04650","04371","04540","04931","05200","05235","04210","04310","04550","04723","04110","05167","05161","04935","05200","05165","05135","03015","04640","04550","04360","04920","04010","04726","04110","04810","04120","05416"],["Platelet activation","Platelet activation","Regulation of actin cytoskeleton","Pertussis","Oxytocin signaling pathway","Natural killer cell mediated cytotoxicity","Apelin signaling pathway","Gap junction","Insulin resistance","Pathways in cancer","PD-L1 expression and PD-1 checkpoint pathway in cancer","Apoptosis","Wnt signaling pathway","Signaling pathways regulating pluripotency of stem cells","Retrograde endocannabinoid signaling","Cell cycle","Kaposi sarcoma-associated herpesvirus infection","Hepatitis B","Growth hormone synthesis, secretion and action","Pathways in cancer","Human papillomavirus infection","Yersinia infection","mRNA surveillance pathway","Hematopoietic cell lineage","Signaling pathways regulating pluripotency of stem cells","Axon guidance","Adipocytokine signaling pathway","MAPK signaling pathway","Serotonergic synapse","Cell cycle","Regulation of actin cytoskeleton","Ubiquitin mediated proteolysis","Viral myocarditis"],[4,8,5,4,6,3,4,3,7,5,4,5,3,4,6,3,14,6,8,7,12,4,5,4,11,5,3,5,3,7,4,3,3],[1.3e-05,5.6e-05,0.000107,0.000162,0.000285,0.000531,0.000934,1e-06,3.1e-05,0.000106,0.000341,0.000601,0.000624,0.000683,0.000847,1e-06,1e-05,1.3e-05,1.4e-05,1.5e-05,0.000215,0.000272,0.000337,0.000516,0.000672,0.000689,0.000783,0.000531,1e-06,0.00052,0.000526,1e-06,0.000291],[124,124,213,76,153,134,137,88,108,531,89,136,160,140,148,124,186,162,119,531,330,120,91,99,140,181,69,295,115,124,213,136,60],[71,71,120,49,79,79,72,45,69,290,69,107,83,61,75,69,119,105,65,255,174,87,64,45,51,74,40,107,47,92,122,116,46],[0.022984,0.049504,0.0630586666666667,0.071604,0.100776,0.156468,0.235901714285714,0.002653,0.0411215,0.0937393333333333,0.22616825,0.258857,0.258857,0.258857,0.280886375,0.00144,0.00432,0.00432,0.00432,0.00432,0.0516,0.0559542857142857,0.06066,0.08256,0.0901963636363636,0.0901963636363636,0.09396,0.841104,0.001788,0.313496,0.313496,0.001115,0.1622325],[0.015795,0.03402,0.043335,0.0492075,0.069255,null,0.189135,null,0.05797,0.09911,0.212556666666667,0.2430813,null,0.2430813,0.2430813,null,0.0029775,0.0029775,0.0029775,0.0029775,0.034142,0.0359946666666667,0.0382254285714286,0.051213,0.0547066,0.0547066,null,0.578259,null,0.308499,0.308499,null,null],[null,0.0440305,0.0440305,null,0.078185,null,null,null,0.040455,0.069165,null,0.261435,null,null,0.27633375,null,0.00172875,0.00172875,0.00172875,0.00172875,0.019823,null,0.0258928333333333,null,0.039703625,0.039703625,null,0.409401,null,0.39312,null,null,null],[null,0.03136,null,null,0.0798,null,null,null,0.028117,null,null,null,null,null,0.3841145,null,0.00102,0.00102,0.00102,0.00102,0.011696,null,null,null,0.030464,null,null,null,null,0.26468,null,null,null],[null,0.020216,null,null,null,null,null,null,0.020429,null,null,null,null,null,null,null,0.000815,null,0.000815,0.000815,0.00876125,null,null,null,0.0219072,null,null,null,null,0.18408,null,null,null],[null,0.014,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.000658,null,0.000658,null,0.00673666666666667,null,null,null,0.015792,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.00059,null,null,null,0.0063425,null,null,null,0.013216,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.00037,null,null,null,0.0039775,null,null,null,0.008288,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_3suppSNP<\/th>\n      <th>FDR_4suppSNP<\/th>\n      <th>FDR_5suppSNP<\/th>\n      <th>FDR_6suppSNP<\/th>\n      <th>FDR_7suppSNP<\/th>\n      <th>FDR_8suppSNP<\/th>\n      <th>FDR_9suppSNP<\/th>\n      <th>FDR_10suppSNP<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div id="genes-1" class="section level2">
<h2>20 genes</h2>
<div id="eur-1" class="section level3">
<h3>EUR</h3>
<pre class="r"><code>df_all_FDR01 &lt;- c()
df_all_FDR02 &lt;- c()
df_p0001 &lt;- c()
for (celltype in celltypes){
  
  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_20genes_EUR.RDS&quot;))
  
  tmp_FDR01 &lt;- c(unique(df$celltype),sum(df$FDR_3suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_4suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_5suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_6suppSNP &lt; 0.1,na.rm = T),
                 sum(df$FDR_7suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_8suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_9suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_10suppSNP &lt; 0.1,na.rm = T))
  tmp_FDR02 &lt;- c(unique(df$celltype),sum(df$FDR_3suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_4suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_5suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_6suppSNP &lt; 0.2,na.rm = T),
                 sum(df$FDR_7suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_8suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_9suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_10suppSNP &lt; 0.2,na.rm = T))
  tmp_FDR02[2:length(tmp_FDR02)] &lt;- as.numeric(tmp_FDR02[2:length(tmp_FDR02)]) - as.numeric(tmp_FDR01[2:length(tmp_FDR01)])
  
  df_all_FDR01 &lt;- rbind(df_all_FDR01,tmp_FDR01)
  df_all_FDR02 &lt;- rbind(df_all_FDR02,tmp_FDR02)
  
  df_p0001 &lt;- rbind(df_p0001, df[df$p_ECT &lt; 0.001,])
  
}

df_p0001 &lt;- df_p0001[complete.cases(df_p0001$p_ECT),]

rownames(df_all_FDR01) &lt;- NULL
colnames(df_all_FDR01) &lt;- c(&quot;celltype&quot;,&quot;num_pairs_FDR01_3suppSNP&quot;,&quot;num_pairs_FDR01_4suppSNP&quot;,&quot;num_pairs_FDR01_5suppSNP&quot;,
                            &quot;num_pairs_FDR01_6suppSNP&quot;,&quot;num_pairs_FDR01_7suppSNP&quot;,&quot;num_pairs_FDR01_8suppSNP&quot;,
                            &quot;num_pairs_FDR01_9suppSNP&quot;,&quot;num_pairs_FDR01_10suppSNP&quot;)
df_all_FDR01 &lt;- as.data.frame(df_all_FDR01, stringsAsFactors = FALSE)
df_all_FDR01 &lt;- df_all_FDR01 %&gt;% mutate(across(-celltype, as.numeric))

df_long &lt;- df_all_FDR01 %&gt;%
  pivot_longer(
    cols = starts_with(&quot;num_pairs_FDR01_&quot;),
    names_to = &quot;num_suppSNP&quot;,
    values_to = &quot;num_pairs&quot;
  ) %&gt;%
  mutate(
    num_suppSNP = as.numeric(gsub(&quot;num_pairs_FDR01_|suppSNP&quot;, &quot;&quot;, num_suppSNP))
  )


ggplot(df_long, aes(x = celltype, y = num_pairs, fill = factor(num_suppSNP))) +
  geom_bar(stat = &quot;identity&quot;, position = position_dodge(width = 0.8)) +
  labs(
    x = &quot;Cell type&quot;,
    y = &quot;Number of pairs (FDR &lt; 0.1)&quot;,
    fill = &quot;Supporting SNPs&quot;
  ) +
  theme_bw(base_size = 14) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_blank()
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-5-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-1">
Past versions of unnamed-chunk-5-1.png
</button>
</p>
<div id="fig-unnamed-chunk-5-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/xsun1229/factor_analysis_new/blob/c1850407104e445781a3c4990a19486c63c29469/docs/figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-5-1.png" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>rownames(df_all_FDR02) &lt;- NULL
colnames(df_all_FDR02) &lt;- c(&quot;celltype&quot;,&quot;num_pairs_FDR02_3suppSNP&quot;,&quot;num_pairs_FDR02_4suppSNP&quot;,&quot;num_pairs_FDR02_5suppSNP&quot;,
                            &quot;num_pairs_FDR02_6suppSNP&quot;,&quot;num_pairs_FDR02_7suppSNP&quot;,&quot;num_pairs_FDR02_8suppSNP&quot;,
                            &quot;num_pairs_FDR02_9suppSNP&quot;,&quot;num_pairs_FDR02_10suppSNP&quot;)
df_all_FDR02 &lt;- as.data.frame(df_all_FDR02, stringsAsFactors = FALSE)
df_all_FDR02 &lt;- df_all_FDR02 %&gt;% mutate(across(-celltype, as.numeric))


df_long &lt;- df_all_FDR02 %&gt;%
  pivot_longer(
    cols = starts_with(&quot;num_pairs_FDR02_&quot;),
    names_to = &quot;num_suppSNP&quot;,
    values_to = &quot;num_pairs&quot;
  ) %&gt;%
  mutate(
    num_suppSNP = as.numeric(gsub(&quot;num_pairs_FDR02_|suppSNP&quot;, &quot;&quot;, num_suppSNP))
  )


ggplot(df_long, aes(x = celltype, y = num_pairs, fill = factor(num_suppSNP))) +
  geom_bar(stat = &quot;identity&quot;, position = position_dodge(width = 0.8)) +
  labs(
    x = &quot;Cell type&quot;,
    y = &quot;Number of pairs (FDR &lt; 0.2)&quot;,
    fill = &quot;Supporting SNPs&quot;
  ) +
  theme_bw(base_size = 14) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_blank()
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-5-2.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-5-2">
Past versions of unnamed-chunk-5-2.png
</button>
</p>
<div id="fig-unnamed-chunk-5-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/xsun1229/factor_analysis_new/blob/c1850407104e445781a3c4990a19486c63c29469/docs/figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-5-2.png" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>DT::datatable(df_p0001,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs &#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-66aaeb19fe992dfb51c2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-66aaeb19fe992dfb51c2">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs <\/caption>","data":[["18394","21895","17077","15475","15680","4953","4788","22363","12138","20233","17768","1279","7543","13082","6747","8037","20207","8265","19930","1966","10172","21117","21336","22213","22233","19986","4930","2128","25890","7533","1652","14330","1687","25298","8573","5744","23968","22453","14183","25127","13400","12404","13716","23401","15995","13626","12179","11599","4211","12175","18225","11820","14440","4944","2645","7827","8458","4744","17554","5944","244","21015","21482","22190","20831","7597","4632","14344","23130","23328","20307","7774","20874","15398","10256","5078","14773","24744","4109","25993","23455","7499","19681","19702","19714","19877","20106","20178","20319","20400","10232","9952","9716","14267","9951","9731","9871","14481","9102","24548","15435","12913","14764","9362","15302","15314","15178","15912","9536"],["B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","Platelet","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)","T cell (CD8+)"],["RA-ukb-a-105","SLE-ebi-a-GCST90018917","Psoriasis-ebi-a-GCST90038681","MCV-ebi-a-GCST90002392","PLT-ebi-a-GCST90002402","CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","T1D-ebi-a-GCST90014023","LDL-ukb-d-30780_irnt","RBC-ebi-a-GCST90002403","Psoriasis-ebi-a-GCST90038681","allergy-ebi-a-GCST005038","HB-ebi-a-GCST90002384","MCH-ebi-a-GCST90002390","HB-ebi-a-GCST90002384","HCT-ebi-a-GCST90002383","RBC-ebi-a-GCST90002403","HCT-ebi-a-GCST90002383","RBC-ebi-a-GCST90002403","asthma_pmid36778051","HT-ebi-a-GCST90018855","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","RBC-ebi-a-GCST90002403","CD-ebi-a-GCST003044","asthma_pmid36778051","WBC-ebi-a-GCST90002407","HB-ebi-a-GCST90002384","asthma_pmid36778051","MCH-ebi-a-GCST90002390","asthma_pmid36778051","WBC-ebi-a-GCST90002407","HCT-ebi-a-GCST90002383","celiac-ieu-a-1058","UC-ebi-a-GCST003045","T1D-ebi-a-GCST90014023","MCH-ebi-a-GCST90002390","WBC-ebi-a-GCST90002407","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","WBC-ebi-a-GCST90002407","Psoriasis-ebi-a-GCST90038681","MCV-ebi-a-GCST90002392","MCH-ebi-a-GCST90002390","LDL-ukb-d-30780_irnt","HB-ebi-a-GCST90002384","PLT-ebi-a-GCST90002402","UC-ebi-a-GCST003045","PLT-ebi-a-GCST90002402","RBC-ebi-a-GCST90002403","HB-ebi-a-GCST90002384","CD-ebi-a-GCST003044","IBD-ebi-a-GCST003043","LDL-ukb-d-30780_irnt","HB-ebi-a-GCST90002384","UC-ebi-a-GCST003045","HCT-ebi-a-GCST90002383","allergy-ebi-a-GCST005038","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","RBC-ebi-a-GCST90002403","HB-ebi-a-GCST90002384","CD-ebi-a-GCST003044","MCH-ebi-a-GCST90002390","T1D-ebi-a-GCST90014023","T1D-ebi-a-GCST90014023","RBC-ebi-a-GCST90002403","HB-ebi-a-GCST90002384","RBC-ebi-a-GCST90002403","MCV-ebi-a-GCST90002392","HT-ebi-a-GCST90018855","CD-ebi-a-GCST003044","MCV-ebi-a-GCST90002392","UC-ebi-a-GCST003045","CD-ebi-a-GCST003044","WBC-ebi-a-GCST90002407","T1D-ebi-a-GCST90014023","HB-ebi-a-GCST90002384","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","PLT-ebi-a-GCST90002402","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","PLT-ebi-a-GCST90002402","IBD-ebi-a-GCST003043","WBC-ebi-a-GCST90002407","PLT-ebi-a-GCST90002402","MCH-ebi-a-GCST90002390","PLT-ebi-a-GCST90002402","IBD-ebi-a-GCST003043","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","Psoriasis-ebi-a-GCST90038681","IBD-ebi-a-GCST003043"],["04071_PC4","05330_PC5","04062_PC2","05416_PC5","03018_PC5","05167_PC3","05010_PC3","04211_PC3","04512_PC3","04970_PC3","05133_PC3","05414_PC4","05169_PC3","03010_PC2","04060_PC2","04060_PC2","04934_PC2","04510_PC5","04621_PC5","04720_PC1","05131_PC2","00970_PC2","04120_PC1","05320_PC3","05330_PC3","04068_PC1","05130_PC5","04924_PC3","05130_PC5","05100_PC3","04070_PC2","05225_PC5","04120_PC2","04142_PC3","04725_PC3","04340_PC4","04136_PC3","01523_PC3","05163_PC3","03050_PC2","04020_PC5","04910_PC4","04970_PC1","05218_PC1","04924_PC5","04921_PC1","04371_PC4","05203_PC4","04064_PC1","05416_PC5","05231_PC5","04934_PC5","04144_PC5","05205_PC4","04923_PC5","05031_PC2","04390_PC3","04971_PC4","04270_PC4","05200_PC4","04150_PC4","00280_PC5","04371_PC2","05225_PC5","05216_PC1","05145_PC2","04722_PC2","05231_PC4","04931_PC5","05150_PC3","04666_PC2","05224_PC4","05224_PC4","05100_PC3","05164_PC1","05206_PC3","04110_PC3","05212_PC4","01522_PC4","05167_PC3","05216_PC5","05012_PC4","03460_PC1","04015_PC2","04022_PC4","04217_PC2","04721_PC1","04912_PC3","04972_PC4","05110_PC5","05216_PC2","04971_PC2","04670_PC1","00052_PC2","04971_PC1","04713_PC1","04924_PC1","03410_PC1","00230_PC2","05320_PC3","05220_PC5","05330_PC3","04390_PC4","04060_PC2","05161_PC2","05163_PC4","05014_PC3","04136_PC2","04270_PC1"],["04071","05330","04062","05416","03018","05167","05010","04211","04512","04970","05133","05414","05169","03010","04060","04060","04934","04510","04621","04720","05131","00970","04120","05320","05330","04068","05130","04924","05130","05100","04070","05225","04120","04142","04725","04340","04136","01523","05163","03050","04020","04910","04970","05218","04924","04921","04371","05203","04064","05416","05231","04934","04144","05205","04923","05031","04390","04971","04270","05200","04150","00280","04371","05225","05216","05145","04722","05231","04931","05150","04666","05224","05224","05100","05164","05206","04110","05212","01522","05167","05216","05012","03460","04015","04022","04217","04721","04912","04972","05110","05216","04971","04670","00052","04971","04713","04924","03410","00230","05320","05220","05330","04390","04060","05161","05163","05014","04136","04270"],["Sphingolipid signaling pathway","Allograft rejection","Chemokine signaling pathway","Viral myocarditis","RNA degradation","Kaposi sarcoma-associated herpesvirus infection","Alzheimer disease","Longevity regulating pathway","ECM-receptor interaction","Salivary secretion","Pertussis","Dilated cardiomyopathy","Epstein-Barr virus infection","Ribosome","Cytokine-cytokine receptor interaction","Cytokine-cytokine receptor interaction","Cushing syndrome","Focal adhesion","NOD-like receptor signaling pathway","Long-term potentiation","Shigellosis","Aminoacyl-tRNA biosynthesis","Ubiquitin mediated proteolysis","Autoimmune thyroid disease","Allograft rejection","FoxO signaling pathway","Pathogenic Escherichia coli infection","Renin secretion","Pathogenic Escherichia coli infection","Bacterial invasion of epithelial cells","Phosphatidylinositol signaling system","Hepatocellular carcinoma","Ubiquitin mediated proteolysis","Lysosome","Cholinergic synapse","Hedgehog signaling pathway","Autophagy - other","Antifolate resistance","Human cytomegalovirus infection","Proteasome","Calcium signaling pathway","Insulin signaling pathway","Salivary secretion","Melanoma","Renin secretion","Oxytocin signaling pathway","Apelin signaling pathway","Viral carcinogenesis","NF-kappa B signaling pathway","Viral myocarditis","Choline metabolism in cancer","Cushing syndrome","Endocytosis","Proteoglycans in cancer","Regulation of lipolysis in adipocytes","Amphetamine addiction","Hippo signaling pathway","Gastric acid secretion","Vascular smooth muscle contraction","Pathways in cancer","mTOR signaling pathway","Valine, leucine and isoleucine degradation","Apelin signaling pathway","Hepatocellular carcinoma","Thyroid cancer","Toxoplasmosis","Neurotrophin signaling pathway","Choline metabolism in cancer","Insulin resistance","Staphylococcus aureus infection","Fc gamma R-mediated phagocytosis","Breast cancer","Breast cancer","Bacterial invasion of epithelial cells","Influenza A","MicroRNAs in cancer","Cell cycle","Pancreatic cancer","Endocrine resistance","Kaposi sarcoma-associated herpesvirus infection","Thyroid cancer","Parkinson disease","Fanconi anemia pathway","Rap1 signaling pathway","cGMP-PKG signaling pathway","Necroptosis","Synaptic vesicle cycle","GnRH signaling pathway","Pancreatic secretion","Vibrio cholerae infection","Thyroid cancer","Gastric acid secretion","Leukocyte transendothelial migration","Galactose metabolism","Gastric acid secretion","Circadian entrainment","Renin secretion","Base excision repair","Purine metabolism","Autoimmune thyroid disease","Chronic myeloid leukemia","Allograft rejection","Hippo signaling pathway","Cytokine-cytokine receptor interaction","Hepatitis B","Human cytomegalovirus infection","Amyotrophic lateral sclerosis","Autophagy - other","Vascular smooth muscle contraction"],[3,3,6,5,4,11,5,12,3,7,3,5,8,5,6,8,8,7,4,4,3,3,3,3,3,9,8,6,5,8,5,12,5,7,4,7,5,5,8,5,5,8,3,5,4,4,15,5,5,4,4,6,3,4,3,4,8,5,5,5,3,3,3,3,5,17,4,22,6,5,9,9,10,17,4,9,12,3,3,13,3,6,3,3,3,3,3,3,3,3,4,5,10,4,5,4,4,4,4,13,10,4,8,5,17,6,15,4,3],[1e-06,1e-06,4e-05,0.000138,0.000176,0.000191,0.000194,0.000195,0.000233,0.00035,0.000399,0.000424,0.000438,0.00045,0.000489,0.000565,0.000693,0.000709,0.000732,0.000866,1e-06,1e-06,1e-06,1e-06,1e-06,7.1e-05,7.6e-05,0.000105,0.000224,0.000288,0.000309,0.000343,0.000361,0.00046,0.000515,0.000659,0.000761,0.000779,0.000837,0.000863,0.000895,1e-06,0.000159,0.000319,0.000405,0.000506,0.000528,0.000999,8e-06,2.1e-05,4e-05,8.3e-05,9e-05,0.000109,0.000435,0.000535,0.00064,0.000677,0.000803,0.000818,0.000926,1e-06,1e-06,1e-06,5.1e-05,9.5e-05,0.000111,0.000148,0.000162,0.000182,0.000212,0.000228,0.000251,0.000267,0.000287,0.000356,0.000402,0.000478,0.000484,0.000596,0.000616,0.000907,1e-06,1e-06,1e-06,1e-06,1e-06,1e-06,1e-06,1e-06,3.1e-05,5e-05,8.3e-05,0.00014,0.000189,0.000255,0.000274,0.000312,0.000337,0.000342,0.000356,0.000367,0.000436,0.000527,0.000545,0.000597,0.000708,0.000966,0.000981],[119,38,189,60,79,186,171,89,88,90,76,96,201,153,294,294,155,199,181,67,236,66,136,53,38,131,202,69,202,73,99,168,136,123,112,50,32,31,225,45,193,137,90,72,69,153,137,201,102,60,98,155,249,204,55,69,155,75,132,531,153,48,137,168,37,112,119,98,108,96,93,147,147,73,170,310,124,76,98,186,37,142,54,210,167,162,78,93,102,50,37,75,112,31,75,97,69,33,130,53,76,38,155,294,162,225,57,32,132],[77,28,109,46,65,127,111,56,31,34,49,31,158,126,101,101,75,105,115,40,164,22,110,23,24,85,129,30,129,49,66,102,110,106,58,20,27,20,152,40,81,87,33,32,28,74,69,121,47,32,43,46,111,82,22,27,41,28,55,204,55,37,70,106,29,74,90,56,69,37,66,73,73,48,122,117,92,56,55,135,29,87,29,108,78,97,37,53,40,36,29,34,69,20,34,42,28,31,66,29,64,30,75,118,113,152,39,27,54],[0.0027865,0.0027865,0.0743066666666667,0.135841875,0.135841875,0.135841875,0.135841875,0.135841875,0.144278777777778,0.179132142857143,0.179132142857143,0.179132142857143,0.179132142857143,0.179132142857143,0.1816798,0.1967965625,0.214707157894737,0.214707157894737,0.214707157894737,0.2413109,0.0015352,0.0015352,0.0015352,0.0015352,0.0015352,0.0833394285714286,0.0833394285714286,0.1007475,0.191047111111111,0.213156615384615,0.213156615384615,0.213156615384615,0.213156615384615,0.252211428571429,0.263542666666667,0.31615525,0.316706074074074,0.316706074074074,0.316706074074074,0.316706074074074,0.316706074074074,0.00408,0.32436,0.339966,0.339966,0.339966,0.339966,0.339966,0.033584,0.044079,0.0559733333333333,0.075564,0.075564,0.0762636666666667,0.260875714285714,0.28074125,0.2842046,0.2842046,0.286163666666667,0.286163666666667,0.299026769230769,0.00200566666666667,0.00200566666666667,0.00200566666666667,0.07671675,0.1113145,0.1113145,0.121677111111111,0.121677111111111,0.121677111111111,0.1233485,0.1233485,0.1233485,0.1233485,0.1233485,0.142803466666667,0.151177125,0.161790444444444,0.161790444444444,0.1853236,0.1853236,0.222341230434783,0.0007145,0.0007145,0.0007145,0.0007145,0.0007145,0.0007145,0.0007145,0.0007145,0.0196884444444444,0.02858,0.0431298181818182,0.0666866666666667,0.0831018461538462,0.104112857142857,0.104412266666667,0.1048886,0.1048886,0.1048886,0.1048886,0.1048886,0.118675047619048,0.135444347826087,0.135444347826087,0.1421855,0.16187712,0.200816983783784,0.200816983783784],[null,null,0.129285,0.129285,0.129285,0.129285,0.129285,0.129285,null,0.176840181818182,null,0.176840181818182,0.176840181818182,0.176840181818182,0.176840181818182,0.1872975,0.1941264,0.1941264,0.1941264,0.21530925,null,null,null,null,null,0.203245,0.203245,0.203245,0.262040875,0.262040875,0.262040875,0.262040875,0.262040875,0.296802222222222,0.2990605,0.319355965,0.319355965,0.319355965,0.319355965,0.319355965,0.319355965,0.002779,null,0.2778652625,0.2778652625,0.2778652625,0.2778652625,0.2778652625,0.024144,0.031689,0.04024,0.0626235,null,0.0657924,null,0.2468724,0.2468724,0.2468724,0.2468724,0.2468724,null,null,null,null,0.112060454545455,0.112060454545455,0.112060454545455,0.112060454545455,0.112060454545455,0.112060454545455,0.112060454545455,0.112060454545455,0.112060454545455,0.112060454545455,0.112060454545455,0.127418333333333,0.132814615384615,null,null,0.182844285714286,null,0.208589742857143,null,null,null,null,null,null,null,null,0.100025,0.100025,0.110694333333333,0.122363916666667,0.122363916666667,0.122363916666667,0.122363916666667,0.122363916666667,0.122363916666667,0.122363916666667,0.122363916666667,0.122363916666667,0.134187384615385,0.145369666666667,0.145369666666667,0.1492873125,0.166629882352941,0.200033329166667,null],[null,null,0.111657,0.111657,null,0.111657,0.111657,0.111657,null,0.1400007,null,0.1400007,0.1400007,0.1400007,0.1400007,0.147054090909091,0.156143615384615,0.156143615384615,null,null,null,null,null,null,null,0.156625,0.156625,0.156625,0.201934375,0.201934375,0.201934375,0.201934375,0.201934375,0.228722222222222,null,0.267008333333333,0.267008333333333,0.267008333333333,0.267008333333333,0.267008333333333,0.267008333333333,0.001895,null,0.26528105,null,null,0.26528105,0.26528105,0.017936,null,null,0.093043,null,null,null,null,0.305659333333333,0.305659333333333,0.305659333333333,0.305659333333333,null,null,null,null,0.0919666666666667,0.0919666666666667,null,0.0919666666666667,0.0919666666666667,0.0919666666666667,0.0919666666666667,0.0919666666666667,0.0919666666666667,0.0919666666666667,null,0.11036,0.113290909090909,null,null,0.153966666666667,null,0.192392413793103,null,null,null,null,null,null,null,null,null,0.120184,0.120184,null,0.182448,null,null,null,null,0.192101333333333,0.192101333333333,null,0.192101333333333,0.192101333333333,0.192101333333333,0.192101333333333,0.2050368,null,null],[null,null,0.08196,null,null,0.133185,null,0.133185,null,0.161415666666667,null,null,0.161415666666667,null,0.161415666666667,0.161415666666667,0.161415666666667,0.161415666666667,null,null,null,null,null,null,null,0.125475,0.125475,0.125475,null,0.245931,null,0.245931,null,0.27485,null,0.337502142857143,null,null,0.358467409090909,null,null,0.001285,null,null,null,null,0.33924,null,null,null,null,0.141183,null,null,null,null,0.348888184615385,null,null,null,null,null,null,null,null,0.086508,null,0.086508,0.086508,null,0.086508,0.086508,0.086508,0.086508,null,0.100926,0.101304,null,null,0.1351728,null,0.167615060869565,null,null,null,null,null,null,null,null,null,null,0.181438,null,null,null,null,null,null,0.2029701,0.2029701,null,0.2029701,null,0.2029701,0.2029701,0.2029701,null,null],[null,null,null,null,null,0.1498575,null,0.1498575,null,0.155676142857143,null,null,0.155676142857143,null,null,0.155676142857143,0.155676142857143,0.155676142857143,null,null,null,null,null,null,null,0.110656,0.110656,null,null,0.249704,null,0.249704,null,0.267904,null,0.319834666666667,null,null,0.348192,null,null,0.000881,null,null,null,null,0.232584,null,null,null,null,null,null,null,null,null,0.32946705,null,null,null,null,null,null,null,null,0.074493,null,0.074493,null,null,0.074493,0.074493,0.074493,0.074493,null,0.0841185,0.0841185,null,null,0.110856,null,null,null,null,null,null,null,null,null,null,null,null,0.137365,null,null,null,null,null,null,0.180395,0.180395,null,0.180395,null,0.180395,null,0.19529,null,null],[null,null,null,null,null,0.1135875,null,0.1135875,null,null,null,null,0.161469,null,null,0.161469,0.161469,null,null,null,null,null,null,null,null,0.09006,0.09006,null,null,0.2032275,null,0.2032275,null,null,null,null,null,null,0.396738,null,null,0.000625,null,null,null,null,0.165,null,null,null,null,null,null,null,null,null,0.328319496855346,null,null,null,null,null,null,null,null,0.057672,null,0.057672,null,null,0.057672,0.057672,0.057672,0.057672,null,0.065124,0.065124,null,null,0.085824,null,null,null,null,null,null,null,null,null,null,null,null,0.106572,null,null,null,null,null,null,0.139956,0.139956,null,0.139956,null,0.139956,null,0.151512,null,null],[null,null,null,null,null,0.087555,null,0.087555,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.136462,null,null,null,null,null,0.329623,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.16448825,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.0432985,null,0.0432985,null,null,0.0432985,0.0432985,0.0432985,0.0432985,null,0.04889325,0.04889325,null,null,0.0644342222222222,null,null,null,null,null,null,null,null,null,null,null,null,0.081506,null,null,null,null,null,null,0.116530666666667,0.116530666666667,null,null,null,0.1337975,null,0.1390512,null,null],[null,null,null,null,null,0.0677625,null,0.0677625,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.399899828358209,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.139588366666667,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.049128,null,0.049128,null,null,null,null,0.049128,0.049128,null,null,0.0591744,null,null,0.0731093333333333,null,null,null,null,null,null,null,null,null,null,null,null,0.063163,null,null,null,null,null,null,0.0903053333333333,0.0903053333333333,null,null,null,0.10368625,null,0.1077576,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_3suppSNP<\/th>\n      <th>FDR_4suppSNP<\/th>\n      <th>FDR_5suppSNP<\/th>\n      <th>FDR_6suppSNP<\/th>\n      <th>FDR_7suppSNP<\/th>\n      <th>FDR_8suppSNP<\/th>\n      <th>FDR_9suppSNP<\/th>\n      <th>FDR_10suppSNP<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="eas-1" class="section level3">
<h3>EAS</h3>
<pre class="r"><code>df_all_FDR01 &lt;- c()
df_all_FDR02 &lt;- c()
df_p0001 &lt;- c()
for (celltype in celltypes){
  
  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_20genes_EAS.RDS&quot;))
  
  tmp_FDR01 &lt;- c(unique(df$celltype),sum(df$FDR_3suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_4suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_5suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_6suppSNP &lt; 0.1,na.rm = T),
                 sum(df$FDR_7suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_8suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_9suppSNP &lt; 0.1,na.rm = T),sum(df$FDR_10suppSNP &lt; 0.1,na.rm = T))
  tmp_FDR02 &lt;- c(unique(df$celltype),sum(df$FDR_3suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_4suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_5suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_6suppSNP &lt; 0.2,na.rm = T),
                 sum(df$FDR_7suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_8suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_9suppSNP &lt; 0.2,na.rm = T),sum(df$FDR_10suppSNP &lt; 0.2,na.rm = T))
  tmp_FDR02[2:length(tmp_FDR02)] &lt;- as.numeric(tmp_FDR02[2:length(tmp_FDR02)]) - as.numeric(tmp_FDR01[2:length(tmp_FDR01)])
  
  df_all_FDR01 &lt;- rbind(df_all_FDR01,tmp_FDR01)
  df_all_FDR02 &lt;- rbind(df_all_FDR02,tmp_FDR02)
  
  df_p0001 &lt;- rbind(df_p0001, df[df$p_ECT &lt; 0.001,])
  
}

df_p0001 &lt;- df_p0001[complete.cases(df_p0001$p_ECT),]

rownames(df_all_FDR01) &lt;- NULL
colnames(df_all_FDR01) &lt;- c(&quot;celltype&quot;,&quot;num_pairs_FDR01_3suppSNP&quot;,&quot;num_pairs_FDR01_4suppSNP&quot;,&quot;num_pairs_FDR01_5suppSNP&quot;,
                            &quot;num_pairs_FDR01_6suppSNP&quot;,&quot;num_pairs_FDR01_7suppSNP&quot;,&quot;num_pairs_FDR01_8suppSNP&quot;,
                            &quot;num_pairs_FDR01_9suppSNP&quot;,&quot;num_pairs_FDR01_10suppSNP&quot;)
df_all_FDR01 &lt;- as.data.frame(df_all_FDR01, stringsAsFactors = FALSE)
df_all_FDR01 &lt;- df_all_FDR01 %&gt;% mutate(across(-celltype, as.numeric))

df_long &lt;- df_all_FDR01 %&gt;%
  pivot_longer(
    cols = starts_with(&quot;num_pairs_FDR01_&quot;),
    names_to = &quot;num_suppSNP&quot;,
    values_to = &quot;num_pairs&quot;
  ) %&gt;%
  mutate(
    num_suppSNP = as.numeric(gsub(&quot;num_pairs_FDR01_|suppSNP&quot;, &quot;&quot;, num_suppSNP))
  )


ggplot(df_long, aes(x = celltype, y = num_pairs, fill = factor(num_suppSNP))) +
  geom_bar(stat = &quot;identity&quot;, position = position_dodge(width = 0.8)) +
  labs(
    x = &quot;Cell type&quot;,
    y = &quot;Number of pairs (FDR &lt; 0.1)&quot;,
    fill = &quot;Supporting SNPs&quot;
  ) +
  theme_bw(base_size = 14) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_blank()
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-6-1.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-1">
Past versions of unnamed-chunk-6-1.png
</button>
</p>
<div id="fig-unnamed-chunk-6-1" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/xsun1229/factor_analysis_new/blob/c1850407104e445781a3c4990a19486c63c29469/docs/figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-6-1.png" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>rownames(df_all_FDR02) &lt;- NULL
colnames(df_all_FDR02) &lt;- c(&quot;celltype&quot;,&quot;num_pairs_FDR02_3suppSNP&quot;,&quot;num_pairs_FDR02_4suppSNP&quot;,&quot;num_pairs_FDR02_5suppSNP&quot;,
                            &quot;num_pairs_FDR02_6suppSNP&quot;,&quot;num_pairs_FDR02_7suppSNP&quot;,&quot;num_pairs_FDR02_8suppSNP&quot;,
                            &quot;num_pairs_FDR02_9suppSNP&quot;,&quot;num_pairs_FDR02_10suppSNP&quot;)
df_all_FDR02 &lt;- as.data.frame(df_all_FDR02, stringsAsFactors = FALSE)
df_all_FDR02 &lt;- df_all_FDR02 %&gt;% mutate(across(-celltype, as.numeric))


df_long &lt;- df_all_FDR02 %&gt;%
  pivot_longer(
    cols = starts_with(&quot;num_pairs_FDR02_&quot;),
    names_to = &quot;num_suppSNP&quot;,
    values_to = &quot;num_pairs&quot;
  ) %&gt;%
  mutate(
    num_suppSNP = as.numeric(gsub(&quot;num_pairs_FDR02_|suppSNP&quot;, &quot;&quot;, num_suppSNP))
  )


ggplot(df_long, aes(x = celltype, y = num_pairs, fill = factor(num_suppSNP))) +
  geom_bar(stat = &quot;identity&quot;, position = position_dodge(width = 0.8)) +
  labs(
    x = &quot;Cell type&quot;,
    y = &quot;Number of pairs (FDR &lt; 0.2)&quot;,
    fill = &quot;Supporting SNPs&quot;
  ) +
  theme_bw(base_size = 14) +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1),
    panel.grid.major.x = element_blank()
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-6-2.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-6-2">
Past versions of unnamed-chunk-6-2.png
</button>
</p>
<div id="fig-unnamed-chunk-6-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/xsun1229/factor_analysis_new/blob/c1850407104e445781a3c4990a19486c63c29469/docs/figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-6-2.png" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
<pre class="r"><code>DT::datatable(df_p0001,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs &#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-1814506231684700bf53" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1814506231684700bf53">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs <\/caption>","data":[["1263","8301","8303","8479","8739","8534","9640","8982","11652","8248","1871","8711","15340","8981","10418","1376","6664","83011","10975","7906","11047","2011","271","743","13918","13888","13698","13938","13908","13845","8846","138","13729","13544","9924","13397","12168","8923","7209","722","1332","6913","5992","1658","5173"],["B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","B cell (CD19+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Monocyte (CD14+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Leukocyte (CD15+)","Platelet","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD4+)","T cell (CD8+)","T cell (CD8+)"],["ATD-bbj-a-90","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","PLT-ebi-a-GCST90018749","MCV-ebi-a-GCST90018746","WBC-ebi-a-GCST90018758","MCV-ebi-a-GCST90018746","graves-ebi-a-GCST90018627","MCV-ebi-a-GCST90018746","height-ebi-a-GCST90018739","MCV-ebi-a-GCST90018746","PLT-ebi-a-GCST90018749","graves-ebi-a-GCST90018627","MCH-ebi-a-GCST90018744","MCV-ebi-a-GCST90018746","RBC-ebi-a-GCST90018751","MCV-ebi-a-GCST90018746","RBC-ebi-a-GCST90018751","graves-ebi-a-GCST90018627","ATD-bbj-a-90","ATD-bbj-a-90","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","PLT-ebi-a-GCST90018749","ATD-bbj-a-90","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","RBC-ebi-a-GCST90018751","height-ebi-a-GCST90018739","BMI-ebi-a-GCST90018727","PLT-ebi-a-GCST90018749","RBC-ebi-a-GCST90018751","ATD-bbj-a-90","graves-ebi-a-GCST90018627","MCV-ebi-a-GCST90018746","MCH-ebi-a-GCST90018744","graves-ebi-a-GCST90018627","HCT-ebi-a-GCST90018740"],["05340_PC3","04611_PC1","04611_PC3","04810_PC4","05133_PC4","04921_PC4","04650_PC5","05322_PC2","00270_PC2","04371_PC3","04540_PC1","04931_PC1","04979_PC5","05200_PC1","05235_PC3","00380_PC1","00563_PC4","04210_PC1","04310_PC5","00270_PC1","04550_PC2","04723_PC1","04110_PC1","04929_PC3","05167_PC3","05161_PC3","04935_PC3","05200_PC3","05165_PC3","05135_PC5","04727_PC1","03015_PC3","04972_PC4","04726_PC4","04640_PC4","04550_PC2","04360_PC3","04920_PC3","04010_PC4","04726_PC2","00052_PC2","04110_PC3","04810_PC2","04120_PC3","05416_PC3"],["05340","04611","04611","04810","05133","04921","04650","05322","00270","04371","04540","04931","04979","05200","05235","00380","00563","04210","04310","00270","04550","04723","04110","04929","05167","05161","04935","05200","05165","05135","04727","03015","04972","04726","04640","04550","04360","04920","04010","04726","00052","04110","04810","04120","05416"],["Primary immunodeficiency","Platelet activation","Platelet activation","Regulation of actin cytoskeleton","Pertussis","Oxytocin signaling pathway","Natural killer cell mediated cytotoxicity","Systemic lupus erythematosus","Cysteine and methionine metabolism","Apelin signaling pathway","Gap junction","Insulin resistance","Cholesterol metabolism","Pathways in cancer","PD-L1 expression and PD-1 checkpoint pathway in cancer","Tryptophan metabolism","Glycosylphosphatidylinositol (GPI)-anchor biosynthesis","Apoptosis","Wnt signaling pathway","Cysteine and methionine metabolism","Signaling pathways regulating pluripotency of stem cells","Retrograde endocannabinoid signaling","Cell cycle","GnRH secretion","Kaposi sarcoma-associated herpesvirus infection","Hepatitis B","Growth hormone synthesis, secretion and action","Pathways in cancer","Human papillomavirus infection","Yersinia infection","GABAergic synapse","mRNA surveillance pathway","Pancreatic secretion","Serotonergic synapse","Hematopoietic cell lineage","Signaling pathways regulating pluripotency of stem cells","Axon guidance","Adipocytokine signaling pathway","MAPK signaling pathway","Serotonergic synapse","Galactose metabolism","Cell cycle","Regulation of actin cytoskeleton","Ubiquitin mediated proteolysis","Viral myocarditis"],[3,4,8,5,4,6,3,3,9,4,3,7,3,5,4,3,3,5,3,11,4,6,3,3,14,6,8,7,12,4,3,5,6,6,4,11,5,3,5,3,3,7,4,3,3],[1e-06,1.3e-05,5.6e-05,0.000107,0.000162,0.000285,0.000531,0.000593,0.000762,0.000934,1e-06,3.1e-05,6e-05,0.000106,0.000341,0.000385,0.00059,0.000601,0.000624,0.000628,0.000683,0.000847,1e-06,1e-06,1e-05,1.3e-05,1.4e-05,1.5e-05,0.000215,0.000272,0.000322,0.000337,0.000369,0.00039,0.000516,0.000672,0.000689,0.000783,0.000531,1e-06,1e-06,0.00052,0.000526,1e-06,0.000291],[38,124,124,213,76,153,134,133,49,137,88,108,50,531,89,42,25,136,160,49,140,148,124,64,186,162,119,531,330,120,89,91,102,115,99,140,181,69,295,115,31,124,213,136,60],[28,71,71,120,49,79,79,33,32,72,45,69,23,290,69,24,21,107,83,33,61,75,69,27,119,105,65,255,174,87,31,64,35,39,45,51,74,40,107,47,21,92,122,116,46],[0.002413,0.0156845,0.0450426666666667,0.06454775,0.0781812,0.1146175,0.178863625,0.178863625,0.204300666666667,0.2253742,0.003424,0.053072,0.06848,0.090736,0.212599272727273,0.212599272727273,0.212599272727273,0.212599272727273,0.212599272727273,0.212599272727273,0.212599272727273,0.241677333333333,0.0009695,0.0009695,0.0048475,0.0048475,0.0048475,0.0048475,0.059555,0.0630175,0.0630175,0.0630175,0.0630175,0.0630175,0.0769633846153846,0.0890647333333334,0.0890647333333334,0.0948898125,0.980259641928251,0.0011925,0.0011925,0.3136275,0.3136275,0.001481,0.2154855],[null,0.020839,0.044884,0.0571736666666667,0.0649215,0.091371,null,null,0.203581,0.213886,null,0.072447,null,0.123861,0.2482770375,null,null,0.2482770375,null,0.2482770375,0.2482770375,0.2482770375,null,null,0.00394875,0.00394875,0.00394875,0.00394875,0.045279,0.04563,null,0.04563,0.04563,0.04563,0.0543348,0.06045975,0.06045975,null,0.898983,null,null,0.36692942,0.36692942,null,null],[null,null,0.056068,0.056068,null,0.09956,null,null,0.199644,null,null,0.049445,null,0.084535,null,null,null,0.250415,null,0.250415,null,0.270193,null,null,0.00222,0.00222,0.00222,0.00222,0.025456,null,null,0.02886,0.02886,0.02886,null,0.0407888,0.0407888,null,0.616491,null,null,0.49868,null,null,null],[null,null,0.038584,null,null,0.0981825,null,null,0.175006,null,null,0.03379,null,null,null,null,null,null,null,0.307743333333333,null,0.307743333333333,null,null,0.00128625,0.00128625,0.00128625,0.00128625,0.014749,null,null,null,0.01911,0.01911,null,0.028812,null,null,null,null,null,0.32708,null,null,null],[null,null,0.024192,null,null,null,null,null,0.164592,null,null,0.024056,null,null,null,null,null,null,null,0.243664,null,null,null,null,0.00104,null,0.00104,0.00104,0.01118,null,null,null,null,null,null,0.0279552,null,null,null,null,null,0.22048,null,null,null],[null,null,0.01624,null,null,null,null,null,0.11049,null,null,null,null,null,null,null,null,null,null,0.33912,null,null,null,null,0.000805,null,0.000805,null,0.00824166666666667,null,null,null,null,null,null,0.01932,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,0.143256,null,null,null,null,null,null,null,null,null,null,0.240524,null,null,null,null,0.00072,null,null,null,0.00774,null,null,null,null,null,null,0.016128,null,null,null,null,null,null,null,null,null],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,0.162024,null,null,null,null,0.00047,null,null,null,0.0050525,null,null,null,null,null,null,0.010528,null,null,null,null,null,null,null,null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_3suppSNP<\/th>\n      <th>FDR_4suppSNP<\/th>\n      <th>FDR_5suppSNP<\/th>\n      <th>FDR_6suppSNP<\/th>\n      <th>FDR_7suppSNP<\/th>\n      <th>FDR_8suppSNP<\/th>\n      <th>FDR_9suppSNP<\/th>\n      <th>FDR_10suppSNP<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,11,12,13,14,15,16,17]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="pathway-function-summary" class="section level1">
<h1>Pathway function summary</h1>
<p><a href="https://uchicago.box.com/s/45robkocp45e63nfvuev8pc47f8hyi6t"
class="uri">https://uchicago.box.com/s/45robkocp45e63nfvuev8pc47f8hyi6t</a></p>
</div>
<div id="results-for-eur" class="section level1">
<h1>Results for EUR</h1>
<div id="number-of-supp_snp-3" class="section level2">
<h2>Number of supp_SNP &gt;=3</h2>
<div id="genes-2" class="section level3">
<h3>40 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_40genes_EUR.RDS&quot;))
  df_fdr02_3snp &lt;- df[df$FDR_3suppSNP &lt; 0.2,]
  df_fdr02_3snp &lt;- df_fdr02_3snp[complete.cases(df_fdr02_3snp$FDR_3suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_3snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_3suppSNP&quot;)]
df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_3suppSNP, decreasing = F),]

df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-43c5071fe8a890b96ecd" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-43c5071fe8a890b96ecd">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51"],["B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD15_positive_leukocyte","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","platelet","platelet","platelet","platelet","platelet","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte"],["CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HCT-ebi-a-GCST90002383","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","PLT-ebi-a-GCST90002402","Psoriasis-ebi-a-GCST90038681","Psoriasis-ebi-a-GCST90038681","RA-ukb-a-105","T1D-ebi-a-GCST90014023","CD-ebi-a-GCST003044","HT-ebi-a-GCST90018855","RBC-ebi-a-GCST90002403","SLE-ebi-a-GCST90018917","MCH-ebi-a-GCST90002390","CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HT-ebi-a-GCST90018855","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","RBC-ebi-a-GCST90002403","RBC-ebi-a-GCST90002403","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","T1D-ebi-a-GCST90014023","UC-ebi-a-GCST003045","WBC-ebi-a-GCST90002407","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","PLT-ebi-a-GCST90002402","RBC-ebi-a-GCST90002403","UC-ebi-a-GCST003045","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917"],["05010_PC3","05167_PC3","04060_PC2","05169_PC3","04060_PC2","03010_PC2","05416_PC5","03018_PC5","04062_PC2","05133_PC3","04071_PC4","04211_PC3","05130_PC5","05131_PC2","04068_PC1","04120_PC1","04910_PC4","01522_PC4","04722_PC2","05206_PC3","05145_PC2","05224_PC4","05164_PC1","05231_PC4","04110_PC3","05100_PC3","04666_PC2","05224_PC4","04371_PC2","05225_PC5","04931_PC5","05212_PC4","05167_PC3","04064_PC1","05205_PC4","04934_PC5","04144_PC5","05231_PC5","00230_PC2","04060_PC2","04670_PC1","04713_PC1","04390_PC4","05161_PC2","05163_PC4","05220_PC5","04015_PC2","04022_PC4","04217_PC2","04912_PC3","04972_PC4"],["05010","05167","04060","05169","04060","03010","05416","03018","04062","05133","04071","04211","05130","05131","04068","04120","04910","01522","04722","05206","05145","05224","05164","05231","04110","05100","04666","05224","04371","05225","04931","05212","05167","04064","05205","04934","04144","05231","00230","04060","04670","04713","04390","05161","05163","05220","04015","04022","04217","04912","04972"],["Alzheimer disease","Kaposi sarcoma-associated herpesvirus infection","Cytokine-cytokine receptor interaction","Epstein-Barr virus infection","Cytokine-cytokine receptor interaction","Ribosome","Viral myocarditis","RNA degradation","Chemokine signaling pathway","Pertussis","Sphingolipid signaling pathway","Longevity regulating pathway","Pathogenic Escherichia coli infection","Shigellosis","FoxO signaling pathway","Ubiquitin mediated proteolysis","Insulin signaling pathway","Endocrine resistance","Neurotrophin signaling pathway","MicroRNAs in cancer","Toxoplasmosis","Breast cancer","Influenza A","Choline metabolism in cancer","Cell cycle","Bacterial invasion of epithelial cells","Fc gamma R-mediated phagocytosis","Breast cancer","Apelin signaling pathway","Hepatocellular carcinoma","Insulin resistance","Pancreatic cancer","Kaposi sarcoma-associated herpesvirus infection","NF-kappa B signaling pathway","Proteoglycans in cancer","Cushing syndrome","Endocytosis","Choline metabolism in cancer","Purine metabolism","Cytokine-cytokine receptor interaction","Leukocyte transendothelial migration","Circadian entrainment","Hippo signaling pathway","Hepatitis B","Human cytomegalovirus infection","Chronic myeloid leukemia","Rap1 signaling pathway","cGMP-PKG signaling pathway","Necroptosis","GnRH signaling pathway","Pancreatic secretion"],[5,11,6,8,8,5,5,4,6,3,3,12,8,3,9,3,8,3,4,9,17,9,4,22,12,17,9,10,3,3,6,3,13,5,4,6,3,4,4,5,10,4,8,17,6,10,3,3,3,3,3],[0.000194,0.000191,0.000489,0.000438,0.000565,0.00045,0.000138,0.000176,4e-05,0.000399,1e-06,0.000195,7.6e-05,1e-06,7.1e-05,1e-06,1e-06,0.000484,0.000111,0.000356,9.5e-05,0.000228,0.000287,0.000148,0.000402,0.000267,0.000212,0.000251,1e-06,1e-06,0.000162,0.000478,0.000596,8e-06,0.000109,8.3e-05,9e-05,4e-05,0.000337,0.000527,8.3e-05,0.000255,0.000436,0.000545,0.000597,0.000356,1e-06,1e-06,1e-06,1e-06,1e-06],[171,186,294,201,294,153,60,79,189,76,119,89,202,236,131,136,137,98,119,310,112,147,170,98,124,73,93,147,137,168,108,76,186,102,204,155,249,98,130,294,112,97,155,162,225,76,210,167,162,93,102],[111,127,101,158,101,126,46,65,109,49,77,56,129,164,85,110,87,55,90,117,74,73,122,56,92,48,66,73,70,106,69,56,135,47,82,46,111,43,66,118,69,42,75,113,152,64,108,78,97,53,40],[0.114771428571429,0.114771428571429,0.183152727272727,0.183152727272727,0.193983333333333,0.183152727272727,0.114771428571429,0.114771428571429,0.0824,0.183152727272727,0.00412,0.114771428571429,0.110466,0.002907,0.110466,0.002907,0.003035,0.149426933333333,0.120827,0.137386333333333,0.120827,0.120827,0.120827,0.120827,0.143204769230769,0.120827,0.120827,0.120827,0.0023155,0.0023155,0.120827,0.149426933333333,0.17250475,0.021248,0.0579008,0.0579008,0.0579008,0.05312,0.169693333333333,0.1948375,0.059345,0.156278571428571,0.187044,0.1948375,0.19701,0.169693333333333,0.000858,0.000858,0.000858,0.000858,0.000858],["0.065043669804054","0.0407413285703631","0.233290435680774","-0.534248648998176","0.356193457802385","-0.226096753153129","-0.0607991215739534","-0.283022837383988","1.69054931142635","-1.74182447189371","0/1snp","0.0673449539000475","-0.0193260981996803","0/1snp","0.219067049860872","0/1snp","-0.245270464051887","-0.0810092466440202","0.102973718420146","0.00855641452932909","0.3945080651716","-0.462572162007828","0/1snp","-0.386903201479075","-0.271382014444818","-0.273002771884234","-0.586246084886727","0.0811961416249538","0/1snp","0/1snp","0.0465362456499863","0.0528897282523479","-0.241809277366614","-0.41768128699344","0.348491788582423","0.399605189249052","0.509031954692231","-0.311173395540788","0.218222885726902","-0.0495864361159254","-0.146323318161613","-0.174458927108844","0.272708295051201","-0.184266066760261","0.450641473397976","0.0363214279779365","0/1snp","0/1snp","0/1snp","0/1snp","0/1snp"],["0.676422858700943","0.82213266646417","0.714976796119257","0.260251668392045","0.553028372038752","0.652614467038651","0.887827644756179","0.351685786830111","0.793939736663622","0.829254094792897","0/1snp","0.419586506203072","0.913239055239114","0/1snp","0.556808502315391","0/1snp","0.381444392107266","0.595073810850475","0.491602439588426","0.940083381702828","0.281999819202358","0.287222413876834","0/1snp","0.0859600464937421","0.292534414891608","0.224765119161665","0.265690299732697","0.840955178249583","0/1snp","0/1snp","0.647406852649903","0.735820371120631","0.50495276158393","0.386094674495389","0.591758843415248","0.29079390368139","0.319892867344635","0.17009115454183","0.205072214915235","0.666382327665147","0.380080136666012","0.139910351678007","0.187412601065013","0.457985632021196","0.112784189247152","0.896349750087033","0/1snp","0/1snp","0/1snp","0/1snp","0/1snp"],[0.0847361914714528,0.116299644326158,0.0664088223331143,0.794053502006476,0.0452324631745179,0.0273526123636242,0.00622036207431019,0.041666677601265,0.0350310927389958,0.123867240948715,0.179399421152395,0.0655913071415878,0.003732249187829,0.010733255003746,0.0776990534387795,0.0149283701423451,0.0650233283387432,0.0243862378838635,0.0204342580122006,0.0176798008887221,0.030432161138051,0.549047828192121,0.080248806801287,0.0170276539084219,0.0294296169455622,0.0114142797939032,0.010647801372447,0.8694058176999,0.0654362778912413,0.0684417731965935,0.0192800234012339,0.00166539938044234,0.0020724444062013,0.082970925026339,0.039589809186186,0.0499508903092853,0.0248594267977266,0.0282171426316618,0.048623372893553,0.000228591834057765,0.0415005690507217,0.0813084294006457,0.00268973663414908,0.0143668158119024,0.0107354552341952,0.0017355830108804,0.00957856851566845,0.0632059738934086,0.0248271442196565,0.0260141455718582,0.0350385551015169],[0.088618779674983,0.121198032964722,0.0528417488799388,0.797863285468394,0.0381385168705888,0.0271652583804653,0.0076794587191138,0.0405209878865741,0.0313681947790197,0.108223688631756,0.485476891646948,0.0638589495916766,0.00364634929001638,0.00839322171971624,0.0771593172214685,0.0116411164304894,0.064654398239135,0.0237903007760662,0.0199477528513217,0.0171021440600706,0.0302218466361632,0.551177899788638,0.0650925663452405,0.0169263234988166,0.0292064075169795,0.0113214415355828,0.0105885774180777,0.870136427325358,0.171598636258068,0.155844315924981,0.0184583775576921,0.00161211578629625,0.0020594999149768,0.0825433684443156,0.0393791865081157,0.0496773388250982,0.0247994002913509,0.0290693826804753,0.0474933934465253,0.000223672658050194,0.0412206656189248,0.0794638962689146,0.00267641213074097,0.014269633331496,0.0692251016844291,0.00172437664984205,0.0454937627137767,0.113697992276642,0.0223757908395094,0.0286856816748202,0.121874633724757],[0.544554455445545,0.316831683168317,0.663366336633663,0.0792079207920792,0.801980198019802,0.891089108910891,0.702970297029703,0.762376237623762,0.851485148514851,0.782178217821782,0.683168316831683,0.603960396039604,0.96039603960396,0.96039603960396,0.386138613861386,0.98,0.455445544554455,0.861386138613861,0.910891089108911,0.851485148514851,0.693069306930693,0.118811881188119,0.831683168316832,0.841584158415842,0.742574257425743,0.940594059405941,0.851485148514851,0.0594059405940594,0.86,0.85,0.96039603960396,1,0.940594059405941,0.564356435643564,0.881188118811881,0.633663366336634,0.881188118811881,0.881188118811881,0.811881188118812,1,0.772277227722772,0.485148514851485,0.97029702970297,0.633663366336634,0.831683168316832,1,0.94,0.86,0.94,0.97,0.94],[0.544554455445545,0.306930693069307,0.712871287128713,0.0792079207920792,0.851485148514851,0.891089108910891,0.98019801980198,0.762376237623762,0.881188118811881,0.792079207920792,0.346534653465347,0.623762376237624,0.96039603960396,0.96039603960396,0.386138613861386,0.99,0.475247524752475,0.871287128712871,0.920792079207921,0.861386138613861,0.693069306930693,0.118811881188119,0.861386138613861,0.841584158415842,0.742574257425743,0.940594059405941,0.851485148514851,0.0594059405940594,0.76,0.74,0.96039603960396,1,0.940594059405941,0.574257425742574,0.891089108910891,0.633663366336634,0.881188118811881,0.881188118811881,0.811881188118812,1,0.772277227722772,0.504950495049505,0.97029702970297,0.633663366336634,0.247524752475248,1,0.88,0.78,0.95,0.97,0.83],[0.678173037418315,0.594204696087627,0.664351439136131,0.0818443267881644,0.768730474957558,0.848667839784188,0.957426686614832,0.757637537693506,0.893504701513942,0.719847132967961,0.725792823311447,0.760784800117829,0.972107083152037,0.964183479515423,0.497416050259158,0.966265970653322,0.716751346797049,0.893458828558561,0.909130464652942,0.920069312447997,0.831215028892909,0.134678361233884,0.800772513186922,0.905000725185304,0.832054717139564,0.92979442905016,0.932840207326662,0.057602613720506,0.878040881788251,0.873969666360811,0.921710521293731,0.99002297692384,0.98261845329425,0.57560024039172,0.766544171978601,0.676574615028423,0.823587944946355,0.879636653826071,0.770866634234485,0.997119713361287,0.798503486459564,0.657384885058803,0.974772395579957,0.896603115033861,0.92020911035436,0.982139134060741,0.975547166279269,0.893249925900504,0.949378344227259,0.947615556214218,0.933879849617023],[0.672428895900032,0.588584584615623,0.732288896985295,0.0819993643460128,0.808288307842575,0.855473988573732,0.953969349074813,0.769901008519314,0.902806954984845,0.746094991511694,0.427647847691103,0.768187843505089,0.975496370256716,0.971595636674529,0.505354920954802,0.972449900147273,0.721542795380465,0.902275555148434,0.917145670643736,0.928168487263456,0.837008877794826,0.136151632430287,0.832802803032038,0.911054114090732,0.838085205456447,0.934137907344219,0.93978671918535,0.0584804696147358,0.739927982666492,0.758101950019662,0.925992931351669,0.991938992832116,0.985816902161052,0.578378538142481,0.768563856513729,0.678801194076906,0.824819459906799,0.876050482261258,0.777144578034146,0.997868742326314,0.801237056084509,0.665423433023683,0.977366970139227,0.900448645184207,0.590458760936209,0.984633323294801,0.919348548429871,0.828541565917352,0.953730714631141,0.943941781195888,0.818861831739544],[0.702742245104395,0.625346678435898,0.755559225085771,0.113135389559548,0.824195200552008,0.888203881168538,0.970247311028842,0.83655405758088,0.860026610777695,0.609091672906701,0.510422425236502,0.758067980699134,0.976342761210528,0.9409242581998,0.667610912952085,0.920490131655002,0.803207668477582,0.898451327814094,0.913489206261796,0.924013046076098,0.875871198564771,0.219078004169715,0.713352432266969,0.926544645206385,0.879572389232268,0.948541029618888,0.951612425529541,0.0777655126607663,0.757137880912614,0.747961908881921,0.917874075824919,0.989812649435334,0.987883329756981,0.695427240842373,0.829811690768216,0.794220165793408,0.884419099140157,0.871607521320981,0.793492098039132,0.997090765562984,0.818807714506509,0.691350154614087,0.981970903403211,0.927009161643336,0.943083885149123,0.987336489659084,0.948341421305315,0.745028632309957,0.883006096809024,0.878233529704886,0.842868094216594],[0.695426706750355,0.617837099118647,0.801530827966969,0.112093971709992,0.851744360344935,0.891591448304286,0.966584399766297,0.843414957958115,0.876096307187025,0.646776174331058,0.254382269623411,0.766432116418369,0.978396090839486,0.954258480685116,0.671550569595473,0.938273043924554,0.805774493483984,0.903751845579523,0.91820827213248,0.928943635853283,0.879937349179347,0.220328230836593,0.762349738251108,0.929615276803012,0.883609304835375,0.951279948928537,0.954163896824485,0.0780190738386583,0.523280909671267,0.549374972651889,0.923797127363952,0.991502547745264,0.989449982430331,0.697684988579323,0.831168312319386,0.795843376673212,0.885034646748177,0.868819307676638,0.799918276239454,0.997972176036228,0.822165385850965,0.699486771691106,0.983211063402407,0.929110629771649,0.729252158005971,0.988502232326657,0.806884318354639,0.614193878604263,0.894922147873617,0.869584496144409,0.596654196770249]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_3suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-7-2.png" width="768" style="display: block; margin: auto;" /></p>
<p>
<button type="button" class="btn btn-default btn-xs btn-workflowr btn-workflowr-fig" data-toggle="collapse" data-target="#fig-unnamed-chunk-7-2">
Past versions of unnamed-chunk-7-2.png
</button>
</p>
<div id="fig-unnamed-chunk-7-2" class="collapse">
<div class="table-responsive">
<table class="table table-condensed table-hover">
<thead>
<tr>
<th>
Version
</th>
<th>
Author
</th>
<th>
Date
</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<a href="https://github.com/xsun1229/factor_analysis_new/blob/c1850407104e445781a3c4990a19486c63c29469/docs/figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-7-2.png" target="_blank">c185040</a>
</td>
<td>
XSun
</td>
<td>
2025-10-10
</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="genes-3" class="section level3">
<h3>20 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_20genes_EUR.RDS&quot;))
  df_fdr02_3snp &lt;- df[df$FDR_3suppSNP &lt; 0.2,]
  df_fdr02_3snp &lt;- df_fdr02_3snp[complete.cases(df_fdr02_3snp$FDR_3suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_3snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_3suppSNP&quot;)]

df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_3suppSNP, decreasing = F),]


df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-3f22443f93eeeda03f7b" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-3f22443f93eeeda03f7b">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77"],["B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD15_positive_leukocyte","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","platelet","platelet","platelet","platelet","platelet","platelet","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte"],["CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HCT-ebi-a-GCST90002383","LDL-ukb-d-30780_irnt","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","PLT-ebi-a-GCST90002402","Psoriasis-ebi-a-GCST90038681","Psoriasis-ebi-a-GCST90038681","RA-ukb-a-105","RBC-ebi-a-GCST90002403","SLE-ebi-a-GCST90018917","T1D-ebi-a-GCST90014023","allergy-ebi-a-GCST005038","CD-ebi-a-GCST003044","HT-ebi-a-GCST90018855","RBC-ebi-a-GCST90002403","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","WBC-ebi-a-GCST90002407","asthma_pmid36778051","MCH-ebi-a-GCST90002390","CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HT-ebi-a-GCST90018855","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","RBC-ebi-a-GCST90002403","RBC-ebi-a-GCST90002403","RBC-ebi-a-GCST90002403","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","T1D-ebi-a-GCST90014023","T1D-ebi-a-GCST90014023","T1D-ebi-a-GCST90014023","UC-ebi-a-GCST003045","WBC-ebi-a-GCST90002407","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","RBC-ebi-a-GCST90002403","UC-ebi-a-GCST003045","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","MCH-ebi-a-GCST90002390","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","SLE-ebi-a-GCST90018917","WBC-ebi-a-GCST90002407"],["05010_PC3","05167_PC3","04060_PC2","05169_PC3","04060_PC2","04512_PC3","03010_PC2","05416_PC5","03018_PC5","04062_PC2","05133_PC3","04071_PC4","04970_PC3","05330_PC5","04211_PC3","05414_PC4","05130_PC5","05131_PC2","04068_PC1","00970_PC2","04120_PC1","05320_PC3","05330_PC3","05130_PC5","04924_PC3","04910_PC4","01522_PC4","04722_PC2","05206_PC3","05145_PC2","05224_PC4","05164_PC1","05231_PC4","04110_PC3","05100_PC3","04666_PC2","05216_PC1","05224_PC4","00280_PC5","04371_PC2","05225_PC5","04931_PC5","05150_PC3","05216_PC5","05212_PC4","05167_PC3","04064_PC1","05205_PC4","04934_PC5","05416_PC5","04144_PC5","05231_PC5","00230_PC2","04060_PC2","04670_PC1","04713_PC1","04924_PC1","04971_PC1","04971_PC2","05216_PC2","05330_PC3","00052_PC2","03410_PC1","04390_PC4","05014_PC3","05161_PC2","05163_PC4","05220_PC5","03460_PC1","04015_PC2","04022_PC4","04217_PC2","04721_PC1","04912_PC3","04972_PC4","05110_PC5","05320_PC3"],["05010","05167","04060","05169","04060","04512","03010","05416","03018","04062","05133","04071","04970","05330","04211","05414","05130","05131","04068","00970","04120","05320","05330","05130","04924","04910","01522","04722","05206","05145","05224","05164","05231","04110","05100","04666","05216","05224","00280","04371","05225","04931","05150","05216","05212","05167","04064","05205","04934","05416","04144","05231","00230","04060","04670","04713","04924","04971","04971","05216","05330","00052","03410","04390","05014","05161","05163","05220","03460","04015","04022","04217","04721","04912","04972","05110","05320"],["Alzheimer disease","Kaposi sarcoma-associated herpesvirus infection","Cytokine-cytokine receptor interaction","Epstein-Barr virus infection","Cytokine-cytokine receptor interaction","ECM-receptor interaction","Ribosome","Viral myocarditis","RNA degradation","Chemokine signaling pathway","Pertussis","Sphingolipid signaling pathway","Salivary secretion","Allograft rejection","Longevity regulating pathway","Dilated cardiomyopathy","Pathogenic Escherichia coli infection","Shigellosis","FoxO signaling pathway","Aminoacyl-tRNA biosynthesis","Ubiquitin mediated proteolysis","Autoimmune thyroid disease","Allograft rejection","Pathogenic Escherichia coli infection","Renin secretion","Insulin signaling pathway","Endocrine resistance","Neurotrophin signaling pathway","MicroRNAs in cancer","Toxoplasmosis","Breast cancer","Influenza A","Choline metabolism in cancer","Cell cycle","Bacterial invasion of epithelial cells","Fc gamma R-mediated phagocytosis","Thyroid cancer","Breast cancer","Valine, leucine and isoleucine degradation","Apelin signaling pathway","Hepatocellular carcinoma","Insulin resistance","Staphylococcus aureus infection","Thyroid cancer","Pancreatic cancer","Kaposi sarcoma-associated herpesvirus infection","NF-kappa B signaling pathway","Proteoglycans in cancer","Cushing syndrome","Viral myocarditis","Endocytosis","Choline metabolism in cancer","Purine metabolism","Cytokine-cytokine receptor interaction","Leukocyte transendothelial migration","Circadian entrainment","Renin secretion","Gastric acid secretion","Gastric acid secretion","Thyroid cancer","Allograft rejection","Galactose metabolism","Base excision repair","Hippo signaling pathway","Amyotrophic lateral sclerosis","Hepatitis B","Human cytomegalovirus infection","Chronic myeloid leukemia","Fanconi anemia pathway","Rap1 signaling pathway","cGMP-PKG signaling pathway","Necroptosis","Synaptic vesicle cycle","GnRH signaling pathway","Pancreatic secretion","Vibrio cholerae infection","Autoimmune thyroid disease"],[5,11,6,8,8,3,5,5,4,6,3,3,7,3,12,5,8,3,9,3,3,3,3,5,6,8,3,4,9,17,9,4,22,12,17,9,5,10,3,3,3,6,5,3,3,13,5,4,6,4,3,4,4,5,10,4,4,5,5,4,4,4,4,8,15,17,6,10,3,3,3,3,3,3,3,3,13],[0.000194,0.000191,0.000489,0.000438,0.000565,0.000233,0.00045,0.000138,0.000176,4e-05,0.000399,1e-06,0.00035,1e-06,0.000195,0.000424,7.6e-05,1e-06,7.1e-05,1e-06,1e-06,1e-06,1e-06,0.000224,0.000105,1e-06,0.000484,0.000111,0.000356,9.5e-05,0.000228,0.000287,0.000148,0.000402,0.000267,0.000212,5.1e-05,0.000251,1e-06,1e-06,1e-06,0.000162,0.000182,0.000616,0.000478,0.000596,8e-06,0.000109,8.3e-05,2.1e-05,9e-05,4e-05,0.000337,0.000527,8.3e-05,0.000255,0.000274,0.000189,5e-05,3.1e-05,0.000367,0.00014,0.000312,0.000436,0.000708,0.000545,0.000597,0.000356,1e-06,1e-06,1e-06,1e-06,1e-06,1e-06,1e-06,1e-06,0.000342],[171,186,294,201,294,88,153,60,79,189,76,119,90,38,89,96,202,236,131,66,136,53,38,202,69,137,98,119,310,112,147,170,98,124,73,93,37,147,48,137,168,108,96,37,76,186,102,204,155,60,249,98,130,294,112,97,69,75,75,37,38,31,33,155,57,162,225,76,54,210,167,162,78,93,102,50,53],[111,127,101,158,101,31,126,46,65,109,49,77,34,28,56,31,129,164,85,22,110,23,24,129,30,87,55,90,117,74,73,122,56,92,48,66,29,73,37,70,106,69,37,29,56,135,47,82,46,32,111,43,66,118,69,42,28,34,34,29,30,20,31,75,39,113,152,64,29,108,78,97,37,53,40,36,29],[0.135841875,0.135841875,0.1816798,0.179132142857143,0.1967965625,0.144278777777778,0.179132142857143,0.135841875,0.135841875,0.0743066666666667,0.179132142857143,0.0027865,0.179132142857143,0.0027865,0.135841875,0.179132142857143,0.0833394285714286,0.0015352,0.0833394285714286,0.0015352,0.0015352,0.0015352,0.0015352,0.191047111111111,0.1007475,0.00408,0.161790444444444,0.1113145,0.142803466666667,0.1113145,0.1233485,0.1233485,0.121677111111111,0.151177125,0.1233485,0.1233485,0.07671675,0.1233485,0.00200566666666667,0.00200566666666667,0.00200566666666667,0.121677111111111,0.121677111111111,0.1853236,0.161790444444444,0.1853236,0.033584,0.0762636666666667,0.075564,0.044079,0.075564,0.0559733333333333,0.1048886,0.135444347826087,0.0431298181818182,0.104112857142857,0.104412266666667,0.0831018461538462,0.02858,0.0196884444444444,0.1048886,0.0666866666666667,0.1048886,0.118675047619048,0.16187712,0.135444347826087,0.1421855,0.1048886,0.0007145,0.0007145,0.0007145,0.0007145,0.0007145,0.0007145,0.0007145,0.0007145,0.1048886],["0.065043669804054","0.0407413285703631","0.233290435680774","-0.534248648998176","0.356193457802385","-0.549787862402526","-0.226096753153129","-0.0607991215739534","-0.283022837383988","1.69054931142635","-1.74182447189371","0/1snp","-0.128493235792523","0/1snp","0.0673449539000475","0.318232098091908","-0.0193260981996803","0/1snp","0.219067049860872","0/1snp","0/1snp","0/1snp","0/1snp","0.372850354275765","0.0574186991373062","-0.245270464051887","-0.0810092466440202","0.102973718420146","0.00855641452932909","0.3945080651716","-0.462572162007828","0/1snp","-0.386903201479075","-0.271382014444818","-0.273002771884234","-0.586246084886727","-0.0493807576852792","0.0811961416249538","0/1snp","0/1snp","0/1snp","0.0465362456499863","0.069526588340074","0.0296253670206659","0.0528897282523479","-0.241809277366614","-0.41768128699344","0.348491788582423","0.399605189249052","0.458014765697086","0.509031954692231","-0.311173395540788","0.218222885726902","-0.0495864361159254","-0.146323318161613","-0.174458927108844","0.203321370800813","-0.0195316446390257","-0.160017285934662","0.180103214805056","-0.192496615286831","0.563139995952387","-0.324640785810382","0.272708295051201","-0.0740095805903693","-0.184266066760261","0.450641473397976","0.0363214279779365","0/1snp","0/1snp","0/1snp","0/1snp","0/1snp","0/1snp","0/1snp","0/1snp","0.3251007468362"],["0.676422858700943","0.82213266646417","0.714976796119257","0.260251668392045","0.553028372038752","0.147635674993855","0.652614467038651","0.887827644756179","0.351685786830111","0.793939736663622","0.829254094792897","0/1snp","0.696491658215512","0/1snp","0.419586506203072","0.74823649131926","0.913239055239114","0/1snp","0.556808502315391","0/1snp","0/1snp","0/1snp","0/1snp","0.579188173789067","0.919996273137037","0.381444392107266","0.595073810850475","0.491602439588426","0.940083381702828","0.281999819202358","0.287222413876834","0/1snp","0.0859600464937421","0.292534414891608","0.224765119161665","0.265690299732697","0.890160086598626","0.840955178249583","0/1snp","0/1snp","0/1snp","0.647406852649903","0.632216248125993","0.719268655364635","0.735820371120631","0.50495276158393","0.386094674495389","0.591758843415248","0.29079390368139","0.276999318780813","0.319892867344635","0.17009115454183","0.205072214915235","0.666382327665147","0.380080136666012","0.139910351678007","0.0614609464792417","0.878437186997933","0.272526832466116","0.32170751659508","0.499933826506938","0.0410472744447301","0.287493191653511","0.187412601065013","0.796506681001568","0.457985632021196","0.112784189247152","0.896349750087033","0/1snp","0/1snp","0/1snp","0/1snp","0/1snp","0/1snp","0/1snp","0/1snp","0.42200431630917"],[0.0847361914714528,0.116299644326158,0.0664088223331143,0.794053502006476,0.0452324631745179,0.060783744181427,0.0273526123636242,0.00622036207431019,0.041666677601265,0.0350310927389958,0.123867240948715,0.179399421152395,0.0442804452785797,1.97844117821434e-05,0.0655913071415878,0.0378052711784273,0.003732249187829,0.010733255003746,0.0776990534387795,0.14974997733084,0.0149283701423451,0.00631176586131351,0.0050648640191583,0.0671357157002278,0.0925372074175356,0.0650233283387432,0.0243862378838635,0.0204342580122006,0.0176798008887221,0.030432161138051,0.549047828192121,0.080248806801287,0.0170276539084219,0.0294296169455622,0.0114142797939032,0.010647801372447,0.0849285644062765,0.8694058176999,0.0200507446330539,0.0654362778912413,0.0684417731965935,0.0192800234012339,0.13407594246512,0.0404744566179235,0.00166539938044234,0.0020724444062013,0.082970925026339,0.039589809186186,0.0499508903092853,0.00892294530498609,0.0248594267977266,0.0282171426316618,0.048623372893553,0.000228591834057765,0.0415005690507217,0.0813084294006457,0.00834909047164038,0.0355491368003,0.000985729264436275,0.0784974459469398,0.0353663782785104,0.0180323727636578,0.00238206246112154,0.00268973663414908,0.0391289514001323,0.0143668158119024,0.0107354552341952,0.0017355830108804,0.0368929997815925,0.00957856851566845,0.0632059738934086,0.0248271442196565,0.104647146574741,0.0260141455718582,0.0350385551015169,0.0135616506900392,0.00128720435619216],[0.088618779674983,0.121198032964722,0.0528417488799388,0.797863285468394,0.0381385168705888,0.059235077678089,0.0271652583804653,0.0076794587191138,0.0405209878865741,0.0313681947790197,0.108223688631756,0.485476891646948,0.0439970392563044,0.0800952227104614,0.0638589495916766,0.0363507554299642,0.00364634929001638,0.00839322171971624,0.0771593172214685,0.15450117015943,0.0116411164304894,0.0170906326213814,0.0157030143641176,0.0667750898625633,0.0907451209475906,0.064654398239135,0.0237903007760662,0.0199477528513217,0.0171021440600706,0.0302218466361632,0.551177899788638,0.0650925663452405,0.0169263234988166,0.0292064075169795,0.0113214415355828,0.0105885774180777,0.0827715206611724,0.870136427325358,0.0594616864021468,0.171598636258068,0.155844315924981,0.0184583775576921,0.13065469574839,0.0389331131786245,0.00161211578629625,0.0020594999149768,0.0825433684443156,0.0393791865081157,0.0496773388250982,0.00886296308235491,0.0247994002913509,0.0290693826804753,0.0474933934465253,0.000223672658050194,0.0412206656189248,0.0794638962689146,0.00817176479684091,0.0348278520069879,0.091322867219367,0.0763971755108989,0.0357481658349401,0.0180559770112497,0.29186785494249,0.00267641213074097,0.0392059944284188,0.014269633331496,0.0692251016844291,0.00172437664984205,0.0458980505706026,0.0454937627137767,0.113697992276642,0.0223757908395094,0.127947026674564,0.0286856816748202,0.121874633724757,0.0861723756828394,0.00406464059971539],[0.544554455445545,0.316831683168317,0.663366336633663,0.0792079207920792,0.801980198019802,0.851485148514851,0.891089108910891,0.702970297029703,0.762376237623762,0.851485148514851,0.782178217821782,0.683168316831683,0.841584158415842,1,0.603960396039604,0.821782178217822,0.96039603960396,0.96039603960396,0.386138613861386,0.77,0.98,0.99,0.99,0.564356435643564,0.663366336633663,0.455445544554455,0.861386138613861,0.910891089108911,0.851485148514851,0.693069306930693,0.118811881188119,0.831683168316832,0.841584158415842,0.742574257425743,0.940594059405941,0.851485148514851,0.554455445544555,0.0594059405940594,0.94,0.86,0.85,0.96039603960396,0.742574257425743,0.891089108910891,1,0.940594059405941,0.564356435643564,0.881188118811881,0.633663366336634,0.930693069306931,0.881188118811881,0.881188118811881,0.811881188118812,1,0.772277227722772,0.485148514851485,0.920792079207921,0.762376237623762,0.97029702970297,0.683168316831683,0.702970297029703,0.95049504950495,0.97029702970297,0.97029702970297,0.861386138613861,0.633663366336634,0.831683168316832,1,0.96,0.94,0.86,0.94,0.76,0.97,0.94,0.99,0.910891089108911],[0.544554455445545,0.306930693069307,0.712871287128713,0.0792079207920792,0.851485148514851,0.861386138613861,0.891089108910891,0.98019801980198,0.762376237623762,0.881188118811881,0.792079207920792,0.346534653465347,0.851485148514851,0.86,0.623762376237624,0.831683168316832,0.96039603960396,0.96039603960396,0.386138613861386,0.77,0.99,1,1,0.564356435643564,0.663366336633663,0.475247524752475,0.871287128712871,0.920792079207921,0.861386138613861,0.693069306930693,0.118811881188119,0.861386138613861,0.841584158415842,0.742574257425743,0.940594059405941,0.851485148514851,0.594059405940594,0.0594059405940594,0.92,0.76,0.74,0.96039603960396,0.742574257425743,0.891089108910891,1,0.940594059405941,0.574257425742574,0.891089108910891,0.633663366336634,0.930693069306931,0.881188118811881,0.881188118811881,0.811881188118812,1,0.772277227722772,0.504950495049505,0.920792079207921,0.762376237623762,0.613861386138614,0.693069306930693,0.831683168316832,0.95049504950495,0.148514851485149,0.97029702970297,0.861386138613861,0.633663366336634,0.247524752475248,1,0.94,0.88,0.78,0.95,0.69,0.97,0.83,0.9,0.96039603960396],[0.678173037418315,0.594204696087627,0.664351439136131,0.0818443267881644,0.768730474957558,0.761637506685995,0.848667839784188,0.957426686614832,0.757637537693506,0.893504701513942,0.719847132967961,0.725792823311447,0.754777094751203,0.999639811762495,0.760784800117829,0.858846055456934,0.972107083152037,0.964183479515423,0.497416050259158,0.764509487936711,0.966265970653322,0.984100670054206,0.986907341295849,0.559094968740697,0.624193708444974,0.716751346797049,0.893458828558561,0.909130464652942,0.920069312447997,0.831215028892909,0.134678361233884,0.800772513186922,0.905000725185304,0.832054717139564,0.92979442905016,0.932840207326662,0.545545453851497,0.057602613720506,0.954807966628371,0.878040881788251,0.873969666360811,0.921710521293731,0.591323730353203,0.845566064381188,0.99002297692384,0.98261845329425,0.57560024039172,0.766544171978601,0.676574615028423,0.921271711608753,0.823587944946355,0.879636653826071,0.770866634234485,0.997119713361287,0.798503486459564,0.657384885058803,0.948100786866511,0.822418359703786,0.991057984108231,0.666458174068154,0.748333989698921,0.873259665948525,0.9771739214369,0.974772395579957,0.742797352916194,0.896603115033861,0.92020911035436,0.982139134060741,0.931103068499134,0.975547166279269,0.893249925900504,0.949378344227259,0.838478698344851,0.947615556214218,0.933879849617023,0.968301015553094,0.984988532907082],[0.672428895900032,0.588584584615623,0.732288896985295,0.0819993643460128,0.808288307842575,0.769001790683793,0.855473988573732,0.953969349074813,0.769901008519314,0.902806954984845,0.746094991511694,0.427647847691103,0.764939806668165,0.865281768994057,0.768187843505089,0.86507856528244,0.975496370256716,0.971595636674529,0.505354920954802,0.758973251806216,0.972449900147273,0.96171669583857,0.964469392633259,0.56524759352982,0.632804329737941,0.721542795380465,0.902275555148434,0.917145670643736,0.928168487263456,0.837008877794826,0.136151632430287,0.832802803032038,0.911054114090732,0.838085205456447,0.934137907344219,0.93978671918535,0.565858275891024,0.0584804696147358,0.887871941769282,0.739927982666492,0.758101950019662,0.925992931351669,0.600903809894581,0.852871352127083,0.991938992832116,0.985816902161052,0.578378538142481,0.768563856513729,0.678801194076906,0.921803726071664,0.824819459906799,0.876050482261258,0.777144578034146,0.997868742326314,0.801237056084509,0.665423433023683,0.950270654280662,0.827028362715346,0.629176608674836,0.675060424243828,0.750418915684049,0.876248059860542,0.20301773731477,0.977366970139227,0.746279951506166,0.900448645184207,0.590458760936209,0.984633323294801,0.918724552673042,0.919348548429871,0.828541565917352,0.953730714631141,0.811724880270814,0.943941781195888,0.818861831739544,0.86353212798153,0.964085219419155],[0.702742245104395,0.625346678435898,0.755559225085771,0.113135389559548,0.824195200552008,0.773105379184178,0.888203881168538,0.970247311028842,0.83655405758088,0.860026610777695,0.609091672906701,0.510422425236502,0.827494867131421,0.998734076756008,0.758067980699134,0.850113446049142,0.976342761210528,0.9409242581998,0.667610912952085,0.498081858414266,0.920490131655002,0.963015226472933,0.969389414365397,0.702262044681416,0.623760306535783,0.803207668477582,0.898451327814094,0.913489206261796,0.924013046076098,0.875871198564771,0.219078004169715,0.713352432266969,0.926544645206385,0.879572389232268,0.948541029618888,0.951612425529541,0.70029278959524,0.0777655126607663,0.914950765756668,0.757137880912614,0.747961908881921,0.917874075824919,0.585273273791997,0.83981659520649,0.989812649435334,0.987883329756981,0.695427240842373,0.829811690768216,0.794220165793408,0.950489602029729,0.884419099140157,0.871607521320981,0.793492098039132,0.997090765562984,0.818807714506509,0.691350154614087,0.954054932747994,0.840907149205397,0.991810034394338,0.699245736853357,0.841594494741111,0.911214711204699,0.983685208115316,0.981970903403211,0.827554553702832,0.927009161643336,0.943083885149123,0.987336489659084,0.835867259582729,0.948341421305315,0.745028632309957,0.883006096809024,0.631523838867341,0.878233529704886,0.842868094216594,0.930575974683417,0.989946895018987],[0.695426706750355,0.617837099118647,0.801530827966969,0.112093971709992,0.851744360344935,0.780993338379692,0.891591448304286,0.966584399766297,0.843414957958115,0.876096307187025,0.646776174331058,0.254382269623411,0.831370641330609,0.718634394032387,0.766432116418369,0.858120158314141,0.978396090839486,0.954258480685116,0.671550569595473,0.492407591090468,0.938273043924554,0.91195293507095,0.918622721412697,0.70570967417102,0.631102307062777,0.805774493483984,0.903751845579523,0.91820827213248,0.928943635853283,0.879937349179347,0.220328230836593,0.762349738251108,0.929615276803012,0.883609304835375,0.951279948928537,0.954163896824485,0.710603576874991,0.0780190738386583,0.779987048698841,0.523280909671267,0.549374972651889,0.923797127363952,0.596658304434302,0.848807030007542,0.991502547745264,0.989449982430331,0.697684988579323,0.831168312319386,0.795843376673212,0.950864454739741,0.885034646748177,0.868819307676638,0.799918276239454,0.997972176036228,0.822165385850965,0.699486771691106,0.956313547085682,0.845855805112413,0.667618950789075,0.708203843954781,0.842375393493722,0.912901955068941,0.37122361035781,0.983211063402407,0.829568653950903,0.929110629771649,0.729252158005971,0.988502232326657,0.80549648344282,0.806884318354639,0.614193878604263,0.894922147873617,0.584232107850623,0.869584496144409,0.596654196770249,0.681210841503454,0.976124020638922]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_3suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-8-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="number-of-supp_snp-5" class="section level2">
<h2>Number of supp_SNP &gt;=5</h2>
<div id="genes-4" class="section level3">
<h3>40 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_40genes_EUR.RDS&quot;))
  df_fdr02_5snp &lt;- df[df$FDR_5suppSNP &lt; 0.2,]
  df_fdr02_5snp &lt;- df_fdr02_5snp[complete.cases(df_fdr02_5snp$FDR_5suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_5snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_5suppSNP&quot;)]
df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_5suppSNP, decreasing = F),]

df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-198b30f56771bc600b2c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-198b30f56771bc600b2c">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32"],["B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD15_positive_leukocyte","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","platelet","platelet","thymocyte"],["CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HCT-ebi-a-GCST90002383","HCT-ebi-a-GCST90002383","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","Psoriasis-ebi-a-GCST90038681","RBC-ebi-a-GCST90002403","T1D-ebi-a-GCST90014023","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","MCH-ebi-a-GCST90002390","RBC-ebi-a-GCST90002403","WBC-ebi-a-GCST90002407","asthma_pmid36778051","asthma_pmid36778051","MCH-ebi-a-GCST90002390","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","RBC-ebi-a-GCST90002403","RBC-ebi-a-GCST90002403","T1D-ebi-a-GCST90014023","WBC-ebi-a-GCST90002407","HB-ebi-a-GCST90002384","PLT-ebi-a-GCST90002402","IBD-ebi-a-GCST003043"],["05010_PC3","05167_PC3","04060_PC2","05169_PC3","04060_PC2","04510_PC5","03010_PC2","05416_PC5","04062_PC2","04934_PC2","04211_PC3","05130_PC5","05100_PC3","05225_PC5","04068_PC1","05130_PC5","04070_PC2","04120_PC2","04910_PC4","05206_PC3","05145_PC2","05224_PC4","05231_PC4","04110_PC3","05100_PC3","04666_PC2","05224_PC4","04931_PC5","05167_PC3","04064_PC1","04934_PC5","04670_PC1"],["05010","05167","04060","05169","04060","04510","03010","05416","04062","04934","04211","05130","05100","05225","04068","05130","04070","04120","04910","05206","05145","05224","05231","04110","05100","04666","05224","04931","05167","04064","04934","04670"],["Alzheimer disease","Kaposi sarcoma-associated herpesvirus infection","Cytokine-cytokine receptor interaction","Epstein-Barr virus infection","Cytokine-cytokine receptor interaction","Focal adhesion","Ribosome","Viral myocarditis","Chemokine signaling pathway","Cushing syndrome","Longevity regulating pathway","Pathogenic Escherichia coli infection","Bacterial invasion of epithelial cells","Hepatocellular carcinoma","FoxO signaling pathway","Pathogenic Escherichia coli infection","Phosphatidylinositol signaling system","Ubiquitin mediated proteolysis","Insulin signaling pathway","MicroRNAs in cancer","Toxoplasmosis","Breast cancer","Choline metabolism in cancer","Cell cycle","Bacterial invasion of epithelial cells","Fc gamma R-mediated phagocytosis","Breast cancer","Insulin resistance","Kaposi sarcoma-associated herpesvirus infection","NF-kappa B signaling pathway","Cushing syndrome","Leukocyte transendothelial migration"],[5,11,6,8,8,7,5,5,6,8,12,8,8,12,9,5,5,5,8,9,17,9,22,12,17,9,10,6,13,5,6,10],[0.000194,0.000191,0.000489,0.000438,0.000565,0.000709,0.00045,0.000138,4e-05,0.000693,0.000195,7.6e-05,0.000288,0.000343,7.1e-05,0.000224,0.000309,0.000361,1e-06,0.000356,9.5e-05,0.000228,0.000148,0.000402,0.000267,0.000212,0.000251,0.000162,0.000596,8e-06,8.3e-05,8.3e-05],[171,186,294,201,294,199,153,60,189,155,89,202,73,168,131,202,99,136,137,310,112,147,98,124,73,93,147,108,186,102,155,112],[111,127,101,158,101,105,126,46,109,75,56,129,49,102,85,129,66,110,87,117,74,73,56,92,48,66,73,69,135,47,46,69],[0.088764,0.088764,0.1391205,0.1391205,0.142882222222222,0.146698545454545,0.1391205,0.088764,0.088764,0.146698545454545,0.088764,0.135698,0.184161571428571,0.184161571428571,0.135698,0.184161571428571,0.184161571428571,0.184161571428571,0.001493,0.112852,0.0967302857142857,0.0967302857142857,0.0967302857142857,0.113274666666667,0.0967302857142857,0.0967302857142857,0.0967302857142857,0.0967302857142857,0.1511456,0.012168,0.0631215,0.189904],["0.065043669804054","0.0407413285703631","0.233290435680774","-0.534248648998176","0.356193457802385","-0.319389509893942","-0.226096753153129","-0.0607991215739534","1.69054931142635","0.0115755318449362","0.0673449539000475","-0.0193260981996803","0.540647251260549","0.12804726131312","0.219067049860872","0.372850354275765","0.0271668575890495","-0.163664679725376","-0.245270464051887","0.00855641452932909","0.3945080651716","-0.462572162007828","-0.386903201479075","-0.271382014444818","-0.273002771884234","-0.586246084886727","0.0811961416249538","0.0465362456499863","-0.241809277366614","-0.41768128699344","0.399605189249052","-0.146323318161613"],["0.676422858700943","0.82213266646417","0.714976796119257","0.260251668392045","0.553028372038752","0.518149015164986","0.652614467038651","0.887827644756179","0.793939736663622","0.976526536481923","0.419586506203072","0.913239055239114","0.166903919111562","0.688203395866338","0.556808502315391","0.579188173789067","0.958529031613018","0.823724798714202","0.381444392107266","0.940083381702828","0.281999819202358","0.287222413876834","0.0859600464937421","0.292534414891608","0.224765119161665","0.265690299732697","0.840955178249583","0.647406852649903","0.50495276158393","0.386094674495389","0.29079390368139","0.380080136666012"],[0.0847361914714528,0.116299644326158,0.0664088223331143,0.794053502006476,0.0452324631745179,0.0040001060324823,0.0273526123636242,0.00622036207431019,0.0350310927389958,0.0208182452474056,0.0655913071415878,0.003732249187829,0.0412216763329681,0.0233888950467411,0.0776990534387795,0.0671357157002278,0.323823422172541,0.0513772483278233,0.0650233283387432,0.0176798008887221,0.030432161138051,0.549047828192121,0.0170276539084219,0.0294296169455622,0.0114142797939032,0.010647801372447,0.8694058176999,0.0192800234012339,0.0020724444062013,0.082970925026339,0.0499508903092853,0.0415005690507217],[0.088618779674983,0.121198032964722,0.0528417488799388,0.797863285468394,0.0381385168705888,0.00398094682568144,0.0271652583804653,0.0076794587191138,0.0313681947790197,0.0208981551072142,0.0638589495916766,0.00364634929001638,0.0409449972764959,0.023237798133366,0.0771593172214685,0.0667750898625633,0.332585974632817,0.0504809078783252,0.064654398239135,0.0171021440600706,0.0302218466361632,0.551177899788638,0.0169263234988166,0.0292064075169795,0.0113214415355828,0.0105885774180777,0.870136427325358,0.0184583775576921,0.0020594999149768,0.0825433684443156,0.0496773388250982,0.0412206656189248],[0.544554455445545,0.316831683168317,0.663366336633663,0.0792079207920792,0.801980198019802,1,0.891089108910891,0.702970297029703,0.851485148514851,0.900990099009901,0.603960396039604,0.96039603960396,0.603960396039604,0.881188118811881,0.386138613861386,0.564356435643564,0.188118811881188,0.653465346534653,0.455445544554455,0.851485148514851,0.693069306930693,0.118811881188119,0.841584158415842,0.742574257425743,0.940594059405941,0.851485148514851,0.0594059405940594,0.96039603960396,0.940594059405941,0.564356435643564,0.633663366336634,0.772277227722772],[0.544554455445545,0.306930693069307,0.712871287128713,0.0792079207920792,0.851485148514851,1,0.891089108910891,0.98019801980198,0.881188118811881,0.900990099009901,0.623762376237624,0.96039603960396,0.603960396039604,0.881188118811881,0.386138613861386,0.564356435643564,0.178217821782178,0.653465346534653,0.475247524752475,0.861386138613861,0.693069306930693,0.118811881188119,0.841584158415842,0.742574257425743,0.940594059405941,0.851485148514851,0.0594059405940594,0.96039603960396,0.940594059405941,0.574257425742574,0.633663366336634,0.772277227722772],[0.678173037418315,0.594204696087627,0.664351439136131,0.0818443267881644,0.768730474957558,0.976000186045069,0.848667839784188,0.957426686614832,0.893504701513942,0.880217982806335,0.760784800117829,0.972107083152037,0.697185517667804,0.825276142930207,0.497416050259158,0.559094968740697,0.284875687971848,0.764650651521744,0.716751346797049,0.920069312447997,0.831215028892909,0.134678361233884,0.905000725185304,0.832054717139564,0.92979442905016,0.932840207326662,0.057602613720506,0.921710521293731,0.98261845329425,0.57560024039172,0.676574615028423,0.798503486459564],[0.672428895900032,0.588584584615623,0.732288896985295,0.0819993643460128,0.808288307842575,0.979938140014418,0.855473988573732,0.953969349074813,0.902806954984845,0.887427229246285,0.768187843505089,0.975496370256716,0.704154930115037,0.830917321241823,0.505354920954802,0.56524759352982,0.281295562629293,0.771307089258861,0.721542795380465,0.928168487263456,0.837008877794826,0.136151632430287,0.911054114090732,0.838085205456447,0.934137907344219,0.93978671918535,0.0584804696147358,0.925992931351669,0.985816902161052,0.578378538142481,0.678801194076906,0.801237056084509],[0.702742245104395,0.625346678435898,0.755559225085771,0.113135389559548,0.824195200552008,0.979500542441513,0.888203881168538,0.970247311028842,0.860026610777695,0.91278673675685,0.758067980699134,0.976342761210528,0.801366440614424,0.880421159957359,0.667610912952085,0.702262044681416,0.31173961502649,0.760176793477191,0.803207668477582,0.924013046076098,0.875871198564771,0.219078004169715,0.926544645206385,0.879572389232268,0.948541029618888,0.951612425529541,0.0777655126607663,0.917874075824919,0.987883329756981,0.695427240842373,0.794220165793408,0.818807714506509],[0.695426706750355,0.617837099118647,0.801530827966969,0.112093971709992,0.851744360344935,0.981636933446472,0.891591448304286,0.966584399766297,0.876096307187025,0.915110377291309,0.766432116418369,0.978396090839486,0.804594903057275,0.883064540013846,0.671550569595473,0.70570967417102,0.307750469049963,0.765831761871851,0.805774493483984,0.928943635853283,0.879937349179347,0.220328230836593,0.929615276803012,0.883609304835375,0.951279948928537,0.954163896824485,0.0780190738386583,0.923797127363952,0.989449982430331,0.697684988579323,0.795843376673212,0.822165385850965]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_5suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-9-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="genes-5" class="section level3">
<h3>20 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_20genes_EUR.RDS&quot;))
  df_fdr02_5snp &lt;- df[df$FDR_5suppSNP &lt; 0.2,]
  df_fdr02_5snp &lt;- df_fdr02_5snp[complete.cases(df_fdr02_5snp$FDR_5suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_5snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_5suppSNP&quot;)]

df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_5suppSNP, decreasing = F),]


df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-b544a055166914a18edc" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b544a055166914a18edc">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66"],["B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD15_positive_leukocyte","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","platelet","platelet","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte"],["CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HCT-ebi-a-GCST90002383","HCT-ebi-a-GCST90002383","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","Psoriasis-ebi-a-GCST90038681","RBC-ebi-a-GCST90002403","RBC-ebi-a-GCST90002403","T1D-ebi-a-GCST90014023","allergy-ebi-a-GCST005038","CD-ebi-a-GCST003044","RBC-ebi-a-GCST90002403","asthma_pmid36778051","MCH-ebi-a-GCST90002390","CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HCT-ebi-a-GCST90002383","HCT-ebi-a-GCST90002383","HCT-ebi-a-GCST90002383","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","RBC-ebi-a-GCST90002403","RBC-ebi-a-GCST90002403","RBC-ebi-a-GCST90002403","RBC-ebi-a-GCST90002403","T1D-ebi-a-GCST90014023","T1D-ebi-a-GCST90014023","T1D-ebi-a-GCST90014023","UC-ebi-a-GCST003045","WBC-ebi-a-GCST90002407","WBC-ebi-a-GCST90002407","WBC-ebi-a-GCST90002407","asthma_pmid36778051","HB-ebi-a-GCST90002384","PLT-ebi-a-GCST90002402","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","IBD-ebi-a-GCST003043","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","WBC-ebi-a-GCST90002407"],["05010_PC3","05167_PC3","04060_PC2","05169_PC3","04060_PC2","04510_PC5","03010_PC2","05416_PC5","04062_PC2","04934_PC2","04970_PC3","04211_PC3","05414_PC4","05130_PC5","04068_PC1","04924_PC3","04910_PC4","04662_PC5","05206_PC3","04211_PC3","04340_PC2","05012_PC4","05145_PC2","05169_PC2","05224_PC4","05225_PC4","05332_PC5","05320_PC4","05330_PC4","05332_PC5","04724_PC1","04927_PC4","05110_PC3","04062_PC5","05231_PC4","03013_PC3","04110_PC3","04215_PC1","04650_PC3","05100_PC3","05131_PC4","03040_PC5","05152_PC5","04140_PC5","04666_PC2","05216_PC1","05224_PC4","04725_PC5","04931_PC5","05150_PC3","05225_PC3","03050_PC3","04014_PC4","05167_PC3","05165_PC5","04064_PC1","04934_PC5","04060_PC2","04670_PC1","04971_PC1","04971_PC2","04390_PC4","05161_PC2","05163_PC4","05220_PC5","05320_PC3"],["05010","05167","04060","05169","04060","04510","03010","05416","04062","04934","04970","04211","05414","05130","04068","04924","04910","04662","05206","04211","04340","05012","05145","05169","05224","05225","05332","05320","05330","05332","04724","04927","05110","04062","05231","03013","04110","04215","04650","05100","05131","03040","05152","04140","04666","05216","05224","04725","04931","05150","05225","03050","04014","05167","05165","04064","04934","04060","04670","04971","04971","04390","05161","05163","05220","05320"],["Alzheimer disease","Kaposi sarcoma-associated herpesvirus infection","Cytokine-cytokine receptor interaction","Epstein-Barr virus infection","Cytokine-cytokine receptor interaction","Focal adhesion","Ribosome","Viral myocarditis","Chemokine signaling pathway","Cushing syndrome","Salivary secretion","Longevity regulating pathway","Dilated cardiomyopathy","Pathogenic Escherichia coli infection","FoxO signaling pathway","Renin secretion","Insulin signaling pathway","B cell receptor signaling pathway","MicroRNAs in cancer","Longevity regulating pathway","Hedgehog signaling pathway","Parkinson disease","Toxoplasmosis","Epstein-Barr virus infection","Breast cancer","Hepatocellular carcinoma","Graft-versus-host disease","Autoimmune thyroid disease","Allograft rejection","Graft-versus-host disease","Glutamatergic synapse","Cortisol synthesis and secretion","Vibrio cholerae infection","Chemokine signaling pathway","Choline metabolism in cancer","RNA transport","Cell cycle","Apoptosis - multiple species","Natural killer cell mediated cytotoxicity","Bacterial invasion of epithelial cells","Shigellosis","Spliceosome","Tuberculosis","Autophagy - animal","Fc gamma R-mediated phagocytosis","Thyroid cancer","Breast cancer","Cholinergic synapse","Insulin resistance","Staphylococcus aureus infection","Hepatocellular carcinoma","Proteasome","Ras signaling pathway","Kaposi sarcoma-associated herpesvirus infection","Human papillomavirus infection","NF-kappa B signaling pathway","Cushing syndrome","Cytokine-cytokine receptor interaction","Leukocyte transendothelial migration","Gastric acid secretion","Gastric acid secretion","Hippo signaling pathway","Hepatitis B","Human cytomegalovirus infection","Chronic myeloid leukemia","Autoimmune thyroid disease"],[5,11,6,8,8,7,5,5,6,8,7,12,5,8,9,6,8,8,9,8,11,6,17,11,9,18,5,8,8,8,6,6,5,33,22,32,12,21,21,17,11,21,20,8,9,5,10,9,6,5,5,7,5,13,9,5,6,5,10,5,5,8,17,6,10,13],[0.000194,0.000191,0.000489,0.000438,0.000565,0.000709,0.00045,0.000138,4e-05,0.000693,0.00035,0.000195,0.000424,7.6e-05,7.1e-05,0.000105,1e-06,0.0016998,0.000356,0.0014999,0.0021998,0.000907,9.5e-05,0.0020998,0.000228,0.0010999,0.001217,0.0013999,0.0011999,0.0014999,0.0014999,0.0012999,0.0017998,0.0021998,0.000148,0.0016998,0.000402,0.0017998,0.0022998,0.000267,0.0022998,0.0013999,0.0020998,0.0023998,0.000212,5.1e-05,0.000251,0.0021998,0.000162,0.000182,0.0020998,0.0011999,0.0016998,0.000596,0.0016998,8e-06,8.3e-05,0.000527,8.3e-05,0.000189,5e-05,0.000436,0.000545,0.000597,0.000356,0.000342],[171,186,294,201,294,199,153,60,189,155,90,89,96,202,131,69,137,82,310,89,50,142,112,201,147,168,41,53,38,41,114,65,50,189,98,179,124,32,134,73,236,149,180,137,93,37,147,112,108,96,168,45,232,186,330,102,155,294,112,75,75,155,162,225,76,53],[111,127,101,158,101,105,126,46,109,75,34,56,31,129,85,30,87,68,117,56,22,87,74,159,73,106,30,28,28,30,42,27,37,112,56,141,92,25,88,48,161,112,121,106,66,29,73,57,69,37,106,41,120,135,192,47,46,118,69,34,34,75,113,152,64,29],[0.111657,0.111657,0.1400007,0.1400007,0.147054090909091,0.156143615384615,0.1400007,0.111657,0.111657,0.156143615384615,0.1400007,0.111657,0.1400007,0.156625,0.156625,0.156625,0.001895,0.192392413793103,0.11036,0.192392413793103,0.192685945945946,0.192392413793103,0.0919666666666667,0.192685945945946,0.0919666666666667,0.192392413793103,0.192392413793103,0.192392413793103,0.192392413793103,0.192392413793103,0.192392413793103,0.192392413793103,0.192392413793103,0.192685945945946,0.0919666666666667,0.192392413793103,0.113290909090909,0.192392413793103,0.192685945945946,0.0919666666666667,0.192685945945946,0.192392413793103,0.192685945945946,0.195773157894737,0.0919666666666667,0.0919666666666667,0.0919666666666667,0.192685945945946,0.0919666666666667,0.0919666666666667,0.192685945945946,0.192392413793103,0.192392413793103,0.153966666666667,0.192392413793103,0.017936,0.093043,0.192101333333333,0.120184,0.182448,0.120184,0.192101333333333,0.192101333333333,0.192101333333333,0.192101333333333,0.192101333333333],["0.065043669804054","0.0407413285703631","0.233290435680774","-0.534248648998176","0.356193457802385","-0.319389509893942","-0.226096753153129","-0.0607991215739534","1.69054931142635","0.0115755318449362","-0.128493235792523","0.0673449539000475","0.318232098091908","-0.0193260981996803","0.219067049860872","0.0574186991373062","-0.245270464051887","0.224161395309605","0.00855641452932909","-0.348413458290912","0.363518111479405","-0.0703790138424771","0.3945080651716","-0.0847216178683809","-0.462572162007828","-0.377498728623431","-0.457950645393727","0.60367878598056","0.723988776246862","-0.472509967757784","-0.00447232801765263","0.128132816919057","0.189771179278637","-0.287551049951694","-0.386903201479075","-0.216936973418796","-0.271382014444818","0.0535154869708909","0.0792134874084198","-0.273002771884234","-0.0446276414251192","0.322014218717409","0.332776979603969","0.270740652036288","-0.586246084886727","-0.0493807576852792","0.0811961416249538","-0.0930701436453734","0.0465362456499863","0.069526588340074","0.169643258390511","-0.0885384263497135","-0.243382107343253","-0.241809277366614","-0.154404185201268","-0.41768128699344","0.399605189249052","-0.0495864361159254","-0.146323318161613","-0.0195316446390257","-0.160017285934662","0.272708295051201","-0.184266066760261","0.450641473397976","0.0363214279779365","0.3251007468362"],["0.676422858700943","0.82213266646417","0.714976796119257","0.260251668392045","0.553028372038752","0.518149015164986","0.652614467038651","0.887827644756179","0.793939736663622","0.976526536481923","0.696491658215512","0.419586506203072","0.74823649131926","0.913239055239114","0.556808502315391","0.919996273137037","0.381444392107266","0.123187621862967","0.940083381702828","0.263938210086007","0.234773143945004","0.848192010099061","0.281999819202358","0.828720238954072","0.287222413876834","0.280778285613935","0.376546053192622","0.286916323173616","0.154996114349737","0.387064462406523","0.977496112377122","0.399463459877539","0.367605827466474","0.243530589595738","0.0859600464937421","0.388619191498645","0.292534414891608","0.811859523962251","0.748928637791634","0.224765119161665","0.891091578444527","0.226638582704093","0.386588800946302","0.504822477870484","0.265690299732697","0.890160086598626","0.840955178249583","0.637870900403531","0.647406852649903","0.632216248125993","0.255786306670227","0.792684931835432","0.684960384522966","0.50495276158393","0.825786767002584","0.386094674495389","0.29079390368139","0.666382327665147","0.380080136666012","0.878437186997933","0.272526832466116","0.187412601065013","0.457985632021196","0.112784189247152","0.896349750087033","0.42200431630917"],[0.0847361914714528,0.116299644326158,0.0664088223331143,0.794053502006476,0.0452324631745179,0.0040001060324823,0.0273526123636242,0.00622036207431019,0.0350310927389958,0.0208182452474056,0.0442804452785797,0.0655913071415878,0.0378052711784273,0.003732249187829,0.0776990534387795,0.0925372074175356,0.0650233283387432,0.0427331866356799,0.0176798008887221,0.0903760967021907,0.058162983909972,0.0303499381977847,0.030432161138051,0.018672831109516,0.549047828192121,0.0233779741202946,0.0312363819105265,0.00439940465045449,0.0326481320490969,0.025542869558796,0.109136119489772,0.0934171997651439,0.00467356084774665,0.0436444616343737,0.0170276539084219,0.00889118187561336,0.0294296169455622,0.0153482591788415,0.0757243209325502,0.0114142797939032,0.0215939556277694,0.0378008121185538,0.0190532129364367,0.057013312909663,0.010647801372447,0.0849285644062765,0.8694058176999,0.0637849929142893,0.0192800234012339,0.13407594246512,0.0362247386086399,0.0245734759410528,0.0311697582601596,0.0020724444062013,0.0209984803647013,0.082970925026339,0.0499508903092853,0.000228591834057765,0.0415005690507217,0.0355491368003,0.000985729264436275,0.00268973663414908,0.0143668158119024,0.0107354552341952,0.0017355830108804,0.00128720435619216],[0.088618779674983,0.121198032964722,0.0528417488799388,0.797863285468394,0.0381385168705888,0.00398094682568144,0.0271652583804653,0.0076794587191138,0.0313681947790197,0.0208981551072142,0.0439970392563044,0.0638589495916766,0.0363507554299642,0.00364634929001638,0.0771593172214685,0.0907451209475906,0.064654398239135,0.0417199395482372,0.0171021440600706,0.0898602405711185,0.0578791344072203,0.0304741411663856,0.0302218466361632,0.0185463293218196,0.551177899788638,0.0236279660889231,0.834638925435765,0.0892427361953943,0.0668356327539848,0.479585179203667,0.107185829423767,0.0919856335233047,0.00457302196589828,0.0432131254358461,0.0169263234988166,0.00881517805720049,0.0292064075169795,0.0152274111115788,0.075102673021065,0.0113214415355828,0.0214883558656787,0.0375630780130514,0.0189415577076025,0.0571456190635524,0.0105885774180777,0.0827715206611724,0.870136427325358,0.0632748149542239,0.0184583775576921,0.13065469574839,0.0350175712420572,0.0244233612067337,0.0309834162926599,0.0020594999149768,0.0203713007540329,0.0825433684443156,0.0496773388250982,0.000223672658050194,0.0412206656189248,0.0348278520069879,0.091322867219367,0.00267641213074097,0.014269633331496,0.0692251016844291,0.00172437664984205,0.00406464059971539],[0.544554455445545,0.316831683168317,0.663366336633663,0.0792079207920792,0.801980198019802,1,0.891089108910891,0.702970297029703,0.851485148514851,0.900990099009901,0.841584158415842,0.603960396039604,0.821782178217822,0.96039603960396,0.386138613861386,0.663366336633663,0.455445544554455,0.752475247524752,0.851485148514851,0.396039603960396,0.633663366336634,0.861386138613861,0.693069306930693,0.871287128712871,0.118811881188119,0.831683168316832,0.633663366336634,0.772277227722772,0.673267326732673,0.712871287128713,0.574257425742574,0.732673267326733,0.96039603960396,0.584158415841584,0.841584158415842,0.831683168316832,0.742574257425743,0.851485148514851,0.524752475247525,0.940594059405941,0.811881188118812,0.673267326732673,0.841584158415842,0.663366336633663,0.851485148514851,0.554455445544555,0.0594059405940594,0.772277227722772,0.96039603960396,0.742574257425743,0.831683168316832,0.831683168316832,0.702970297029703,0.940594059405941,0.891089108910891,0.564356435643564,0.633663366336634,1,0.772277227722772,0.762376237623762,0.97029702970297,0.97029702970297,0.633663366336634,0.831683168316832,1,0.910891089108911],[0.544554455445545,0.306930693069307,0.712871287128713,0.0792079207920792,0.851485148514851,1,0.891089108910891,0.98019801980198,0.881188118811881,0.900990099009901,0.851485148514851,0.623762376237624,0.831683168316832,0.96039603960396,0.386138613861386,0.663366336633663,0.475247524752475,0.762376237623762,0.861386138613861,0.396039603960396,0.633663366336634,0.861386138613861,0.693069306930693,0.871287128712871,0.118811881188119,0.831683168316832,0.0594059405940594,0.831683168316832,0.861386138613861,0.356435643564356,0.574257425742574,0.732673267326733,0.96039603960396,0.594059405940594,0.841584158415842,0.831683168316832,0.742574257425743,0.851485148514851,0.544554455445545,0.940594059405941,0.811881188118812,0.683168316831683,0.841584158415842,0.663366336633663,0.851485148514851,0.594059405940594,0.0594059405940594,0.772277227722772,0.96039603960396,0.742574257425743,0.831683168316832,0.831683168316832,0.712871287128713,0.940594059405941,0.891089108910891,0.574257425742574,0.633663366336634,1,0.772277227722772,0.762376237623762,0.613861386138614,0.97029702970297,0.633663366336634,0.247524752475248,1,0.96039603960396],[0.678173037418315,0.594204696087627,0.664351439136131,0.0818443267881644,0.768730474957558,0.976000186045069,0.848667839784188,0.957426686614832,0.893504701513942,0.880217982806335,0.754777094751203,0.760784800117829,0.858846055456934,0.972107083152037,0.497416050259158,0.624193708444974,0.716751346797049,0.823558598789322,0.920069312447997,0.559094968740697,0.691315333470737,0.831673040663812,0.831215028892909,0.893726002091587,0.134678361233884,0.86879489469546,0.82684101648079,0.970626178426119,0.816031938687491,0.854115617438035,0.616583079518477,0.658804131266174,0.977206280868085,0.762368226196747,0.905000725185304,0.943954626300563,0.832054717139564,0.908451080526103,0.603682414638056,0.92979442905016,0.874413172418531,0.775986442851581,0.887107732002046,0.669346035526446,0.932840207326662,0.545545453851497,0.057602613720506,0.769833818062458,0.921710521293731,0.591323730353203,0.857016358653751,0.852207235059274,0.814184624544851,0.98261845329425,0.907420554041572,0.57560024039172,0.676574615028423,0.997119713361287,0.798503486459564,0.822418359703786,0.991057984108231,0.974772395579957,0.896603115033861,0.92020911035436,0.982139134060741,0.984988532907082],[0.672428895900032,0.588584584615623,0.732288896985295,0.0819993643460128,0.808288307842575,0.979938140014418,0.855473988573732,0.953969349074813,0.902806954984845,0.887427229246285,0.764939806668165,0.768187843505089,0.86507856528244,0.975496370256716,0.505354920954802,0.632804329737941,0.721542795380465,0.83495545835528,0.928168487263456,0.566270486484836,0.697513759436951,0.835604308364058,0.837008877794826,0.898680162746849,0.136151632430287,0.872046778268868,0.0696254227066969,0.567392615323547,0.655926290639003,0.157479713895314,0.625728047877497,0.666849871375028,0.9790917626583,0.772413951038542,0.911054114090732,0.94806909870917,0.838085205456447,0.913283104709124,0.612506774757445,0.934137907344219,0.879726108961,0.783513102953413,0.892863413256387,0.680307783910047,0.93978671918535,0.565858275891024,0.0584804696147358,0.773246005755681,0.925992931351669,0.600903809894581,0.865886519950229,0.859031610445722,0.821528079938321,0.985816902161052,0.911351821741819,0.578378538142481,0.678801194076906,0.997868742326314,0.801237056084509,0.827028362715346,0.629176608674836,0.977366970139227,0.900448645184207,0.590458760936209,0.984633323294801,0.964085219419155],[0.702742245104395,0.625346678435898,0.755559225085771,0.113135389559548,0.824195200552008,0.979500542441513,0.888203881168538,0.970247311028842,0.860026610777695,0.91278673675685,0.827494867131421,0.758067980699134,0.850113446049142,0.976342761210528,0.667610912952085,0.623760306535783,0.803207668477582,0.831930594171991,0.924013046076098,0.685677958960541,0.780083543344535,0.876175586625345,0.875871198564771,0.920212494585313,0.219078004169715,0.902281305394853,0.872936805943153,0.977403246920627,0.86781895922977,0.894082891002514,0.639103337358084,0.677751831439714,0.976180535558659,0.828773595090505,0.926544645206385,0.958678508693403,0.879572389232268,0.933143541422285,0.726326471767864,0.948541029618888,0.909038796771003,0.84925052322072,0.918743483028694,0.783749193409855,0.951612425529541,0.70029278959524,0.0777655126607663,0.762229167713618,0.917874075824919,0.585273273791997,0.854889632099355,0.89776229872029,0.873173170055476,0.987883329756981,0.911331165611372,0.695427240842373,0.794220165793408,0.997090765562984,0.818807714506509,0.840907149205397,0.991810034394338,0.981970903403211,0.927009161643336,0.943083885149123,0.987336489659084,0.989946895018987],[0.695426706750355,0.617837099118647,0.801530827966969,0.112093971709992,0.851744360344935,0.981636933446472,0.891591448304286,0.966584399766297,0.876096307187025,0.915110377291309,0.831370641330609,0.766432116418369,0.858120158314141,0.978396090839486,0.671550569595473,0.631102307062777,0.805774493483984,0.839083809134737,0.928943635853283,0.691455026520741,0.785069736967061,0.879028388724763,0.879937349179347,0.923461975663859,0.220328230836593,0.904358519837102,0.0947770410002883,0.693082633237609,0.757027437535959,0.255981569331594,0.648187591705741,0.685902667283978,0.978454943019434,0.83392927534814,0.929615276803012,0.961192528601108,0.883609304835375,0.936207294192685,0.73240735415312,0.951279948928537,0.912393179949521,0.853610552578022,0.921968697136937,0.787383124443126,0.954163896824485,0.710603576874991,0.0780190738386583,0.767911078177669,0.923797127363952,0.596658304434302,0.862673215054464,0.901371007390726,0.877152953185193,0.989449982430331,0.916612193369155,0.697684988579323,0.795843376673212,0.997972176036228,0.822165385850965,0.845855805112413,0.667618950789075,0.983211063402407,0.929110629771649,0.729252158005971,0.988502232326657,0.976124020638922]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_5suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-10-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="number-of-supp_snp-10" class="section level2">
<h2>Number of supp_SNP &gt;=10</h2>
<div id="genes-6" class="section level3">
<h3>40 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_40genes_EUR.RDS&quot;))
  df_fdr02_10snp &lt;- df[df$FDR_10suppSNP &lt; 0.2,]
  df_fdr02_10snp &lt;- df_fdr02_10snp[complete.cases(df_fdr02_10snp$FDR_10suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_10snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_10suppSNP&quot;)]
df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_10suppSNP, decreasing = F),]

df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-0d0e9bf024e70c3c54e0" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-0d0e9bf024e70c3c54e0">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37"],["B_cell","B_cell","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","thymocyte","thymocyte","thymocyte"],["CD-ebi-a-GCST003044","T1D-ebi-a-GCST90014023","CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HCT-ebi-a-GCST90002383","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","RBC-ebi-a-GCST90002403","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","RBC-ebi-a-GCST90002403","WBC-ebi-a-GCST90002407","WBC-ebi-a-GCST90002407","WBC-ebi-a-GCST90002407","WBC-ebi-a-GCST90002407","IBD-ebi-a-GCST003043","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402"],["05167_PC3","04211_PC3","04062_PC3","05221_PC5","04630_PC3","04658_PC4","04658_PC4","04010_PC4","04217_PC4","04371_PC4","05170_PC4","04371_PC4","04931_PC3","05145_PC3","01524_PC3","04390_PC2","05145_PC2","05169_PC2","05225_PC4","04062_PC5","05231_PC4","03013_PC3","04110_PC3","04650_PC3","05100_PC3","05131_PC4","03013_PC5","03040_PC5","05152_PC5","05224_PC4","04022_PC5","04919_PC4","05163_PC4","05167_PC3","04670_PC1","05161_PC2","05220_PC5"],["05167","04211","04062","05221","04630","04658","04658","04010","04217","04371","05170","04371","04931","05145","01524","04390","05145","05169","05225","04062","05231","03013","04110","04650","05100","05131","03013","03040","05152","05224","04022","04919","05163","05167","04670","05161","05220"],["Kaposi sarcoma-associated herpesvirus infection","Longevity regulating pathway","Chemokine signaling pathway","Acute myeloid leukemia","JAK-STAT signaling pathway","Th1 and Th2 cell differentiation","Th1 and Th2 cell differentiation","MAPK signaling pathway","Necroptosis","Apelin signaling pathway","Human immunodeficiency virus 1 infection","Apelin signaling pathway","Insulin resistance","Toxoplasmosis","Platinum drug resistance","Hippo signaling pathway","Toxoplasmosis","Epstein-Barr virus infection","Hepatocellular carcinoma","Chemokine signaling pathway","Choline metabolism in cancer","RNA transport","Cell cycle","Natural killer cell mediated cytotoxicity","Bacterial invasion of epithelial cells","Shigellosis","RNA transport","Spliceosome","Tuberculosis","Breast cancer","cGMP-PKG signaling pathway","Thyroid hormone signaling pathway","Human cytomegalovirus infection","Kaposi sarcoma-associated herpesvirus infection","Leukocyte transendothelial migration","Hepatitis B","Chronic myeloid leukemia"],[11,12,16,13,17,14,13,11,12,15,14,16,12,19,12,10,17,11,18,33,22,32,12,21,17,11,11,21,20,10,14,10,11,13,10,17,10],[0.000191,0.000195,0.0034997,0.0060994,0.0037996,0.0011999,0.0041996,0.0054995,0.0047995,0.000528,0.0063994,0.0058994,0.0034997,0.002049,0.0011999,0.0043996,9.5e-05,0.0020998,0.0010999,0.0021998,0.000148,0.0016998,0.000402,0.0022998,0.000267,0.0022998,0.0045995,0.0013999,0.0020998,0.000251,0.0028997,0.0044996,0.0040996,0.000596,8.3e-05,0.000545,0.000356],[186,89,189,67,162,92,92,295,162,137,212,137,108,112,73,155,112,201,168,189,98,179,124,134,73,236,179,149,180,147,167,119,225,186,112,162,76],[127,56,100,47,73,51,51,145,89,69,128,69,56,68,50,73,74,159,106,112,56,141,92,88,48,161,141,112,121,73,78,83,147,135,69,113,64],[0.0595725,0.0595725,0.149155246153846,0.149155246153846,0.149155246153846,0.1211899,0.149155246153846,0.149155246153846,0.149155246153846,0.1211899,0.149155246153846,0.149155246153846,0.149155246153846,0.149155246153846,0.1211899,0.1609825,0.04438875,0.1092405,0.1044905,0.1092405,0.04438875,0.1092405,0.053466,0.1092405,0.04438875,0.1092405,0.1609825,0.1092405,0.1092405,0.04438875,0.128553366666667,0.1609825,0.1609825,0.0660566666666667,0.052871,0.115721666666667,0.113386],["0.0407413285703631","0.0673449539000475","-0.1110881517431","-0.100560730550873","0.593361245379237","0.324162333969528","0.24122354428438","-0.305010092582289","0.0318533464547037","-0.239321515786984","-0.699703922244734","0.533621943545005","-0.0314165291147899","-0.233183518890574","-0.530977033045136","0.144217476692479","0.3945080651716","-0.0847216178683809","-0.377498728623431","-0.287551049951694","-0.386903201479075","-0.216936973418796","-0.271382014444818","0.0792134874084198","-0.273002771884234","-0.0446276414251192","-0.551577060378832","0.322014218717409","0.332776979603969","0.0811961416249538","0.0102160818082984","0.537579421775396","-0.215871261560756","-0.241809277366614","-0.146323318161613","-0.184266066760261","0.0363214279779365"],["0.82213266646417","0.419586506203072","0.494990080042711","0.570165486105046","0.123278935391408","0.574006461289279","0.650120390250835","0.308249651598484","0.921895582674075","0.404959742240251","0.0433090711525298","0.0652864194794793","0.91823805009554","0.388434573960189","0.205911159984569","0.704420545176412","0.281999819202358","0.828720238954072","0.280778285613935","0.243530589595738","0.0859600464937421","0.388619191498645","0.292534414891608","0.748928637791634","0.224765119161665","0.891091578444527","0.0952101299006182","0.226638582704093","0.386588800946302","0.840955178249583","0.978779622955555","0.221476122239605","0.62624278717576","0.50495276158393","0.380080136666012","0.457985632021196","0.896349750087033"],[0.116299644326158,0.0655913071415878,0.562156117864453,null,0.861701577064341,0.00011056446185235,0.000105429567944078,null,0.0122823475445117,0.0410214185256843,null,null,0.027413693828597,0.012757951015231,0.0660817582777844,0.00422190800663116,0.030432161138051,0.018672831109516,0.0233779741202946,0.0436444616343737,0.0170276539084219,0.00889118187561336,0.0294296169455622,0.0757243209325502,0.0114142797939032,0.0215939556277694,0.0481980966842248,0.0378008121185538,0.0190532129364367,0.8694058176999,0.0550724616461559,0.0275269294526436,0.0163081631656834,0.0020724444062013,0.0415005690507217,0.0143668158119024,0.0017355830108804],[0.121198032964722,0.0638589495916766,0.561885586130145,null,0.862877654659642,0.0419023284357513,0.0985965779690209,null,0.0121884299868338,0.0407586797145041,null,null,0.0540198988021873,0.0152014989108512,0.0656744021496989,0.00419326788039654,0.0302218466361632,0.0185463293218196,0.0236279660889231,0.0432131254358461,0.0169263234988166,0.00881517805720049,0.0292064075169795,0.075102673021065,0.0113214415355828,0.0214883558656787,0.0476475583645252,0.0375630780130514,0.0189415577076025,0.870136427325358,0.0549539251191748,0.0273544491246734,0.0162313311685052,0.0020594999149768,0.0412206656189248,0.014269633331496,0.00172437664984205],[0.316831683168317,0.603960396039604,0.118811881188119,null,0.0495049504950495,1,1,null,0.910891089108911,0.772277227722772,null,null,0.831683168316832,0.851485148514851,0.742574257425743,0.96039603960396,0.693069306930693,0.871287128712871,0.831683168316832,0.584158415841584,0.841584158415842,0.831683168316832,0.742574257425743,0.524752475247525,0.940594059405941,0.811881188118812,0.693069306930693,0.673267326732673,0.841584158415842,0.0594059405940594,0.524752475247525,0.851485148514851,0.801980198019802,0.940594059405941,0.772277227722772,0.633663366336634,1],[0.306930693069307,0.623762376237624,0.118811881188119,null,0.0495049504950495,0.792079207920792,0.524752475247525,null,0.910891089108911,0.762376237623762,null,null,0.693069306930693,0.831683168316832,0.742574257425743,0.96039603960396,0.693069306930693,0.871287128712871,0.831683168316832,0.594059405940594,0.841584158415842,0.831683168316832,0.742574257425743,0.544554455445545,0.940594059405941,0.811881188118812,0.693069306930693,0.683168316831683,0.841584158415842,0.0594059405940594,0.524752475247525,0.851485148514851,0.801980198019802,0.940594059405941,0.772277227722772,0.633663366336634,1],[0.594204696087627,0.760784800117829,0.233810776078501,null,0.0747227683168654,0.997208534395452,0.997753210610974,null,0.930613356482072,0.806401647645552,null,null,0.862571382371214,0.927379341452413,0.706411009268006,0.971664338440165,0.831215028892909,0.893726002091587,0.86879489469546,0.762368226196747,0.905000725185304,0.943954626300563,0.832054717139564,0.603682414638056,0.92979442905016,0.874413172418531,0.717261700292364,0.775986442851581,0.887107732002046,0.057602613720506,0.688368791077931,0.83492492423722,0.899443515698353,0.98261845329425,0.798503486459564,0.896603115033861,0.982139134060741],[0.588584584615623,0.768187843505089,0.235759695662165,null,0.0747568105803355,0.811601603390609,0.62893932817593,null,0.933915456038672,0.810707993974519,null,null,0.761329690811142,0.920911311393095,0.711619475578931,0.975519270845261,0.837008877794826,0.898680162746849,0.872046778268868,0.772413951038542,0.911054114090732,0.94806909870917,0.838085205456447,0.612506774757445,0.934137907344219,0.879726108961,0.726895214540347,0.783513102953413,0.892863413256387,0.0584804696147358,0.695857283532187,0.842230211983115,0.905313699895421,0.985816902161052,0.801237056084509,0.900448645184207,0.984633323294801],[0.625346678435898,0.758067980699134,0.25865581793075,null,0.0940251710329037,0.998368599394222,0.998409501577077,null,0.951358144199793,0.865445026401081,null,null,0.904142752026682,0.949783836224251,0.800651708113502,0.978183993697467,0.875871198564771,0.920212494585313,0.902281305394853,0.828773595090505,0.926544645206385,0.958678508693403,0.879572389232268,0.726326471767864,0.948541029618888,0.909038796771003,0.813099616295251,0.84925052322072,0.918743483028694,0.0777655126607663,0.790097203546952,0.886644586908333,0.929363053174664,0.987883329756981,0.818807714506509,0.927009161643336,0.987336489659084],[0.617837099118647,0.766432116418369,0.259734186939166,null,0.0935978284349419,0.864628687001585,0.729104203849662,null,0.952898580055158,0.867746839347729,null,null,0.832508330624274,0.943069700302037,0.803312693353353,0.98008006571572,0.879937349179347,0.923461975663859,0.904358519837102,0.83392927534814,0.929615276803012,0.961192528601108,0.883609304835375,0.73240735415312,0.951279948928537,0.912393179949521,0.818761845673151,0.853610552578022,0.921968697136937,0.0780190738386583,0.794481308796051,0.890461762229168,0.932321712766586,0.989449982430331,0.822165385850965,0.929110629771649,0.988502232326657]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_10suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-11-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="genes-7" class="section level3">
<h3>20 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_20genes_EUR.RDS&quot;))
  df_fdr02_10snp &lt;- df[df$FDR_10suppSNP &lt; 0.2,]
  df_fdr02_10snp &lt;- df_fdr02_10snp[complete.cases(df_fdr02_10snp$FDR_10suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_10snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_10suppSNP&quot;)]

df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_10suppSNP, decreasing = F),]


df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-854fff1bc9f845d6a98c" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-854fff1bc9f845d6a98c">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59"],["B_cell","B_cell","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","T_cell","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte","thymocyte"],["CD-ebi-a-GCST003044","T1D-ebi-a-GCST90014023","CD-ebi-a-GCST003044","CD-ebi-a-GCST003044","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HCT-ebi-a-GCST90002383","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","PLT-ebi-a-GCST90002402","RBC-ebi-a-GCST90002403","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","HB-ebi-a-GCST90002384","MCH-ebi-a-GCST90002390","MCH-ebi-a-GCST90002390","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","RBC-ebi-a-GCST90002403","WBC-ebi-a-GCST90002407","WBC-ebi-a-GCST90002407","WBC-ebi-a-GCST90002407","WBC-ebi-a-GCST90002407","HB-ebi-a-GCST90002384","IBD-ebi-a-GCST003043","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","MCV-ebi-a-GCST90002392","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","PLT-ebi-a-GCST90002402","RBC-ebi-a-GCST90002403","WBC-ebi-a-GCST90002407","WBC-ebi-a-GCST90002407","WBC-ebi-a-GCST90002407"],["05167_PC3","04211_PC3","04062_PC3","05221_PC5","04630_PC3","04658_PC4","04658_PC4","04010_PC4","04217_PC4","04371_PC4","05170_PC4","04371_PC4","04931_PC3","05145_PC3","03030_PC2","01524_PC3","04340_PC2","04390_PC2","05145_PC2","05169_PC2","05225_PC4","04062_PC5","05231_PC4","03013_PC3","04110_PC3","04215_PC1","04650_PC3","05100_PC3","05131_PC4","03013_PC5","03040_PC5","05152_PC5","05224_PC4","04022_PC5","04919_PC4","05163_PC4","05167_PC3","04216_PC2","04670_PC1","04024_PC4","04340_PC4","04714_PC4","04722_PC3","04926_PC4","00071_PC2","04370_PC3","04520_PC4","04657_PC3","04919_PC4","05014_PC3","05016_PC4","05135_PC4","05145_PC4","05161_PC2","05220_PC5","04714_PC4","04940_PC3","05320_PC3","05330_PC3"],["05167","04211","04062","05221","04630","04658","04658","04010","04217","04371","05170","04371","04931","05145","03030","01524","04340","04390","05145","05169","05225","04062","05231","03013","04110","04215","04650","05100","05131","03013","03040","05152","05224","04022","04919","05163","05167","04216","04670","04024","04340","04714","04722","04926","00071","04370","04520","04657","04919","05014","05016","05135","05145","05161","05220","04714","04940","05320","05330"],["Kaposi sarcoma-associated herpesvirus infection","Longevity regulating pathway","Chemokine signaling pathway","Acute myeloid leukemia","JAK-STAT signaling pathway","Th1 and Th2 cell differentiation","Th1 and Th2 cell differentiation","MAPK signaling pathway","Necroptosis","Apelin signaling pathway","Human immunodeficiency virus 1 infection","Apelin signaling pathway","Insulin resistance","Toxoplasmosis","DNA replication","Platinum drug resistance","Hedgehog signaling pathway","Hippo signaling pathway","Toxoplasmosis","Epstein-Barr virus infection","Hepatocellular carcinoma","Chemokine signaling pathway","Choline metabolism in cancer","RNA transport","Cell cycle","Apoptosis - multiple species","Natural killer cell mediated cytotoxicity","Bacterial invasion of epithelial cells","Shigellosis","RNA transport","Spliceosome","Tuberculosis","Breast cancer","cGMP-PKG signaling pathway","Thyroid hormone signaling pathway","Human cytomegalovirus infection","Kaposi sarcoma-associated herpesvirus infection","Ferroptosis","Leukocyte transendothelial migration","cAMP signaling pathway","Hedgehog signaling pathway","Thermogenesis","Neurotrophin signaling pathway","Relaxin signaling pathway","Fatty acid degradation","VEGF signaling pathway","Adherens junction","IL-17 signaling pathway","Thyroid hormone signaling pathway","Amyotrophic lateral sclerosis","Huntington disease","Yersinia infection","Toxoplasmosis","Hepatitis B","Chronic myeloid leukemia","Thermogenesis","Type I diabetes mellitus","Autoimmune thyroid disease","Allograft rejection"],[11,12,16,13,17,14,13,11,12,15,14,16,12,19,10,12,11,10,17,11,18,33,22,32,12,21,21,17,11,11,21,20,10,14,10,11,13,21,10,15,10,10,18,20,14,11,13,10,11,15,16,15,14,17,10,16,13,13,12],[0.000191,0.000195,0.0034997,0.0060994,0.0037996,0.0011999,0.0041996,0.0054995,0.0047995,0.000528,0.0063994,0.0058994,0.0034997,0.002049,0.0051995,0.0011999,0.0021998,0.0043996,9.5e-05,0.0020998,0.0010999,0.0021998,0.000148,0.0016998,0.000402,0.0017998,0.0022998,0.000267,0.0022998,0.0045995,0.0013999,0.0020998,0.000251,0.0028997,0.0044996,0.0040996,0.000596,0.0019998,8.3e-05,0.0038996,0.0023998,0.0031997,0.0044996,0.0037996,0.001478,0.0011999,0.0041996,0.0049995,0.0025997,0.000708,0.0044996,0.0042996,0.0019998,0.000545,0.000356,0.0012999,0.0037996,0.000342,0.0014999],[186,89,189,67,162,92,92,295,162,137,212,137,108,112,36,73,50,155,112,201,168,189,98,179,124,32,134,73,236,179,149,180,147,167,119,225,186,40,112,216,50,231,119,129,44,59,71,94,119,57,264,120,112,162,76,231,43,53,38],[127,56,100,47,73,51,51,145,89,69,128,69,56,68,24,50,22,73,74,159,106,112,56,141,92,25,88,48,161,141,112,121,73,78,83,147,135,33,69,94,24,130,88,69,28,39,44,49,84,39,167,90,76,113,64,130,31,29,30],[0.0677625,0.0677625,0.1595279,0.1595279,0.1595279,0.139588366666667,0.1595279,0.1595279,0.1595279,0.139588366666667,0.1595279,0.1595279,0.1595279,0.1595279,0.1595279,0.139588366666667,0.1057908,0.161201523809524,0.049128,0.1057908,0.1057908,0.1057908,0.049128,0.1057908,0.0591744,0.1057908,0.1057908,0.049128,0.1057908,0.161201523809524,0.1057908,0.1057908,0.049128,0.125539952941176,0.161201523809524,0.161201523809524,0.0731093333333333,0.1383498,0.063163,0.163056933333333,0.152182438461538,0.163056933333333,0.163056933333333,0.163056933333333,0.126824877777778,0.126824877777778,0.163056933333333,0.17293725,0.152182438461538,0.1077576,0.163056933333333,0.163056933333333,0.1383498,0.10368625,0.0903053333333333,0.126824877777778,0.163056933333333,0.0903053333333333,0.126824877777778],["0.0407413285703631","0.0673449539000475","-0.1110881517431","-0.100560730550873","0.593361245379237","0.324162333969528","0.24122354428438","-0.305010092582289","0.0318533464547037","-0.239321515786984","-0.699703922244734","0.533621943545005","-0.0314165291147899","-0.233183518890574","0.451395451654444","-0.530977033045136","0.363518111479405","0.144217476692479","0.3945080651716","-0.0847216178683809","-0.377498728623431","-0.287551049951694","-0.386903201479075","-0.216936973418796","-0.271382014444818","0.0535154869708909","0.0792134874084198","-0.273002771884234","-0.0446276414251192","-0.551577060378832","0.322014218717409","0.332776979603969","0.0811961416249538","0.0102160818082984","0.537579421775396","-0.215871261560756","-0.241809277366614","0.186204196970328","-0.146323318161613","-0.0497481840979672","-0.0814124936249649","-0.537867543275294","-0.357953557312785","-0.0194109476464144","0.373332837053078","0.0116704298005137","-0.395796111989635","-0.124551369680396","0.341146698851871","-0.0740095805903693","0.591527537801505","-0.0476507181351538","-0.306384676187805","-0.184266066760261","0.0363214279779365","0.908184857186706","0.345125982139556","0.3251007468362","-0.324335128972217"],["0.82213266646417","0.419586506203072","0.494990080042711","0.570165486105046","0.123278935391408","0.574006461289279","0.650120390250835","0.308249651598484","0.921895582674075","0.404959742240251","0.0433090711525298","0.0652864194794793","0.91823805009554","0.388434573960189","0.126462280483677","0.205911159984569","0.234773143945004","0.704420545176412","0.281999819202358","0.828720238954072","0.280778285613935","0.243530589595738","0.0859600464937421","0.388619191498645","0.292534414891608","0.811859523962251","0.748928637791634","0.224765119161665","0.891091578444527","0.0952101299006182","0.226638582704093","0.386588800946302","0.840955178249583","0.978779622955555","0.221476122239605","0.62624278717576","0.50495276158393","0.598502916408624","0.380080136666012","0.839044609865298","0.791365014934603","0.220017018873353","0.175379176260371","0.94134129987067","0.176864788775393","0.96720958554113","0.128053603924188","0.68324799017751","0.240923912300581","0.796506681001568","0.124182441578103","0.821128988409026","0.270325001681758","0.457985632021196","0.896349750087033","0.130430359113488","0.451413765940807","0.42200431630917","0.499029939797781"],[0.116299644326158,0.0655913071415878,0.562156117864453,null,0.861701577064341,0.00011056446185235,0.000105429567944078,null,0.0122823475445117,0.0410214185256843,null,null,0.027413693828597,0.012757951015231,null,0.0660817582777844,0.058162983909972,0.00422190800663116,0.030432161138051,0.018672831109516,0.0233779741202946,0.0436444616343737,0.0170276539084219,0.00889118187561336,0.0294296169455622,0.0153482591788415,0.0757243209325502,0.0114142797939032,0.0215939556277694,0.0481980966842248,0.0378008121185538,0.0190532129364367,0.8694058176999,0.0550724616461559,0.0275269294526436,0.0163081631656834,0.0020724444062013,0.0238865353466356,0.0415005690507217,0.00825231461127693,0.0340159927584236,0.0376974695443074,0.00715436909540176,0.0525288471500384,0.0574167490213666,0.0725959371726112,0.00427811763957739,0.0177892478529367,0.0133442682861961,0.0391289514001323,0.00271344427608263,0.00166727878559535,0.0128743570003735,0.0143668158119024,0.0017355830108804,0.0150010159465437,0.00784425642390997,0.00128720435619216,0.00852108897998927],[0.121198032964722,0.0638589495916766,0.561885586130145,null,0.862877654659642,0.0419023284357513,0.0985965779690209,null,0.0121884299868338,0.0407586797145041,null,null,0.0540198988021873,0.0152014989108512,null,0.0656744021496989,0.0578791344072203,0.00419326788039654,0.0302218466361632,0.0185463293218196,0.0236279660889231,0.0432131254358461,0.0169263234988166,0.00881517805720049,0.0292064075169795,0.0152274111115788,0.075102673021065,0.0113214415355828,0.0214883558656787,0.0476475583645252,0.0375630780130514,0.0189415577076025,0.870136427325358,0.0549539251191748,0.0273544491246734,0.0162313311685052,0.0020594999149768,0.0237278864091786,0.0412206656189248,0.00818552071800231,0.0337728720206938,0.037142759734284,0.00710011593623661,0.0520200857183403,0.0565422938247281,0.0723546929255282,0.00424796434463555,0.0208304671052544,0.013255343939401,0.0392059944284188,0.00269645020108824,0.00165568048907021,0.013197820539951,0.014269633331496,0.00172437664984205,0.015046790216197,0.0225535103333803,0.00406464059971539,0.0172626631876832],[0.316831683168317,0.603960396039604,0.118811881188119,null,0.0495049504950495,1,1,null,0.910891089108911,0.772277227722772,null,null,0.831683168316832,0.851485148514851,null,0.742574257425743,0.633663366336634,0.96039603960396,0.693069306930693,0.871287128712871,0.831683168316832,0.584158415841584,0.841584158415842,0.831683168316832,0.742574257425743,0.851485148514851,0.524752475247525,0.940594059405941,0.811881188118812,0.693069306930693,0.673267326732673,0.841584158415842,0.0594059405940594,0.524752475247525,0.851485148514851,0.801980198019802,0.940594059405941,0.801980198019802,0.772277227722772,0.95049504950495,0.920792079207921,0.732673267326733,0.851485148514851,0.534653465346535,0.633663366336634,0.782178217821782,0.900990099009901,0.851485148514851,0.841584158415842,0.861386138613861,0.99009900990099,0.99009900990099,0.920792079207921,0.633663366336634,1,0.910891089108911,0.772277227722772,0.910891089108911,0.851485148514851],[0.306930693069307,0.623762376237624,0.118811881188119,null,0.0495049504950495,0.792079207920792,0.524752475247525,null,0.910891089108911,0.762376237623762,null,null,0.693069306930693,0.831683168316832,null,0.742574257425743,0.633663366336634,0.96039603960396,0.693069306930693,0.871287128712871,0.831683168316832,0.594059405940594,0.841584158415842,0.831683168316832,0.742574257425743,0.851485148514851,0.544554455445545,0.940594059405941,0.811881188118812,0.693069306930693,0.683168316831683,0.841584158415842,0.0594059405940594,0.524752475247525,0.851485148514851,0.801980198019802,0.940594059405941,0.821782178217822,0.772277227722772,0.95049504950495,0.920792079207921,0.752475247524752,0.851485148514851,0.524752475247525,0.643564356435644,0.782178217821782,0.900990099009901,0.841584158415842,0.841584158415842,0.861386138613861,0.99009900990099,0.99009900990099,0.910891089108911,0.633663366336634,1,0.910891089108911,0.851485148514851,0.96039603960396,0.910891089108911],[0.594204696087627,0.760784800117829,0.233810776078501,null,0.0747227683168654,0.997208534395452,0.997753210610974,null,0.930613356482072,0.806401647645552,null,null,0.862571382371214,0.927379341452413,null,0.706411009268006,0.691315333470737,0.971664338440165,0.831215028892909,0.893726002091587,0.86879489469546,0.762368226196747,0.905000725185304,0.943954626300563,0.832054717139564,0.908451080526103,0.603682414638056,0.92979442905016,0.874413172418531,0.717261700292364,0.775986442851581,0.887107732002046,0.057602613720506,0.688368791077931,0.83492492423722,0.899443515698353,0.98261845329425,0.843144068385572,0.798503486459564,0.934479270430344,0.764774017189056,0.743855259804944,0.942301603848619,0.663562443533255,0.642280754588768,0.571130724859268,0.963413409935058,0.874827221411418,0.903220824549617,0.742797352916194,0.974587068825723,0.982741446012,0.906348213527309,0.896603115033861,0.982139134060741,0.888093528235303,0.934124060818063,0.984988532907082,0.929467726117945],[0.588584584615623,0.768187843505089,0.235759695662165,null,0.0747568105803355,0.811601603390609,0.62893932817593,null,0.933915456038672,0.810707993974519,null,null,0.761329690811142,0.920911311393095,null,0.711619475578931,0.697513759436951,0.975519270845261,0.837008877794826,0.898680162746849,0.872046778268868,0.772413951038542,0.911054114090732,0.94806909870917,0.838085205456447,0.913283104709124,0.612506774757445,0.934137907344219,0.879726108961,0.726895214540347,0.783513102953413,0.892863413256387,0.0584804696147358,0.695857283532187,0.842230211983115,0.905313699895421,0.985816902161052,0.847491525161968,0.801237056084509,0.937784264214176,0.770356985660342,0.751137056856704,0.945467602566776,0.670411811491803,0.650844395023977,0.576443425147296,0.96634002826233,0.858580242623609,0.907043188855684,0.746279951506166,0.977189365333086,0.985166137713222,0.907367510675593,0.900448645184207,0.984633323294801,0.892062609555139,0.840603547462954,0.964085219419155,0.874502899591509],[0.625346678435898,0.758067980699134,0.25865581793075,null,0.0940251710329037,0.998368599394222,0.998409501577077,null,0.951358144199793,0.865445026401081,null,null,0.904142752026682,0.949783836224251,null,0.800651708113502,0.780083543344535,0.978183993697467,0.875871198564771,0.920212494585313,0.902281305394853,0.828773595090505,0.926544645206385,0.958678508693403,0.879572389232268,0.933143541422285,0.726326471767864,0.948541029618888,0.909038796771003,0.813099616295251,0.84925052322072,0.918743483028694,0.0777655126607663,0.790097203546952,0.886644586908333,0.929363053174664,0.987883329756981,0.886824382442458,0.818807714506509,0.954497570902321,0.8467258113712,0.832870850557241,0.959681656185743,0.780125972112637,0.763761890826489,0.71637100113153,0.973770306750174,0.91224167038109,0.931524843984547,0.827554553702832,0.98184120462524,0.9877360237486,0.933585914132837,0.927009161643336,0.987336489659084,0.924237550946878,0.956409613095595,0.989946895018987,0.953240014643784],[0.617837099118647,0.766432116418369,0.259734186939166,null,0.0935978284349419,0.864628687001585,0.729104203849662,null,0.952898580055158,0.867746839347729,null,null,0.832508330624274,0.943069700302037,null,0.803312693353353,0.785069736967061,0.98008006571572,0.879937349179347,0.923461975663859,0.904358519837102,0.83392927534814,0.929615276803012,0.961192528601108,0.883609304835375,0.936207294192685,0.73240735415312,0.951279948928537,0.912393179949521,0.818761845673151,0.853610552578022,0.921968697136937,0.0780190738386583,0.794481308796051,0.890461762229168,0.932321712766586,0.989449982430331,0.889405214161483,0.822165385850965,0.956250727260286,0.849809588276931,0.837179324120532,0.961339133117336,0.784390181860495,0.769296220797963,0.71997183352321,0.975193707347755,0.901305028717358,0.933563298995695,0.829568653950903,0.983102626719185,0.988895001204208,0.933813611838425,0.929110629771649,0.988502232326657,0.925741554212736,0.894177008098539,0.976124020638922,0.916231019231371]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_10suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-12-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="results-for-eas" class="section level1">
<h1>Results for EAS</h1>
<div id="number-of-supp_snp-3-1" class="section level2">
<h2>Number of supp_SNP &gt;=3</h2>
<div id="genes-8" class="section level3">
<h3>40 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_40genes_EAS.RDS&quot;))
  df_fdr02_3snp &lt;- df[df$FDR_3suppSNP &lt; 0.2,]
  df_fdr02_3snp &lt;- df_fdr02_3snp[complete.cases(df_fdr02_3snp$FDR_3suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_3snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_3suppSNP&quot;)]
df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_3suppSNP, decreasing = F),]

df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-97f4021d5afcf82a6acf" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-97f4021d5afcf82a6acf">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32"],["B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","T_cell","thymocyte","thymocyte"],["MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","PLT-ebi-a-GCST90018749","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","graves-ebi-a-GCST90018627","ATD-bbj-a-90","ATD-bbj-a-90","ATD-bbj-a-90","ATD-bbj-a-90","ATD-bbj-a-90","BMI-ebi-a-GCST90018727","BMI-ebi-a-GCST90018727","PLT-ebi-a-GCST90018749","RBC-ebi-a-GCST90018751","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","ATD-bbj-a-90","HCT-ebi-a-GCST90018740","graves-ebi-a-GCST90018627"],["04611_PC1","04611_PC3","04810_PC4","04921_PC4","05133_PC4","04650_PC5","04931_PC1","05200_PC1","04540_PC1","03015_PC3","04070_PC3","04110_PC1","04210_PC5","04310_PC5","04360_PC3","05016_PC5","04920_PC3","04640_PC4","04145_PC5","04360_PC3","04550_PC2","04935_PC3","05131_PC3","05135_PC5","05161_PC3","05163_PC3","05165_PC3","05167_PC3","05200_PC3","04726_PC2","05416_PC3","04120_PC3"],["04611","04611","04810","04921","05133","04650","04931","05200","04540","03015","04070","04110","04210","04310","04360","05016","04920","04640","04145","04360","04550","04935","05131","05135","05161","05163","05165","05167","05200","04726","05416","04120"],["Platelet activation","Platelet activation","Regulation of actin cytoskeleton","Oxytocin signaling pathway","Pertussis","Natural killer cell mediated cytotoxicity","Insulin resistance","Pathways in cancer","Gap junction","mRNA surveillance pathway","Phosphatidylinositol signaling system","Cell cycle","Apoptosis","Wnt signaling pathway","Axon guidance","Huntington disease","Adipocytokine signaling pathway","Hematopoietic cell lineage","Phagosome","Axon guidance","Signaling pathways regulating pluripotency of stem cells","Growth hormone synthesis, secretion and action","Shigellosis","Yersinia infection","Hepatitis B","Human cytomegalovirus infection","Human papillomavirus infection","Kaposi sarcoma-associated herpesvirus infection","Pathways in cancer","Serotonergic synapse","Viral myocarditis","Ubiquitin mediated proteolysis"],[4,8,5,6,4,3,7,5,3,5,5,3,4,4,5,5,3,4,3,6,11,8,11,4,6,7,12,14,7,3,3,3],[1.3e-05,5.6e-05,0.000107,0.000285,0.000162,0.000531,3.1e-05,0.000106,1e-06,0.000337,0.0012999,1e-06,0.0020998,0.0025997,0.000689,0.0011999,0.000783,0.000516,0.0019998,0.0012999,0.000672,1.4e-05,0.0025997,0.000272,1.3e-05,0.0010999,0.000215,1e-05,1.5e-05,1e-06,0.000291,1e-06],[124,124,213,153,76,134,108,531,88,91,99,124,136,160,181,264,69,99,152,181,140,119,236,120,162,225,330,186,531,115,60,136],[71,71,120,79,49,79,69,290,45,64,63,69,94,67,74,146,40,45,94,74,51,65,150,87,105,136,174,119,255,47,46,116],[0.022984,0.049504,0.0630586666666667,0.100776,0.071604,0.156468,0.0411215,0.0937393333333333,0.002653,0.06066,0.116991,0.00144,0.167984,0.1871784,0.0901963636363636,0.116991,0.09396,0.08256,0.167984,0.116991,0.0901963636363636,0.00432,0.1871784,0.0559542857142857,0.00432,0.116991,0.0516,0.00432,0.00432,0.001788,0.1622325,0.001115],["-0.15168824225987","-0.920969134117914","0.320301620905627","-0.77540583139736","0.0150353064483237","0.279771725173132","-0.0780203996195739","0.0289598358094416","0.0539890179126034","0/1snp","0/1snp","0.0183325927597965","0.0923308222252338","0/1snp","-0.523110577590398","0.568640271452703","-0.0372134391221124","0.11197758264511","0.700163060762805","-0.312450227158299","0.012336281274246","0.774097800142423","-0.140027545018815","-0.728097236630201","0.620471254657609","0.382195178073134","-0.628082585903604","-0.335320189440536","-0.924999067074685","0.0898139340555836","0.029330163151831","0.0525118011306324"],["0.623132316986754","0.107689727067654","0.479354160984548","0.0783774426584705","0.928583161753315","0.538940852290754","0.784298192893093","0.899252620378613","0.768543033462768","0/1snp","0/1snp","0.948864207841059","0.882872484023392","0/1snp","0.548349402716188","0.675589994882587","0.954538393838723","0.881629784022003","0.483051499160993","0.700367394570114","0.987883789277398","0.359173780334774","0.88745417970635","0.342856176416238","0.430496336025231","0.661729006909189","0.474956008235431","0.696464692880394","0.296237509071482","0.781269943759603","0.977977878614518","0.659161580155145"],[0.00422628946484368,0.0279252209431014,0.0506611805699573,0.0526401508171919,0.0133927613327637,0.0293371618476475,0.122148046599364,0.0808219112118159,0.0297795672975759,0.0542350332442725,0.0277911400816923,0.136555002449003,0.0044034381446732,0.00364195619233804,0.0585409800311946,0.0533963051390032,0.0198437393273243,0.0169330754637475,0.0100487498389807,0.052997096378917,0.03229183548432,0.0673565056094776,0.0471916446516859,0.101896305292874,0.0304048487894123,0.0250544558127775,0.0423330370944979,0.0383116998397796,0.0597815926194269,0.0170913717601809,0.0979366843764253,0.237162423122451],[0.00411505388604913,0.0270047993354425,0.0494325865568225,0.0519173559184584,0.0130593019695681,0.0288833778168307,0.117644521773953,0.0788072082470305,0.0289695009797513,0.100197511432074,0.0685909210822347,0.285577281828717,0.041671946757908,0.0029133169074164,0.0553232235933902,0.0507096389846649,0.0195219602850299,0.0162410969160012,0.00993243999206096,0.0523881198156982,0.0318470880441398,0.0665060816394443,0.0467323798339479,0.101034267049887,0.0300755448588738,0.0247674671484783,0.0417258717998787,0.0378847298603071,0.0590565051848416,0.0158474706437734,0.118568501196027,0.211030356596305],[0.940594059405941,0.841584158415842,0.910891089108911,0.712871287128713,0.920792079207921,0.871287128712871,0.544554455445545,0.475247524752475,0.861386138613861,0.831683168316832,0.930693069306931,0.782178217821782,1,0.97029702970297,0.772277227722772,0.722772277227723,0.910891089108911,0.900990099009901,0.940594059405941,0.673267326732673,0.613861386138614,0.415841584158416,0.554455445544555,0.683168316831683,0.633663366336634,0.772277227722772,0.514851485148515,0.603960396039604,0.386138613861386,0.95049504950495,0.683168316831683,0.495049504950495],[0.95049504950495,0.851485148514851,0.910891089108911,0.712871287128713,0.920792079207921,0.871287128712871,0.554455445544555,0.495049504950495,0.861386138613861,0.742574257425743,0.871287128712871,0.594059405940594,0.96039603960396,0.97029702970297,0.772277227722772,0.732673267326733,0.910891089108911,0.97029702970297,0.940594059405941,0.673267326732673,0.613861386138614,0.425742574257426,0.554455445544555,0.683168316831683,0.633663366336634,0.772277227722772,0.514851485148515,0.623762376237624,0.396039603960396,0.96039603960396,0.613861386138614,0.554455445544555],[0.976217238626057,0.872187037309788,0.785296238013659,0.778273036643127,0.933605165851427,0.867016534755545,0.530759307180861,0.648468332302807,0.896878649781299,0.887209470557697,0.932145258338227,0.771933855882078,0.982723551288925,0.985140551995302,0.824137666913473,0.837031174202773,0.92106450157871,0.936009055242083,0.946153649756172,0.771210457783338,0.85069063242015,0.721602369341538,0.792461340754547,0.620530889098816,0.858401205096127,0.880452081258883,0.811269691321776,0.826478072527042,0.74744895788121,0.958359096495447,0.711608404568305,0.58927730287797],[0.978240478755979,0.878093968263812,0.792133394314773,0.78347454670894,0.937062503391447,0.870698676754444,0.54512560972817,0.657773604781643,0.900809917481546,0.81950791908154,0.865218168356014,0.607305469740683,0.908085888630735,0.987540531569944,0.832078024867873,0.843924732555468,0.922707040791142,0.939328175930418,0.948485544803874,0.776146585986502,0.854784214602429,0.727355511867984,0.79702300405954,0.625781908239079,0.861899047667679,0.883745670249615,0.816044118773457,0.830435485655441,0.75274252985081,0.961038465355226,0.667933066153929,0.630427564265913],[0.978573608760251,0.886067102081652,0.8057355015988,0.799215143112002,0.941473558717086,0.880796755479862,0.551392952757177,0.657923805916975,0.851169715738239,0.830340940997323,0.903022628706601,0.654806027788773,0.979042317994873,0.982003252575666,0.819328454327813,0.832514082493738,0.927129991823824,0.936270564531076,0.958814271282876,0.833547288675251,0.889916674584364,0.797535473057178,0.848753314248488,0.720521988544832,0.895414609663226,0.911180909928707,0.861876310946915,0.872943120828031,0.816208597724049,0.926301593346341,0.647748170203455,0.420340595562871],[0.981090514094068,0.892177063931258,0.812769292474257,0.804538850978675,0.94520768301313,0.885219337113381,0.563722484456241,0.666399666300497,0.856820671484265,0.725822442772094,0.796281352481804,0.461754541740038,0.865286956506919,0.985769661913634,0.829123248928554,0.841111423084936,0.92946929843809,0.939745332783994,0.960373453972049,0.836764500995499,0.892685241086413,0.801336606644134,0.851607519695892,0.724081330582093,0.897834016385585,0.91347505371607,0.865131016934782,0.875665672374367,0.819700834617562,0.933808876781306,0.60360168287547,0.453984381251781]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_3suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-13-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="genes-9" class="section level3">
<h3>20 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_20genes_EAS.RDS&quot;))
  df_fdr02_3snp &lt;- df[df$FDR_3suppSNP &lt; 0.2,]
  df_fdr02_3snp &lt;- df_fdr02_3snp[complete.cases(df_fdr02_3snp$FDR_3suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_3snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_3suppSNP&quot;)]

df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_3suppSNP, decreasing = F),]


df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-5e55a5507ec837689bd0" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5e55a5507ec837689bd0">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38"],["B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","B_cell","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD14_positive_monocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","T_cell","T_cell","thymocyte"],["ATD-bbj-a-90","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","PLT-ebi-a-GCST90018749","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","graves-ebi-a-GCST90018627","height-ebi-a-GCST90018739","ATD-bbj-a-90","ATD-bbj-a-90","ATD-bbj-a-90","ATD-bbj-a-90","ATD-bbj-a-90","BMI-ebi-a-GCST90018727","BMI-ebi-a-GCST90018727","PLT-ebi-a-GCST90018749","PLT-ebi-a-GCST90018749","RBC-ebi-a-GCST90018751","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","ATD-bbj-a-90","graves-ebi-a-GCST90018627","graves-ebi-a-GCST90018627"],["05340_PC3","04611_PC1","04611_PC3","04810_PC4","04921_PC4","05133_PC4","05322_PC2","04650_PC5","04931_PC1","05200_PC1","04540_PC1","04979_PC5","03015_PC3","04070_PC3","04110_PC1","04210_PC5","04929_PC3","04360_PC3","05016_PC5","04727_PC1","04920_PC3","04640_PC4","00513_PC3","04145_PC5","04360_PC3","04550_PC2","04726_PC4","04935_PC3","04972_PC4","05135_PC5","05161_PC3","05163_PC3","05165_PC3","05167_PC3","05200_PC3","04726_PC2","00052_PC2","04120_PC3"],["05340","04611","04611","04810","04921","05133","05322","04650","04931","05200","04540","04979","03015","04070","04110","04210","04929","04360","05016","04727","04920","04640","00513","04145","04360","04550","04726","04935","04972","05135","05161","05163","05165","05167","05200","04726","00052","04120"],["Primary immunodeficiency","Platelet activation","Platelet activation","Regulation of actin cytoskeleton","Oxytocin signaling pathway","Pertussis","Systemic lupus erythematosus","Natural killer cell mediated cytotoxicity","Insulin resistance","Pathways in cancer","Gap junction","Cholesterol metabolism","mRNA surveillance pathway","Phosphatidylinositol signaling system","Cell cycle","Apoptosis","GnRH secretion","Axon guidance","Huntington disease","GABAergic synapse","Adipocytokine signaling pathway","Hematopoietic cell lineage","Various types of N-glycan biosynthesis","Phagosome","Axon guidance","Signaling pathways regulating pluripotency of stem cells","Serotonergic synapse","Growth hormone synthesis, secretion and action","Pancreatic secretion","Yersinia infection","Hepatitis B","Human cytomegalovirus infection","Human papillomavirus infection","Kaposi sarcoma-associated herpesvirus infection","Pathways in cancer","Serotonergic synapse","Galactose metabolism","Ubiquitin mediated proteolysis"],[3,4,8,5,6,4,3,3,7,5,3,3,5,5,3,4,3,5,5,3,3,4,11,3,6,11,6,8,6,4,6,7,12,14,7,3,3,3],[1e-06,1.3e-05,5.6e-05,0.000107,0.000285,0.000162,0.000593,0.000531,3.1e-05,0.000106,1e-06,6e-05,0.000337,0.0012999,1e-06,0.0020998,1e-06,0.000689,0.0011999,0.000322,0.000783,0.000516,0.0020998,0.0019998,0.0012999,0.000672,0.00039,1.4e-05,0.000369,0.000272,1.3e-05,0.0010999,0.000215,1e-05,1.5e-05,1e-06,1e-06,1e-06],[38,124,124,213,153,76,133,134,108,531,88,50,91,99,124,136,64,181,264,89,69,99,39,152,181,140,115,119,102,120,162,225,330,186,531,115,31,136],[28,71,71,120,79,49,33,79,69,290,45,23,64,63,69,94,27,74,146,31,40,45,24,94,74,51,39,65,35,87,105,136,174,119,255,47,21,116],[0.002413,0.0156845,0.0450426666666667,0.06454775,0.1146175,0.0781812,0.178863625,0.178863625,0.053072,0.090736,0.003424,0.06848,0.0630175,0.126025305,0.0009695,0.177022269565217,0.0009695,0.0890647333333334,0.126025305,0.0630175,0.0948898125,0.0769633846153846,0.177022269565217,0.177022269565217,0.126025305,0.0890647333333334,0.0630175,0.0048475,0.0630175,0.0630175,0.0048475,0.1254533,0.059555,0.0048475,0.0048475,0.0011925,0.0011925,0.001481],["0/1snp","-0.15168824225987","-0.920969134117914","0.320301620905627","-0.77540583139736","0.0150353064483237","0.363251356011162","0.279771725173132","-0.0780203996195739","0.0289598358094416","0.0539890179126034","-0.434576581558195","0/1snp","0/1snp","0.0183325927597965","0.0923308222252338","0/1snp","-0.523110577590398","0.568640271452703","-0.276183606182897","-0.0372134391221124","0.11197758264511","0.302813271864685","0.700163060762805","-0.312450227158299","0.012336281274246","0.0320183424815683","0.774097800142423","-0.0331521299069109","-0.728097236630201","0.620471254657609","0.382195178073134","-0.628082585903604","-0.335320189440536","-0.924999067074685","0.0898139340555836","-0.021459549571178","0.0525118011306324"],["0/1snp","0.623132316986754","0.107689727067654","0.479354160984548","0.0783774426584705","0.928583161753315","0.311464253860303","0.538940852290754","0.784298192893093","0.899252620378613","0.768543033462768","0.662466436471887","0/1snp","0/1snp","0.948864207841059","0.882872484023392","0/1snp","0.548349402716188","0.675589994882587","0.467814215138105","0.954538393838723","0.881629784022003","0.672074254887795","0.483051499160993","0.700367394570114","0.987883789277398","0.968750524709777","0.359173780334774","0.965903671216125","0.342856176416238","0.430496336025231","0.661729006909189","0.474956008235431","0.696464692880394","0.296237509071482","0.781269943759603","0.905921468923519","0.659161580155145"],[0.0304028385739504,0.00422628946484368,0.0279252209431014,0.0506611805699573,0.0526401508171919,0.0133927613327637,0.0708476155272192,0.0293371618476475,0.122148046599364,0.0808219112118159,0.0297795672975759,0.145171678054393,0.0542350332442725,0.0277911400816923,0.136555002449003,0.0044034381446732,0.0603209441938205,0.0585409800311946,0.0533963051390032,0.0245123102747074,0.0198437393273243,0.0169330754637475,0.0270835492269271,0.0100487498389807,0.052997096378917,0.03229183548432,0.00634496366002151,0.0673565056094776,0.0629621039809046,0.101896305292874,0.0304048487894123,0.0250544558127775,0.0423330370944979,0.0383116998397796,0.0597815926194269,0.0170913717601809,0.00800237709619663,0.237162423122451],[0.0251913049600743,0.00411505388604913,0.0270047993354425,0.0494325865568225,0.0519173559184584,0.0130593019695681,0.0692881290611548,0.0288833778168307,0.117644521773953,0.0788072082470305,0.0289695009797513,0.143728532590718,0.100197511432074,0.0685909210822347,0.285577281828717,0.041671946757908,0.578366395351993,0.0553232235933902,0.0507096389846649,0.0240421820238878,0.0195219602850299,0.0162410969160012,0.0267927179142319,0.00993243999206096,0.0523881198156982,0.0318470880441398,0.00627213631845125,0.0665060816394443,0.0625899972144637,0.101034267049887,0.0300755448588738,0.0247674671484783,0.0417258717998787,0.0378847298603071,0.0590565051848416,0.0158474706437734,0.481599032204449,0.211030356596305],[0.920792079207921,0.940594059405941,0.841584158415842,0.910891089108911,0.712871287128713,0.920792079207921,0.663366336633663,0.871287128712871,0.544554455445545,0.475247524752475,0.861386138613861,0.693069306930693,0.831683168316832,0.930693069306931,0.782178217821782,1,0.861386138613861,0.772277227722772,0.722772277227723,0.881188118811881,0.910891089108911,0.900990099009901,0.851485148514851,0.940594059405941,0.673267326732673,0.613861386138614,0.98019801980198,0.415841584158416,0.712871287128713,0.683168316831683,0.633663366336634,0.772277227722772,0.514851485148515,0.603960396039604,0.386138613861386,0.95049504950495,0.99009900990099,0.495049504950495],[0.930693069306931,0.95049504950495,0.851485148514851,0.910891089108911,0.712871287128713,0.920792079207921,0.693069306930693,0.871287128712871,0.554455445544555,0.495049504950495,0.861386138613861,0.693069306930693,0.742574257425743,0.871287128712871,0.594059405940594,0.96039603960396,0.326732673267327,0.772277227722772,0.732673267326733,0.881188118811881,0.910891089108911,0.97029702970297,0.861386138613861,0.940594059405941,0.673267326732673,0.613861386138614,0.98019801980198,0.425742574257426,0.712871287128713,0.683168316831683,0.633663366336634,0.772277227722772,0.514851485148515,0.623762376237624,0.396039603960396,0.96039603960396,0.386138613861386,0.554455445544555],[0.922628506755762,0.976217238626057,0.872187037309788,0.785296238013659,0.778273036643127,0.933605165851427,0.717358780164495,0.867016534755545,0.530759307180861,0.648468332302807,0.896878649781299,0.358134670727704,0.887209470557697,0.932145258338227,0.771933855882078,0.982723551288925,0.87784784810342,0.824137666913473,0.837031174202773,0.905966757729721,0.92106450157871,0.936009055242083,0.871771304074008,0.946153649756172,0.771210457783338,0.85069063242015,0.963583288652863,0.721602369341538,0.736836282244406,0.620530889098816,0.858401205096127,0.880452081258883,0.811269691321776,0.826478072527042,0.74744895788121,0.958359096495447,0.967275058969016,0.58927730287797],[0.933225323834699,0.978240478755979,0.878093968263812,0.792133394314773,0.78347454670894,0.937062503391447,0.724986628010636,0.870698676754444,0.54512560972817,0.657773604781643,0.900809917481546,0.364371264341494,0.81950791908154,0.865218168356014,0.607305469740683,0.908085888630735,0.343843882179726,0.832078024867873,0.843924732555468,0.907856103352312,0.922707040791142,0.939328175930418,0.875294678343163,0.948485544803874,0.776146585986502,0.854784214602429,0.965566250499996,0.727355511867984,0.740734121411733,0.625781908239079,0.861899047667679,0.883745670249615,0.816044118773457,0.830435485655441,0.75274252985081,0.961038465355226,0.352004946527126,0.630427564265913],[0.87688566582537,0.978573608760251,0.886067102081652,0.8057355015988,0.799215143112002,0.941473558717086,0.742326019476668,0.880796755479862,0.551392952757177,0.657923805916975,0.851169715738239,0.506179956590785,0.830340940997323,0.903022628706601,0.654806027788773,0.979042317994873,0.8148490262085,0.819328454327813,0.832514082493738,0.912819766661568,0.927129991823824,0.936270564531076,0.905119504674566,0.958814271282876,0.833547288675251,0.889916674584364,0.97180689227345,0.797535473057178,0.808269313605983,0.720521988544832,0.895414609663226,0.911180909928707,0.861876310946915,0.872943120828031,0.816208597724049,0.926301593346341,0.96226638980665,0.420340595562871],[0.89892056952575,0.981090514094068,0.892177063931258,0.812769292474257,0.804538850978675,0.94520768301313,0.749997040875311,0.885219337113381,0.563722484456241,0.666399666300497,0.856820671484265,0.511169398547918,0.725822442772094,0.796281352481804,0.461754541740038,0.865286956506919,0.250206534720201,0.829123248928554,0.841111423084936,0.915653734049746,0.92946929843809,0.939745332783994,0.907421104589012,0.960373453972049,0.836764500995499,0.892685241086413,0.973126839799358,0.801336606644134,0.810865750088515,0.724081330582093,0.897834016385585,0.91347505371607,0.865131016934782,0.875665672374367,0.819700834617562,0.933808876781306,0.254909236754104,0.453984381251781]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_3suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-14-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="number-of-supp_snp-5-1" class="section level2">
<h2>Number of supp_SNP &gt;=5</h2>
<div id="genes-10" class="section level3">
<h3>40 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_40genes_EAS.RDS&quot;))
  df_fdr02_5snp &lt;- df[df$FDR_5suppSNP &lt; 0.2,]
  df_fdr02_5snp &lt;- df_fdr02_5snp[complete.cases(df_fdr02_5snp$FDR_5suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_5snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_5suppSNP&quot;)]
df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_5suppSNP, decreasing = F),]

df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-cfcd02e72ac20b8c76de" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cfcd02e72ac20b8c76de">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28"],["B_cell","B_cell","B_cell","CD14_positive_monocyte","CD14_positive_monocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte"],["MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","ATD-bbj-a-90","ATD-bbj-a-90","ATD-bbj-a-90","ATD-bbj-a-90","BMI-ebi-a-GCST90018727","BMI-ebi-a-GCST90018727","BMI-ebi-a-GCST90018727","RA-bbj-a-151","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739"],["04611_PC3","04810_PC4","04921_PC4","04931_PC1","05200_PC1","03015_PC3","04070_PC3","04150_PC3","04910_PC3","04151_PC4","04360_PC3","05016_PC5","04750_PC3","04110_PC3","04150_PC3","04151_PC4","04261_PC3","04360_PC3","04550_PC2","04630_PC2","04935_PC3","05131_PC3","05161_PC3","05163_PC3","05165_PC3","05167_PC3","05200_PC3","05226_PC3"],["04611","04810","04921","04931","05200","03015","04070","04150","04910","04151","04360","05016","04750","04110","04150","04151","04261","04360","04550","04630","04935","05131","05161","05163","05165","05167","05200","05226"],["Platelet activation","Regulation of actin cytoskeleton","Oxytocin signaling pathway","Insulin resistance","Pathways in cancer","mRNA surveillance pathway","Phosphatidylinositol signaling system","mTOR signaling pathway","Insulin signaling pathway","PI3K-Akt signaling pathway","Axon guidance","Huntington disease","Inflammatory mediator regulation of TRP channels","Cell cycle","mTOR signaling pathway","PI3K-Akt signaling pathway","Adrenergic signaling in cardiomyocytes","Axon guidance","Signaling pathways regulating pluripotency of stem cells","JAK-STAT signaling pathway","Growth hormone synthesis, secretion and action","Shigellosis","Hepatitis B","Human cytomegalovirus infection","Human papillomavirus infection","Kaposi sarcoma-associated herpesvirus infection","Pathways in cancer","Gastric cancer"],[8,5,6,7,5,5,5,5,5,10,5,5,5,9,6,12,5,6,11,7,8,11,6,7,12,14,7,9],[5.6e-05,0.000107,0.000285,3.1e-05,0.000106,0.000337,0.0012999,0.0089991,0.0077992,0.0081992,0.000689,0.0011999,0.0077992,0.0049995,0.0038996,0.0078992,0.0043996,0.0012999,0.000672,0.0037996,1.4e-05,0.0025997,1.3e-05,0.0010999,0.000215,1e-05,1.5e-05,0.0063994],[124,213,153,108,531,91,99,153,137,354,181,264,100,124,153,354,149,181,140,162,119,236,162,225,330,186,531,149],[71,120,79,69,290,64,63,81,87,156,74,146,47,69,81,156,70,74,51,73,65,150,105,136,174,119,255,60],[0.0440305,0.0440305,0.078185,0.040455,0.069165,0.0258928333333333,0.049937825,0.180373265217391,0.171810509090909,0.171810509090909,0.039703625,0.049937825,0.171810509090909,0.135574676470588,0.119847706666667,0.171810509090909,0.126763475,0.049937825,0.039703625,0.119847706666667,0.00172875,0.0921893615384615,0.00172875,0.049937825,0.019823,0.00172875,0.00172875,0.163895744444444],["-0.920969134117914","0.320301620905627","-0.77540583139736","-0.0780203996195739","0.0289598358094416","0/1snp","0/1snp","0/1snp","0/1snp","0.380136725276964","-0.523110577590398","0.568640271452703","0.0504123419360684","0.828820548905881","0.86014429611751","-0.395194415278412","-0.579958541338593","-0.312450227158299","0.012336281274246","-0.0676601639868393","0.774097800142423","-0.140027545018815","0.620471254657609","0.382195178073134","-0.628082585903604","-0.335320189440536","-0.924999067074685","-0.763514895581253"],["0.107689727067654","0.479354160984548","0.0783774426584705","0.784298192893093","0.899252620378613","0/1snp","0/1snp","0/1snp","0/1snp","0.807294644487019","0.548349402716188","0.675589994882587","0.595598480652005","0.298773729511107","0.312849596924828","0.60041055366391","0.585654893451985","0.700367394570114","0.987883789277398","0.933647714663954","0.359173780334774","0.88745417970635","0.430496336025231","0.661729006909189","0.474956008235431","0.696464692880394","0.296237509071482","0.367999370227373"],[0.0279252209431014,0.0506611805699573,0.0526401508171919,0.122148046599364,0.0808219112118159,0.0542350332442725,0.0277911400816923,null,null,null,0.0585409800311946,0.0533963051390032,null,0.999999999999993,0.0471716828054059,null,0.0201153798522392,0.052997096378917,0.03229183548432,0.999999999999993,0.0673565056094776,0.0471916446516859,0.0304048487894123,0.0250544558127775,0.0423330370944979,0.0383116998397796,0.0597815926194269,null],[0.0270047993354425,0.0494325865568225,0.0519173559184584,0.117644521773953,0.0788072082470305,0.100197511432074,0.0685909210822347,null,null,null,0.0553232235933902,0.0507096389846649,null,0.999999999999993,0.046616129297107,null,0.0198413001645519,0.0523881198156982,0.0318470880441398,0.999999999999993,0.0665060816394443,0.0467323798339479,0.0300755448588738,0.0247674671484783,0.0417258717998787,0.0378847298603071,0.0590565051848416,null],[0.841584158415842,0.910891089108911,0.712871287128713,0.544554455445545,0.475247524752475,0.831683168316832,0.930693069306931,null,null,null,0.772277227722772,0.722772277227723,null,0.0396039603960396,0.693069306930693,null,0.861386138613861,0.673267326732673,0.613861386138614,0.0099009900990099,0.415841584158416,0.554455445544555,0.633663366336634,0.772277227722772,0.514851485148515,0.603960396039604,0.386138613861386,null],[0.851485148514851,0.910891089108911,0.712871287128713,0.554455445544555,0.495049504950495,0.742574257425743,0.871287128712871,null,null,null,0.772277227722772,0.732673267326733,null,0.0396039603960396,0.693069306930693,null,0.861386138613861,0.673267326732673,0.613861386138614,0.0099009900990099,0.425742574257426,0.554455445544555,0.633663366336634,0.772277227722772,0.514851485148515,0.623762376237624,0.396039603960396,null],[0.872187037309788,0.785296238013659,0.778273036643127,0.530759307180861,0.648468332302807,0.887209470557697,0.932145258338227,null,null,null,0.824137666913473,0.837031174202773,null,0.0141786027352959,0.792529425281487,null,0.901354031029523,0.771210457783338,0.85069063242015,0.0141786027352959,0.721602369341538,0.792461340754547,0.858401205096127,0.880452081258883,0.811269691321776,0.826478072527042,0.74744895788121,null],[0.878093968263812,0.792133394314773,0.78347454670894,0.54512560972817,0.657773604781643,0.81950791908154,0.865218168356014,null,null,null,0.832078024867873,0.843924732555468,null,0.0141190287742232,0.797491085182254,null,0.904690172849593,0.776146585986502,0.854784214602429,0.0141190287742232,0.727355511867984,0.79702300405954,0.861899047667679,0.883745670249615,0.816044118773457,0.830435485655441,0.75274252985081,null],[0.886067102081652,0.8057355015988,0.799215143112002,0.551392952757177,0.657923805916975,0.830340940997323,0.903022628706601,null,null,null,0.819328454327813,0.832514082493738,null,0.00346092115976435,0.848800394365213,null,0.926273389338079,0.833547288675251,0.889916674584364,0.00346092115976435,0.797535473057178,0.848753314248488,0.895414609663226,0.911180909928707,0.861876310946915,0.872943120828031,0.816208597724049,null],[0.892177063931258,0.812769292474257,0.804538850978675,0.563722484456241,0.666399666300497,0.725822442772094,0.796281352481804,null,null,null,0.829123248928554,0.841111423084936,null,0.00326727488780659,0.851916416389334,null,0.928475716246219,0.836764500995499,0.892685241086413,0.00326727488780659,0.801336606644134,0.851607519695892,0.897834016385585,0.91347505371607,0.865131016934782,0.875665672374367,0.819700834617562,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_5suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-15-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="genes-11" class="section level3">
<h3>20 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_20genes_EAS.RDS&quot;))
  df_fdr02_5snp &lt;- df[df$FDR_5suppSNP &lt; 0.2,]
  df_fdr02_5snp &lt;- df_fdr02_5snp[complete.cases(df_fdr02_5snp$FDR_5suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_5snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_5suppSNP&quot;)]

df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_5suppSNP, decreasing = F),]


df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-41da174dda42004a74af" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-41da174dda42004a74af">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33"],["B_cell","B_cell","B_cell","B_cell","CD14_positive_monocyte","CD14_positive_monocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte"],["MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","WBC-ebi-a-GCST90018758","MCV-ebi-a-GCST90018746","MCV-ebi-a-GCST90018746","ATD-bbj-a-90","ATD-bbj-a-90","ATD-bbj-a-90","ATD-bbj-a-90","BMI-ebi-a-GCST90018727","BMI-ebi-a-GCST90018727","BMI-ebi-a-GCST90018727","RA-bbj-a-151","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739"],["04611_PC3","04810_PC4","04921_PC4","00270_PC2","04931_PC1","05200_PC1","03015_PC3","04070_PC3","04150_PC3","04910_PC3","04151_PC4","04360_PC3","05016_PC5","04750_PC3","00513_PC3","04110_PC3","04150_PC3","04151_PC4","04261_PC3","04360_PC3","04550_PC2","04630_PC2","04726_PC4","04730_PC4","04935_PC3","04972_PC4","05131_PC3","05161_PC3","05163_PC3","05165_PC3","05167_PC3","05200_PC3","05226_PC3"],["04611","04810","04921","00270","04931","05200","03015","04070","04150","04910","04151","04360","05016","04750","00513","04110","04150","04151","04261","04360","04550","04630","04726","04730","04935","04972","05131","05161","05163","05165","05167","05200","05226"],["Platelet activation","Regulation of actin cytoskeleton","Oxytocin signaling pathway","Cysteine and methionine metabolism","Insulin resistance","Pathways in cancer","mRNA surveillance pathway","Phosphatidylinositol signaling system","mTOR signaling pathway","Insulin signaling pathway","PI3K-Akt signaling pathway","Axon guidance","Huntington disease","Inflammatory mediator regulation of TRP channels","Various types of N-glycan biosynthesis","Cell cycle","mTOR signaling pathway","PI3K-Akt signaling pathway","Adrenergic signaling in cardiomyocytes","Axon guidance","Signaling pathways regulating pluripotency of stem cells","JAK-STAT signaling pathway","Serotonergic synapse","Long-term depression","Growth hormone synthesis, secretion and action","Pancreatic secretion","Shigellosis","Hepatitis B","Human cytomegalovirus infection","Human papillomavirus infection","Kaposi sarcoma-associated herpesvirus infection","Pathways in cancer","Gastric cancer"],[8,5,6,9,7,5,5,5,5,5,10,5,5,5,11,9,6,12,5,6,11,7,6,8,8,6,11,6,7,12,14,7,9],[5.6e-05,0.000107,0.000285,0.000762,3.1e-05,0.000106,0.000337,0.0012999,0.0089991,0.0077992,0.0081992,0.000689,0.0011999,0.0077992,0.0020998,0.0049995,0.0038996,0.0078992,0.0043996,0.0012999,0.000672,0.0037996,0.00039,0.0044996,1.4e-05,0.000369,0.0025997,1.3e-05,0.0010999,0.000215,1e-05,1.5e-05,0.0063994],[124,213,153,49,108,531,91,99,153,137,354,181,264,100,39,124,153,354,149,181,140,162,115,60,119,102,236,162,225,330,186,531,149],[71,120,79,32,69,290,64,63,81,87,156,74,146,47,24,69,81,156,70,74,51,73,39,28,65,35,150,105,136,174,119,255,60],[0.056068,0.056068,0.09956,0.199644,0.049445,0.084535,0.02886,0.0549672,0.1973136,0.186689476923077,0.186689476923077,0.0407888,0.0549672,0.186689476923077,0.0828721066666667,0.140938285714286,0.128253511111111,0.186689476923077,0.13318816,0.0549672,0.0407888,0.128253511111111,0.02886,0.13318816,0.00222,0.02886,0.0961889,0.00222,0.0549672,0.025456,0.00222,0.00222,0.172202036363636],["-0.920969134117914","0.320301620905627","-0.77540583139736","0.431538751405459","-0.0780203996195739","0.0289598358094416","0/1snp","0/1snp","0/1snp","0/1snp","0.380136725276964","-0.523110577590398","0.568640271452703","0.0504123419360684","0.302813271864685","0.828820548905881","0.86014429611751","-0.395194415278412","-0.579958541338593","-0.312450227158299","0.012336281274246","-0.0676601639868393","0.0320183424815683","0.421358059436136","0.774097800142423","-0.0331521299069109","-0.140027545018815","0.620471254657609","0.382195178073134","-0.628082585903604","-0.335320189440536","-0.924999067074685","-0.763514895581253"],["0.107689727067654","0.479354160984548","0.0783774426584705","0.642968949046111","0.784298192893093","0.899252620378613","0/1snp","0/1snp","0/1snp","0/1snp","0.807294644487019","0.548349402716188","0.675589994882587","0.595598480652005","0.672074254887795","0.298773729511107","0.312849596924828","0.60041055366391","0.585654893451985","0.700367394570114","0.987883789277398","0.933647714663954","0.968750524709777","0.523797160148899","0.359173780334774","0.965903671216125","0.88745417970635","0.430496336025231","0.661729006909189","0.474956008235431","0.696464692880394","0.296237509071482","0.367999370227373"],[0.0279252209431014,0.0506611805699573,0.0526401508171919,0.0697099140053748,0.122148046599364,0.0808219112118159,0.0542350332442725,0.0277911400816923,null,null,null,0.0585409800311946,0.0533963051390032,null,0.0270835492269271,0.999999999999993,0.0471716828054059,null,0.0201153798522392,0.052997096378917,0.03229183548432,0.999999999999993,0.00634496366002151,0.0678296564760398,0.0673565056094776,0.0629621039809046,0.0471916446516859,0.0304048487894123,0.0250544558127775,0.0423330370944979,0.0383116998397796,0.0597815926194269,null],[0.0270047993354425,0.0494325865568225,0.0519173559184584,0.0664139410148262,0.117644521773953,0.0788072082470305,0.100197511432074,0.0685909210822347,null,null,null,0.0553232235933902,0.0507096389846649,null,0.0267927179142319,0.999999999999993,0.046616129297107,null,0.0198413001645519,0.0523881198156982,0.0318470880441398,0.999999999999993,0.00627213631845125,0.0668915419350639,0.0665060816394443,0.0625899972144637,0.0467323798339479,0.0300755448588738,0.0247674671484783,0.0417258717998787,0.0378847298603071,0.0590565051848416,null],[0.841584158415842,0.910891089108911,0.712871287128713,0.742574257425743,0.544554455445545,0.475247524752475,0.831683168316832,0.930693069306931,null,null,null,0.772277227722772,0.722772277227723,null,0.851485148514851,0.0396039603960396,0.693069306930693,null,0.861386138613861,0.673267326732673,0.613861386138614,0.0099009900990099,0.98019801980198,0.732673267326733,0.415841584158416,0.712871287128713,0.554455445544555,0.633663366336634,0.772277227722772,0.514851485148515,0.603960396039604,0.386138613861386,null],[0.851485148514851,0.910891089108911,0.712871287128713,0.742574257425743,0.554455445544555,0.495049504950495,0.742574257425743,0.871287128712871,null,null,null,0.772277227722772,0.732673267326733,null,0.861386138613861,0.0396039603960396,0.693069306930693,null,0.861386138613861,0.673267326732673,0.613861386138614,0.0099009900990099,0.98019801980198,0.732673267326733,0.425742574257426,0.712871287128713,0.554455445544555,0.633663366336634,0.772277227722772,0.514851485148515,0.623762376237624,0.396039603960396,null],[0.872187037309788,0.785296238013659,0.778273036643127,0.770970767668468,0.530759307180861,0.648468332302807,0.887209470557697,0.932145258338227,null,null,null,0.824137666913473,0.837031174202773,null,0.871771304074008,0.0141786027352959,0.792529425281487,null,0.901354031029523,0.771210457783338,0.85069063242015,0.0141786027352959,0.963583288652863,0.720172594275793,0.721602369341538,0.736836282244406,0.792461340754547,0.858401205096127,0.880452081258883,0.811269691321776,0.826478072527042,0.74744895788121,null],[0.878093968263812,0.792133394314773,0.78347454670894,0.782753622064945,0.54512560972817,0.657773604781643,0.81950791908154,0.865218168356014,null,null,null,0.832078024867873,0.843924732555468,null,0.875294678343163,0.0141190287742232,0.797491085182254,null,0.904690172849593,0.776146585986502,0.854784214602429,0.0141190287742232,0.965566250499996,0.726053395290253,0.727355511867984,0.740734121411733,0.79702300405954,0.861899047667679,0.883745670249615,0.816044118773457,0.830435485655441,0.75274252985081,null],[0.886067102081652,0.8057355015988,0.799215143112002,0.745714750858195,0.551392952757177,0.657923805916975,0.830340940997323,0.903022628706601,null,null,null,0.819328454327813,0.832514082493738,null,0.905119504674566,0.00346092115976435,0.848800394365213,null,0.926273389338079,0.833547288675251,0.889916674584364,0.00346092115976435,0.97180689227345,0.796396602903288,0.797535473057178,0.808269313605983,0.848753314248488,0.895414609663226,0.911180909928707,0.861876310946915,0.872943120828031,0.816208597724049,null],[0.892177063931258,0.812769292474257,0.804538850978675,0.758553665230052,0.563722484456241,0.666399666300497,0.725822442772094,0.796281352481804,null,null,null,0.829123248928554,0.841111423084936,null,0.907421104589012,0.00326727488780659,0.851916416389334,null,0.928475716246219,0.836764500995499,0.892685241086413,0.00326727488780659,0.973126839799358,0.800383926635118,0.801336606644134,0.810865750088515,0.851607519695892,0.897834016385585,0.91347505371607,0.865131016934782,0.875665672374367,0.819700834617562,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_5suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-16-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="number-of-supp_snp-10-1" class="section level2">
<h2>Number of supp_SNP &gt;=10</h2>
<div id="genes-12" class="section level3">
<h3>40 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_40genes_EAS.RDS&quot;))
  df_fdr02_10snp &lt;- df[df$FDR_10suppSNP &lt; 0.2,]
  df_fdr02_10snp &lt;- df_fdr02_10snp[complete.cases(df_fdr02_10snp$FDR_10suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_10snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_10suppSNP&quot;)]
df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_10suppSNP, decreasing = F),]

df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-6019ee703e4f0db556d3" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6019ee703e4f0db556d3">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11"],["CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","thymocyte","thymocyte","thymocyte"],["BMI-ebi-a-GCST90018727","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","BMI-ebi-a-GCST90018727","BMI-ebi-a-GCST90018727","height-ebi-a-GCST90018739"],["04151_PC4","04120_PC2","04151_PC4","04550_PC2","05131_PC3","05165_PC3","05167_PC3","05231_PC4","04024_PC2","05163_PC2","04110_PC3"],["04151","04120","04151","04550","05131","05165","05167","05231","04024","05163","04110"],["PI3K-Akt signaling pathway","Ubiquitin mediated proteolysis","PI3K-Akt signaling pathway","Signaling pathways regulating pluripotency of stem cells","Shigellosis","Human papillomavirus infection","Kaposi sarcoma-associated herpesvirus infection","Choline metabolism in cancer","cAMP signaling pathway","Human cytomegalovirus infection","Cell cycle"],[10,10,12,11,11,12,14,11,10,12,15],[0.0081992,0.030297,0.0078992,0.000672,0.0025997,0.000215,1e-05,0.0227977,0.0048995,0.0092991,0.0018998],[354,136,354,140,236,330,186,98,216,225,124],[156,96,156,51,150,174,119,55,94,152,90],[0.0505617333333333,0.140123625,0.0505617333333333,0.008288,0.024047225,0.0039775,0.00037,0.120502128571429,0.12003775,0.1518853,0.0930902],["0.380136725276964",null,"-0.395194415278412","0.012336281274246","-0.140027545018815","-0.628082585903604","-0.335320189440536",null,"-0.164323329357107","0.151976058031323","-0.283206633797634"],["0.807294644487019",null,"0.60041055366391","0.987883789277398","0.88745417970635","0.474956008235431","0.696464692880394",null,"0.818176143164153","0.866328678217052","0.823719233402456"],[null,null,null,0.03229183548432,0.0471916446516859,0.0423330370944979,0.0383116998397796,null,0.0841540137906987,null,0.00326842890030014],[null,null,null,0.0318470880441398,0.0467323798339479,0.0417258717998787,0.0378847298603071,null,0.0879200662272619,null,0.00323369837504318],[null,null,null,0.613861386138614,0.554455445544555,0.514851485148515,0.603960396039604,null,0.603960396039604,null,0.97029702970297],[null,null,null,0.613861386138614,0.554455445544555,0.514851485148515,0.623762376237624,null,0.594059405940594,null,0.97029702970297],[null,null,null,0.85069063242015,0.792461340754547,0.811269691321776,0.826478072527042,null,0.703029320236909,null,0.976247287665732],[null,null,null,0.854784214602429,0.79702300405954,0.816044118773457,0.830435485655441,null,0.695276484351472,null,0.978170052740906],[null,null,null,0.889916674584364,0.848753314248488,0.861876310946915,0.872943120828031,null,0.683594322324852,null,0.97888287407853],[null,null,null,0.892685241086413,0.851607519695892,0.865131016934782,0.875665672374367,null,0.676497035097533,null,0.980277474202314]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_10suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-17-2.png" width="768" style="display: block; margin: auto;" /></p>
</div>
<div id="genes-13" class="section level3">
<h3>20 genes</h3>
<pre class="r"><code>df_all_FDR02 &lt;- c()
for (celltype in celltypes){

  df &lt;- readRDS(paste0(folder_ect,celltype,&quot;_ECT_summary_20genes_EAS.RDS&quot;))
  df_fdr02_10snp &lt;- df[df$FDR_10suppSNP &lt; 0.2,]
  df_fdr02_10snp &lt;- df_fdr02_10snp[complete.cases(df_fdr02_10snp$FDR_10suppSNP),]

  df_all_FDR02 &lt;- rbind(df_all_FDR02,df_fdr02_10snp)
}

df_all_FDR02 &lt;-  df_all_FDR02[c(&quot;celltype&quot;,&quot;trait&quot;,&quot;factor&quot;,&quot;pathwayID&quot;,&quot;pathwayName&quot;,&quot;num_supp_SNP&quot;, &quot;p_ECT&quot; ,
                                &quot;n_genes_inpathway&quot;,&quot;n_genes_expressed&quot;,&quot;FDR_10suppSNP&quot;)]

df_all_FDR02 &lt;- df_all_FDR02[order(df_all_FDR02$FDR_10suppSNP, decreasing = F),]


df_all_FDR02$celltype &lt;- celltypes[df_all_FDR02$celltype]
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02,
  ECT_summary_MBEadded_all[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;mbe_reverse_pair&quot;,
                                               &quot;mbe_pval_reverse_pair&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)
df_all_FDR02_merged &lt;- merge(
  df_all_FDR02_merged,
  ECT_summary_allcelltypes_ACATadded_p0005[, c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;, &quot;acat_p&quot;,
                                               &quot;acat_p_MHCremoved&quot;, &quot;acat_p_correct_pairnull&quot;,
                                               &quot;acat_p_correct_noMHC_pairnull&quot;, &quot;acat_p_correct_traitnull&quot;,
                                               &quot;acat_p_correct_noMHC_traitnull&quot;, &quot;acat_p_correct_globalnull&quot;,
                                               &quot;acat_p_correct_noMHC_globalnull&quot;)],
  by = c(&quot;celltype&quot;, &quot;trait&quot;, &quot;factor&quot;, &quot;pathwayID&quot;),
  all.x = TRUE
)


DT::datatable(df_all_FDR02_merged,caption = htmltools::tags$caption( style = &#39;caption-side: left; text-align: left; color:black;  font-size:150% ;&#39;,&#39;significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)&#39;),options = list(pageLength = 10) )</code></pre>
<div id="htmlwidget-009dd5a4a2833e3f56ce" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-009dd5a4a2833e3f56ce">{"x":{"filter":"none","vertical":false,"caption":"<caption style=\"caption-side: left; text-align: left; color:black;  font-size:150% ;\">significant pairs at FDR &lt; 0.2 (Supp SNP &gt;=3)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14"],["CD14_positive_monocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","CD15_positive_leukocyte","thymocyte","thymocyte","thymocyte"],["MCV-ebi-a-GCST90018746","BMI-ebi-a-GCST90018727","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","height-ebi-a-GCST90018739","BMI-ebi-a-GCST90018727","BMI-ebi-a-GCST90018727","height-ebi-a-GCST90018739"],["00270_PC1","04151_PC4","00513_PC3","04120_PC2","04151_PC4","04550_PC2","04929_PC3","05131_PC3","05165_PC3","05167_PC3","05231_PC4","04024_PC2","05163_PC2","04110_PC3"],["00270","04151","00513","04120","04151","04550","04929","05131","05165","05167","05231","04024","05163","04110"],["Cysteine and methionine metabolism","PI3K-Akt signaling pathway","Various types of N-glycan biosynthesis","Ubiquitin mediated proteolysis","PI3K-Akt signaling pathway","Signaling pathways regulating pluripotency of stem cells","GnRH secretion","Shigellosis","Human papillomavirus infection","Kaposi sarcoma-associated herpesvirus infection","Choline metabolism in cancer","cAMP signaling pathway","Human cytomegalovirus infection","Cell cycle"],[11,10,11,10,12,11,10,11,12,14,11,10,12,15],[0.000628,0.0081992,0.0020998,0.030297,0.0078992,0.000672,0.0133987,0.0025997,0.000215,1e-05,0.0227977,0.0048995,0.0092991,0.0018998],[49,354,39,136,354,140,64,236,330,186,98,216,225,124],[33,156,24,96,156,51,27,150,174,119,55,94,152,90],[0.162024,0.0550517714285714,0.02443718,0.1423959,0.0550517714285714,0.010528,0.0787173625,0.02443718,0.0050525,0.00047,0.119054655555556,0.12983675,0.1642841,0.1006894],["0.0383278240687357","0.380136725276964","0.302813271864685",null,"-0.395194415278412","0.012336281274246",null,"-0.140027545018815","-0.628082585903604","-0.335320189440536",null,"-0.164323329357107","0.151976058031323","-0.283206633797634"],["0.799878518152447","0.807294644487019","0.672074254887795",null,"0.60041055366391","0.987883789277398",null,"0.88745417970635","0.474956008235431","0.696464692880394",null,"0.818176143164153","0.866328678217052","0.823719233402456"],[0.058793713486354,null,0.0270835492269271,null,null,0.03229183548432,null,0.0471916446516859,0.0423330370944979,0.0383116998397796,null,0.0841540137906987,null,0.00326842890030014],[0.0574259856046484,null,0.0267927179142319,null,null,0.0318470880441398,null,0.0467323798339479,0.0417258717998787,0.0378847298603071,null,0.0879200662272619,null,0.00323369837504318],[0.732673267326733,null,0.851485148514851,null,null,0.613861386138614,null,0.554455445544555,0.514851485148515,0.603960396039604,null,0.603960396039604,null,0.97029702970297],[0.752475247524752,null,0.861386138613861,null,null,0.613861386138614,null,0.554455445544555,0.514851485148515,0.623762376237624,null,0.594059405940594,null,0.97029702970297],[0.726368501003809,null,0.871771304074008,null,null,0.85069063242015,null,0.792461340754547,0.811269691321776,0.826478072527042,null,0.703029320236909,null,0.976247287665732],[0.734383706994603,null,0.875294678343163,null,null,0.854784214602429,null,0.79702300405954,0.816044118773457,0.830435485655441,null,0.695276484351472,null,0.978170052740906],[0.731967873588575,null,0.905119504674566,null,null,0.889916674584364,null,0.848753314248488,0.861876310946915,0.872943120828031,null,0.683594322324852,null,0.97888287407853],[0.739183189065876,null,0.907421104589012,null,null,0.892685241086413,null,0.851607519695892,0.865131016934782,0.875665672374367,null,0.676497035097533,null,0.980277474202314]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>celltype<\/th>\n      <th>trait<\/th>\n      <th>factor<\/th>\n      <th>pathwayID<\/th>\n      <th>pathwayName<\/th>\n      <th>num_supp_SNP<\/th>\n      <th>p_ECT<\/th>\n      <th>n_genes_inpathway<\/th>\n      <th>n_genes_expressed<\/th>\n      <th>FDR_10suppSNP<\/th>\n      <th>mbe_reverse_pair<\/th>\n      <th>mbe_pval_reverse_pair<\/th>\n      <th>acat_p<\/th>\n      <th>acat_p_MHCremoved<\/th>\n      <th>acat_p_correct_pairnull<\/th>\n      <th>acat_p_correct_noMHC_pairnull<\/th>\n      <th>acat_p_correct_traitnull<\/th>\n      <th>acat_p_correct_noMHC_traitnull<\/th>\n      <th>acat_p_correct_globalnull<\/th>\n      <th>acat_p_correct_noMHC_globalnull<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":10,"columnDefs":[{"className":"dt-right","targets":[6,7,8,9,10,13,14,15,16,17,18,19,20]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<pre class="r"><code>df_all_FDR02_merged$mbe_pval_reverse_pair_num &lt;- suppressWarnings(
  as.numeric(df_all_FDR02_merged$mbe_pval_reverse_pair)
)
df_all_FDR02_merged &lt;- df_all_FDR02_merged[complete.cases(df_all_FDR02_merged$mbe_pval_reverse_pair_num),]

# Plot histogram
ggplot(df_all_FDR02_merged, aes(x = mbe_pval_reverse_pair_num)) +
  geom_histogram(binwidth = 0.05, fill = &quot;steelblue&quot;, color = &quot;white&quot;, boundary = 0) +
  scale_x_continuous(breaks = seq(0, 1, 0.1), limits = c(0, 1)) +
  theme_minimal(base_size = 14) +
  labs(
    x = &quot;MBE reverse pair p-value&quot;,
    y = &quot;Count&quot;,
    title = &quot;Distribution of MBE p-values&quot;
  )</code></pre>
<p><img src="figure/revision_ECT_extendedGWAS_selectedtraits.Rmd/unnamed-chunk-18-2.png" width="768" style="display: block; margin: auto;" /></p>
<br>
<p>
<button type="button" class="btn btn-default btn-workflowr btn-workflowr-sessioninfo" data-toggle="collapse" data-target="#workflowr-sessioninfo" style="display: block;">
<span class="glyphicon glyphicon-wrench" aria-hidden="true"></span>
Session information
</button>
</p>
<div id="workflowr-sessioninfo" class="collapse">
<pre class="r"><code>sessionInfo()</code></pre>
<pre><code>R version 4.2.0 (2022-04-22)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: CentOS Linux 7 (Core)

Matrix products: default
BLAS/LAPACK: /software/openblas-0.3.13-el7-x86_64/lib/libopenblas_haswellp-r0.3.13.so

locale:
[1] C

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
[1] forcats_0.5.1   stringr_1.5.1   dplyr_1.1.4     purrr_1.0.2    
[5] readr_2.1.2     tidyr_1.3.0     tibble_3.2.1    ggplot2_3.5.1  
[9] tidyverse_1.3.1

loaded via a namespace (and not attached):
 [1] Rcpp_1.0.12       lubridate_1.8.0   assertthat_0.2.1  rprojroot_2.0.3  
 [5] digest_0.6.29     utf8_1.2.2        R6_2.5.1          cellranger_1.1.0 
 [9] backports_1.4.1   reprex_2.0.1      evaluate_0.15     highr_0.9        
[13] httr_1.4.3        pillar_1.9.0      rlang_1.1.2       readxl_1.4.0     
[17] rstudioapi_0.13   whisker_0.4       jquerylib_0.1.4   DT_0.22          
[21] rmarkdown_2.25    labeling_0.4.2    htmlwidgets_1.5.4 munsell_0.5.0    
[25] broom_0.8.0       compiler_4.2.0    httpuv_1.6.5      modelr_0.1.8     
[29] xfun_0.41         pkgconfig_2.0.3   htmltools_0.5.2   tidyselect_1.2.0 
[33] workflowr_1.7.0   fansi_1.0.3       crayon_1.5.1      tzdb_0.4.0       
[37] dbplyr_2.1.1      withr_2.5.0       later_1.3.0       grid_4.2.0       
[41] jsonlite_1.8.0    gtable_0.3.0      lifecycle_1.0.4   DBI_1.2.2        
[45] git2r_0.30.1      magrittr_2.0.3    scales_1.3.0      cli_3.6.1        
[49] stringi_1.7.6     farver_2.1.0      fs_1.5.2          promises_1.2.0.1 
[53] xml2_1.3.3        bslib_0.3.1       ellipsis_0.3.2    generics_0.1.2   
[57] vctrs_0.6.5       tools_4.2.0       glue_1.6.2        crosstalk_1.2.0  
[61] hms_1.1.1         fastmap_1.1.0     yaml_2.3.5        colorspace_2.0-3 
[65] rvest_1.0.2       knitr_1.39        haven_2.5.0       sass_0.4.1       </code></pre>
</div>
</div>
</div>
</div>


<!-- Adjust MathJax settings so that all math formulae are shown using
TeX fonts only; see
https://docs.mathjax.org/en/latest/web/configuration.html. This will make
the presentation more consistent at the cost of the webpage sometimes
taking slightly longer to load. Note that this only works because the
footer is added to webpages before the MathJax javascript. -->
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    "HTML-CSS": { availableFonts: ["TeX"] }
  });
</script>




</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("hide" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
